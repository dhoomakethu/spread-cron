Running tests on a test flinger device
Loading environment variables
Using environment file: tf_snapd_cm3_refresh
Deleting test flinger data
Creating job for snapd using a device
Running testflinger client
Submitting job to testflinger
JOB_ID: b0b60621-54e7-4c14-8603-22f2a601a2a0
Print job: /var/snap/testflinger-cli/current/job.yaml 
job_queue: dragonboard
global_timeout: 36000
provision_data:
    channel: stable
test_data:
    test_cmds: |
        #!/bin/bash
        sudo apt update || ps aux | grep apt
        sudo apt install -y git curl sshpass
        git clone https://github.com/sergiocazzolato/snappy-qa-jobs.git
        (cd snappy-qa-jobs && git checkout master)
        git clone https://git.launchpad.net/snapd-vendor snapd
        (cd snapd && git checkout master)
        . snapd/tests/lib/external/prepare-ssh.sh "{device_ip}" "22" "ubuntu"
        . snappy-qa-jobs/scripts/utils/register_device.sh "{device_ip}" "22" "test" "ubuntu" "sergiocazzolato@yahoo.com.ar"
        . snappy-qa-jobs/scripts/utils/refresh.sh "{device_ip}" "22" "test" "ubuntu" "stable" "edge"
        . snappy-qa-jobs/scripts/utils/run_setup.sh "{device_ip}" "22" "test" "ubuntu" ""
        . snappy-qa-jobs/scripts/utils/get_spread.sh
        . snappy-qa-jobs/scripts/utils/run_spread.sh "{device_ip}" "22" "snapd" "external:ubuntu-core-16-arm-64:tests/" "" "tests/main/auto-refresh,tests/main/interfaces-content,tests/main/install-sideload,tests/main/snap-core-symlinks" "-v"
Showing job data
*******************************************

* Starting setup phase on dragonboard-002 *

*******************************************

Cleaning up container if it exists...
Error response from daemon: No such container: dragonboard002

***********************************************

* Starting provision phase on dragonboard-002 *

***********************************************
Install python-logstash if you want to use logstash logging
2018-10-12 14:20:38,142 dragonboard_002 INFO: DEVICE AGENT: BEGIN provision
2018-10-12 14:20:38,142 dragonboard_002 INFO: DEVICE AGENT: Booting Master Image
2018-10-12 14:20:38,142 dragonboard_002 INFO: DEVICE AGENT: Making sure the master image is booted
2018-10-12 14:20:38,142 dragonboard_002 INFO: DEVICE AGENT: Checking if test image booted.
2018-10-12 14:20:39,139 dragonboard_002 INFO: DEVICE AGENT: Running ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null ubuntu@10.101.51.12 sudo sgdisk -o /dev/mmcblk1
Warning: The kernel is still using the old partition table.
The new table will be used at the next reboot or after you
run partprobe(8) or kpartx(8)
The operation has completed successfully.
2018-10-12 14:20:41,016 dragonboard_002 INFO: DEVICE AGENT: Running ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null ubuntu@10.101.51.12 sudo sync
2018-10-12 14:20:41,738 dragonboard_002 INFO: DEVICE AGENT: Running snmpset -c private -v1 10.101.48.13 .1.3.6.1.4.1.318.1.1.12.3.3.1.1.4.2 i 2
iso.3.6.1.4.1.318.1.1.12.3.3.1.1.4.2 = INTEGER: 2
2018-10-12 14:20:41,854 dragonboard_002 INFO: DEVICE AGENT: Running sleep 10
2018-10-12 14:20:51,876 dragonboard_002 INFO: DEVICE AGENT: Running snmpset -c private -v1 10.101.48.13 .1.3.6.1.4.1.318.1.1.12.3.3.1.1.4.2 i 1
iso.3.6.1.4.1.318.1.1.12.3.3.1.1.4.2 = INTEGER: 1
2018-10-12 14:21:02,004 dragonboard_002 INFO: DEVICE AGENT: Checking if master image booted.
2018-10-12 14:25:00,723 dragonboard_002 INFO: DEVICE AGENT: Flashing Test Image
2018-10-12 14:25:01,117 dragonboard_002 INFO: DEVICE AGENT: Running: nc 10.101.50.22 40418| gunzip| sudo dd of=/dev/mmcblk1 bs=16M
2018-10-12 14:25:37,518 dragonboard_002 INFO: DEVICE AGENT: Creating Test User
2018-10-12 14:25:40,061 dragonboard_002 INFO: DEVICE AGENT: Booting Test Image
2018-10-12 14:25:40,061 dragonboard_002 INFO: DEVICE AGENT: Booting the test image
/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: "/home/ubuntu/.ssh/id_rsa.pub"

/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed
/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys

Number of key(s) added: 1

Now try logging into the machine, with:   "ssh -o 'StrictHostKeyChecking=no' -o 'UserKnownHostsFile=/dev/null' 'ubuntu@10.101.51.12'"
and check to make sure that only the key(s) you wanted were added.

2018-10-12 14:26:52,110 dragonboard_002 INFO: DEVICE AGENT: Checking if test image booted.
2018-10-12 14:26:52,598 dragonboard_002 INFO: DEVICE AGENT: END provision

******************************************

* Starting test phase on dragonboard-002 *

******************************************
Install python-logstash if you want to use logstash logging
2018-10-12 14:26:56,941 dragonboard_002 INFO: DEVICE AGENT: BEGIN testrun

WARNING: apt does not have a stable CLI interface. Use with caution in scripts.

Hit:1 http://archive.ubuntu.com/ubuntu xenial InRelease
Get:2 http://ppa.launchpad.net/checkbox-dev/ppa/ubuntu xenial InRelease [17.6 kB]
Get:3 http://security.ubuntu.com/ubuntu xenial-security InRelease [107 kB]
Get:4 http://archive.ubuntu.com/ubuntu xenial-updates InRelease [109 kB]
Get:5 http://archive.ubuntu.com/ubuntu xenial-backports InRelease [107 kB]
Get:6 http://ppa.launchpad.net/checkbox-dev/ppa/ubuntu xenial/main amd64 Packages [9804 B]
Get:7 http://archive.ubuntu.com/ubuntu xenial-updates/universe Sources [280 kB]
Get:8 http://security.ubuntu.com/ubuntu xenial-security/universe Sources [95.4 kB]
Get:9 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 Packages [1109 kB]
Get:10 http://security.ubuntu.com/ubuntu xenial-security/main amd64 Packages [721 kB]
Get:11 http://archive.ubuntu.com/ubuntu xenial-updates/universe amd64 Packages [888 kB]
Get:12 http://archive.ubuntu.com/ubuntu xenial-updates/multiverse amd64 Packages [18.8 kB]
Get:13 http://archive.ubuntu.com/ubuntu xenial-backports/main amd64 Packages [7965 B]
Get:14 http://archive.ubuntu.com/ubuntu xenial-backports/universe amd64 Packages [8532 B]
Get:15 http://security.ubuntu.com/ubuntu xenial-security/universe amd64 Packages [491 kB]
Get:16 http://security.ubuntu.com/ubuntu xenial-security/multiverse amd64 Packages [3747 B]
Fetched 3974 kB in 3s (1121 kB/s)
Reading package lists...
Building dependency tree...
Reading state information...
30 packages can be upgraded. Run 'apt list --upgradable' to see them.

WARNING: apt does not have a stable CLI interface. Use with caution in scripts.

Reading package lists...
Building dependency tree...
Reading state information...
The following additional packages will be installed:
  git-man ifupdown iproute2 isc-dhcp-client isc-dhcp-common less libatm1
  libcurl3-gnutls libdns-export162 liberror-perl libgdbm3 libisc-export160
  libmnl0 libperl5.22 libxtables11 netbase patch perl perl-base
  perl-modules-5.22 rename rsync
Suggested packages:
  gettext-base git-daemon-run | git-daemon-sysvinit git-doc git-el git-email
  git-gui gitk gitweb git-arch git-cvs git-mediawiki git-svn ppp rdnssd
  iproute2-doc resolvconf avahi-autoipd isc-dhcp-client-ddns apparmor ed
  diffutils-doc perl-doc libterm-readline-gnu-perl
  | libterm-readline-perl-perl make openssh-server
The following NEW packages will be installed:
  curl git git-man ifupdown iproute2 isc-dhcp-client isc-dhcp-common less
  libatm1 libdns-export162 liberror-perl libgdbm3 libisc-export160 libmnl0
  libperl5.22 libxtables11 netbase patch perl perl-modules-5.22 rename rsync
  sshpass
The following packages will be upgraded:
  libcurl3-gnutls perl-base
2 upgraded, 23 newly installed, 0 to remove and 28 not upgraded.
Need to get 13.7 MB of archives.
After this operation, 71.9 MB of additional disk space will be used.
Get:1 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 perl-base amd64 5.22.1-9ubuntu0.5 [1284 kB]
Get:2 http://archive.ubuntu.com/ubuntu xenial/main amd64 libatm1 amd64 1:2.5.1-1.5 [24.2 kB]
Get:3 http://archive.ubuntu.com/ubuntu xenial/main amd64 libmnl0 amd64 1.0.3-5 [12.0 kB]
Get:4 http://archive.ubuntu.com/ubuntu xenial/main amd64 libgdbm3 amd64 1.8.3-13.1 [16.9 kB]
Get:5 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 perl-modules-5.22 all 5.22.1-9ubuntu0.5 [2645 kB]
Get:6 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 libperl5.22 amd64 5.22.1-9ubuntu0.5 [3396 kB]
Get:7 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 perl amd64 5.22.1-9ubuntu0.5 [238 kB]
Get:8 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 iproute2 amd64 4.3.0-1ubuntu3.16.04.3 [522 kB]
Get:9 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 ifupdown amd64 0.8.10ubuntu1.4 [54.9 kB]
Get:10 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 libisc-export160 amd64 1:9.10.3.dfsg.P4-8ubuntu1.11 [153 kB]
Get:11 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 libdns-export162 amd64 1:9.10.3.dfsg.P4-8ubuntu1.11 [667 kB]
Get:12 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 isc-dhcp-client amd64 4.3.3-5ubuntu12.10 [224 kB]
Get:13 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 isc-dhcp-common amd64 4.3.3-5ubuntu12.10 [105 kB]
Get:14 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 less amd64 481-2.1ubuntu0.2 [110 kB]
Get:15 http://archive.ubuntu.com/ubuntu xenial/main amd64 libxtables11 amd64 1.6.0-2ubuntu3 [27.2 kB]
Get:16 http://archive.ubuntu.com/ubuntu xenial/main amd64 netbase all 5.3 [12.9 kB]
Get:17 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 libcurl3-gnutls amd64 7.47.0-1ubuntu2.9 [184 kB]
Get:18 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 rsync amd64 3.1.1-3ubuntu1.2 [329 kB]
Get:19 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 curl amd64 7.47.0-1ubuntu2.9 [138 kB]
Get:20 http://archive.ubuntu.com/ubuntu xenial/main amd64 liberror-perl all 0.17-1.2 [19.6 kB]
Get:21 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 git-man all 1:2.7.4-0ubuntu1.5 [736 kB]
Get:22 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 git amd64 1:2.7.4-0ubuntu1.5 [2714 kB]
Get:23 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 patch amd64 2.7.5-1ubuntu0.16.04.1 [90.5 kB]
Get:24 http://archive.ubuntu.com/ubuntu xenial/main amd64 rename all 0.20-4 [12.0 kB]
Get:25 http://archive.ubuntu.com/ubuntu xenial/universe amd64 sshpass amd64 1.05-1 [10.5 kB]
debconf: unable to initialize frontend: Dialog
debconf: (No usable dialog-like program is installed, so the dialog based frontend cannot be used. at /usr/share/perl5/Debconf/FrontEnd/Dialog.pm line 76, <> line 25.)
debconf: falling back to frontend: Readline
debconf: unable to initialize frontend: Readline
debconf: (Can't locate Term/ReadLine.pm in @INC (you may need to install the Term::ReadLine module) (@INC contains: /etc/perl /usr/local/lib/x86_64-linux-gnu/perl/5.22.1 /usr/local/share/perl/5.22.1 /usr/lib/x86_64-linux-gnu/perl5/5.22 /usr/share/perl5 /usr/lib/x86_64-linux-gnu/perl/5.22 /usr/share/perl/5.22 /usr/local/lib/site_perl /usr/lib/x86_64-linux-gnu/perl-base .) at /usr/share/perl5/Debconf/FrontEnd/Readline.pm line 7, <> line 25.)
debconf: falling back to frontend: Teletype
Fetched 13.7 MB in 5s (2526 kB/s)
(Reading database ... (Reading database ... 5%(Reading database ... 10%(Reading database ... 15%(Reading database ... 20%(Reading database ... 25%(Reading database ... 30%(Reading database ... 35%(Reading database ... 40%(Reading database ... 45%(Reading database ... 50%(Reading database ... 55%(Reading database ... 60%(Reading database ... 65%(Reading database ... 70%(Reading database ... 75%(Reading database ... 80%(Reading database ... 85%(Reading database ... 90%(Reading database ... 95%(Reading database ... 100%(Reading database ... 14264 files and directories currently installed.)
Preparing to unpack .../perl-base_5.22.1-9ubuntu0.5_amd64.deb ...
Unpacking perl-base (5.22.1-9ubuntu0.5) over (5.22.1-9ubuntu0.3) ...
Setting up perl-base (5.22.1-9ubuntu0.5) ...
Selecting previously unselected package libatm1:amd64.
(Reading database ... (Reading database ... 5%(Reading database ... 10%(Reading database ... 15%(Reading database ... 20%(Reading database ... 25%(Reading database ... 30%(Reading database ... 35%(Reading database ... 40%(Reading database ... 45%(Reading database ... 50%(Reading database ... 55%(Reading database ... 60%(Reading database ... 65%(Reading database ... 70%(Reading database ... 75%(Reading database ... 80%(Reading database ... 85%(Reading database ... 90%(Reading database ... 95%(Reading database ... 100%(Reading database ... 14264 files and directories currently installed.)
Preparing to unpack .../libatm1_1%3a2.5.1-1.5_amd64.deb ...
Unpacking libatm1:amd64 (1:2.5.1-1.5) ...
Selecting previously unselected package libmnl0:amd64.
Preparing to unpack .../libmnl0_1.0.3-5_amd64.deb ...
Unpacking libmnl0:amd64 (1.0.3-5) ...
Selecting previously unselected package libgdbm3:amd64.
Preparing to unpack .../libgdbm3_1.8.3-13.1_amd64.deb ...
Unpacking libgdbm3:amd64 (1.8.3-13.1) ...
Selecting previously unselected package perl-modules-5.22.
Preparing to unpack .../perl-modules-5.22_5.22.1-9ubuntu0.5_all.deb ...
Unpacking perl-modules-5.22 (5.22.1-9ubuntu0.5) ...
Selecting previously unselected package libperl5.22:amd64.
Preparing to unpack .../libperl5.22_5.22.1-9ubuntu0.5_amd64.deb ...
Unpacking libperl5.22:amd64 (5.22.1-9ubuntu0.5) ...
Selecting previously unselected package perl.
Preparing to unpack .../perl_5.22.1-9ubuntu0.5_amd64.deb ...
Unpacking perl (5.22.1-9ubuntu0.5) ...
Selecting previously unselected package iproute2.
Preparing to unpack .../iproute2_4.3.0-1ubuntu3.16.04.3_amd64.deb ...
Unpacking iproute2 (4.3.0-1ubuntu3.16.04.3) ...
Selecting previously unselected package ifupdown.
Preparing to unpack .../ifupdown_0.8.10ubuntu1.4_amd64.deb ...
Unpacking ifupdown (0.8.10ubuntu1.4) ...
Selecting previously unselected package libisc-export160.
Preparing to unpack .../libisc-export160_1%3a9.10.3.dfsg.P4-8ubuntu1.11_amd64.deb ...
Unpacking libisc-export160 (1:9.10.3.dfsg.P4-8ubuntu1.11) ...
Selecting previously unselected package libdns-export162.
Preparing to unpack .../libdns-export162_1%3a9.10.3.dfsg.P4-8ubuntu1.11_amd64.deb ...
Unpacking libdns-export162 (1:9.10.3.dfsg.P4-8ubuntu1.11) ...
Selecting previously unselected package isc-dhcp-client.
Preparing to unpack .../isc-dhcp-client_4.3.3-5ubuntu12.10_amd64.deb ...
Unpacking isc-dhcp-client (4.3.3-5ubuntu12.10) ...
Selecting previously unselected package isc-dhcp-common.
Preparing to unpack .../isc-dhcp-common_4.3.3-5ubuntu12.10_amd64.deb ...
Unpacking isc-dhcp-common (4.3.3-5ubuntu12.10) ...
Selecting previously unselected package less.
Preparing to unpack .../less_481-2.1ubuntu0.2_amd64.deb ...
Unpacking less (481-2.1ubuntu0.2) ...
Selecting previously unselected package libxtables11:amd64.
Preparing to unpack .../libxtables11_1.6.0-2ubuntu3_amd64.deb ...
Unpacking libxtables11:amd64 (1.6.0-2ubuntu3) ...
Selecting previously unselected package netbase.
Preparing to unpack .../archives/netbase_5.3_all.deb ...
Unpacking netbase (5.3) ...
Preparing to unpack .../libcurl3-gnutls_7.47.0-1ubuntu2.9_amd64.deb ...
Unpacking libcurl3-gnutls:amd64 (7.47.0-1ubuntu2.9) over (7.47.0-1ubuntu2.8) ...
Selecting previously unselected package rsync.
Preparing to unpack .../rsync_3.1.1-3ubuntu1.2_amd64.deb ...
Unpacking rsync (3.1.1-3ubuntu1.2) ...
Selecting previously unselected package curl.
Preparing to unpack .../curl_7.47.0-1ubuntu2.9_amd64.deb ...
Unpacking curl (7.47.0-1ubuntu2.9) ...
Selecting previously unselected package liberror-perl.
Preparing to unpack .../liberror-perl_0.17-1.2_all.deb ...
Unpacking liberror-perl (0.17-1.2) ...
Selecting previously unselected package git-man.
Preparing to unpack .../git-man_1%3a2.7.4-0ubuntu1.5_all.deb ...
Unpacking git-man (1:2.7.4-0ubuntu1.5) ...
Selecting previously unselected package git.
Preparing to unpack .../git_1%3a2.7.4-0ubuntu1.5_amd64.deb ...
Unpacking git (1:2.7.4-0ubuntu1.5) ...
Selecting previously unselected package patch.
Preparing to unpack .../patch_2.7.5-1ubuntu0.16.04.1_amd64.deb ...
Unpacking patch (2.7.5-1ubuntu0.16.04.1) ...
Selecting previously unselected package rename.
Preparing to unpack .../archives/rename_0.20-4_all.deb ...
Unpacking rename (0.20-4) ...
Selecting previously unselected package sshpass.
Preparing to unpack .../sshpass_1.05-1_amd64.deb ...
Unpacking sshpass (1.05-1) ...
Processing triggers for systemd (229-4ubuntu21.4) ...
Processing triggers for libc-bin (2.23-0ubuntu10) ...
Processing triggers for mime-support (3.59ubuntu1) ...
Setting up libatm1:amd64 (1:2.5.1-1.5) ...
Setting up libmnl0:amd64 (1.0.3-5) ...
Setting up libgdbm3:amd64 (1.8.3-13.1) ...
Setting up perl-modules-5.22 (5.22.1-9ubuntu0.5) ...
Setting up libperl5.22:amd64 (5.22.1-9ubuntu0.5) ...
Setting up perl (5.22.1-9ubuntu0.5) ...
update-alternatives: using /usr/bin/prename to provide /usr/bin/rename (rename) in auto mode
Setting up iproute2 (4.3.0-1ubuntu3.16.04.3) ...
Setting up ifupdown (0.8.10ubuntu1.4) ...
Creating /etc/network/interfaces.
Setting up libisc-export160 (1:9.10.3.dfsg.P4-8ubuntu1.11) ...
Setting up libdns-export162 (1:9.10.3.dfsg.P4-8ubuntu1.11) ...
Setting up isc-dhcp-client (4.3.3-5ubuntu12.10) ...
Setting up isc-dhcp-common (4.3.3-5ubuntu12.10) ...
Setting up less (481-2.1ubuntu0.2) ...
debconf: unable to initialize frontend: Dialog
debconf: (No usable dialog-like program is installed, so the dialog based frontend cannot be used. at /usr/share/perl5/Debconf/FrontEnd/Dialog.pm line 76.)
debconf: falling back to frontend: Readline
Setting up libxtables11:amd64 (1.6.0-2ubuntu3) ...
Setting up netbase (5.3) ...
Setting up libcurl3-gnutls:amd64 (7.47.0-1ubuntu2.9) ...
Setting up rsync (3.1.1-3ubuntu1.2) ...
invoke-rc.d: could not determine current runlevel
invoke-rc.d: policy-rc.d denied execution of restart.
Setting up curl (7.47.0-1ubuntu2.9) ...
Setting up liberror-perl (0.17-1.2) ...
Setting up git-man (1:2.7.4-0ubuntu1.5) ...
Setting up git (1:2.7.4-0ubuntu1.5) ...
Setting up patch (2.7.5-1ubuntu0.16.04.1) ...
Setting up rename (0.20-4) ...
update-alternatives: using /usr/bin/file-rename to provide /usr/bin/rename (rename) in auto mode
Setting up sshpass (1.05-1) ...
Processing triggers for libc-bin (2.23-0ubuntu10) ...
Processing triggers for systemd (229-4ubuntu21.4) ...
Cloning into 'snappy-qa-jobs'...
Already on 'master'
Your branch is up-to-date with 'origin/master'.
Cloning into 'snapd'...
Already on 'master'
Your branch is up-to-date with 'origin/master'.
++ INSTANCE_IP=10.101.51.12
++ INSTANCE_PORT=22
++ USER=ubuntu
++ execute_remote 'sudo adduser --extrausers --quiet --disabled-password --gecos '\'''\'' test'
++ ssh -q -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no -p 22 ubuntu@10.101.51.12 'sudo adduser --extrausers --quiet --disabled-password --gecos '\'''\'' test'
ENTER EXTRAUSERS_GROUP_FILEEXIT EXTRAUSERS_GROUP_FILEENTER EXTRAUSERS_SHADOWGROUP_FILEEXIT EXTRAUSERS_SHADOWGROUP_FILE++ execute_remote 'echo test:ubuntu | sudo chpasswd'
++ ssh -q -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no -p 22 ubuntu@10.101.51.12 'echo test:ubuntu | sudo chpasswd'
++ execute_remote 'echo '\''test ALL=(ALL) NOPASSWD:ALL'\'' | sudo tee /etc/sudoers.d/create-user-test'
++ ssh -q -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no -p 22 ubuntu@10.101.51.12 'echo '\''test ALL=(ALL) NOPASSWD:ALL'\'' | sudo tee /etc/sudoers.d/create-user-test'
test ALL=(ALL) NOPASSWD:ALL
+ . snappy-qa-jobs/scripts/utils/register_device.sh 10.101.51.12 22 test ubuntu sergiocazzolato@yahoo.com.ar
++ echo 'Register device'
Register device
++ '[' 5 -ne 5 ']'
++ DEVICE_IP=10.101.51.12
++ DEVICE_PORT=22
++ USER=test
++ PASS=ubuntu
++ EMAIL=sergiocazzolato@yahoo.com.ar
++ SCRIPT='sudo snap create-user sergiocazzolato@yahoo.com.ar ||         ( sudo snap install jq;         sudo cp /var/lib/snapd/state.json /var/lib/snapd/state.json.bak;         sudo cat /var/lib/snapd/state.json.bak | jq -r '\''.data.auth.users=[]'\'' | sudo tee /var/lib/snapd/state.json > /dev/null;         sudo systemctl stop snapd.service snapd.socket;         sudo systemctl start snapd.service snapd.socket;         sudo snap create-user sergiocazzolato@yahoo.com.ar;         sudo snap remove jq )'
++ '[' -z sergiocazzolato@yahoo.com.ar ']'
++ '[' -z ubuntu ']'
++ echo 'Registering device (with pass): sudo snap create-user sergiocazzolato@yahoo.com.ar ||         ( sudo snap install jq;         sudo cp /var/lib/snapd/state.json /var/lib/snapd/state.json.bak;         sudo cat /var/lib/snapd/state.json.bak | jq -r '\''.data.auth.users=[]'\'' | sudo tee /var/lib/snapd/state.json > /dev/null;         sudo systemctl stop snapd.service snapd.socket;         sudo systemctl start snapd.service snapd.socket;         sudo snap create-user sergiocazzolato@yahoo.com.ar;         sudo snap remove jq )'
Registering device (with pass): sudo snap create-user sergiocazzolato@yahoo.com.ar ||         ( sudo snap install jq;         sudo cp /var/lib/snapd/state.json /var/lib/snapd/state.json.bak;         sudo cat /var/lib/snapd/state.json.bak | jq -r '.data.auth.users=[]' | sudo tee /var/lib/snapd/state.json > /dev/null;         sudo systemctl stop snapd.service snapd.socket;         sudo systemctl start snapd.service snapd.socket;         sudo snap create-user sergiocazzolato@yahoo.com.ar;         sudo snap remove jq )
++ sshpass -p ubuntu ssh -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no -p 22 test@10.101.51.12 'sudo snap create-user sergiocazzolato@yahoo.com.ar ||         ( sudo snap install jq;         sudo cp /var/lib/snapd/state.json /var/lib/snapd/state.json.bak;         sudo cat /var/lib/snapd/state.json.bak | jq -r '\''.data.auth.users=[]'\'' | sudo tee /var/lib/snapd/state.json > /dev/null;         sudo systemctl stop snapd.service snapd.socket;         sudo systemctl start snapd.service snapd.socket;         sudo snap create-user sergiocazzolato@yahoo.com.ar;         sudo snap remove jq )'
created user "snappytestaccount1"
+ . snappy-qa-jobs/scripts/utils/refresh.sh 10.101.51.12 22 test ubuntu stable edge
++ echo 'Refresh core on device'
Refresh core on device
++ '[' 6 -ne 6 ']'
++ DEVICE_IP=10.101.51.12
++ DEVICE_PORT=22
++ USER=test
++ PASS=ubuntu
++ CHANNEL=stable
++ CORE_CHANNEL=edge
++ execute_remote 'snap changes'
++ '[' -z ubuntu ']'
++ grep -q -E 'Doing.*Auto-refresh snap.*'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 'snap changes'
++ '[' -z edge ']'
++ '[' stable = edge ']'
++ do_core_refresh edge core
++ refresh_channel=edge
++ execute_remote 'sudo snap refresh --edge core'
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 'sudo snap refresh --edge core'
snapd is about to reboot the system
++ check_refresh edge
++ refresh_channel=edge
++ wait_for_no_ssh 30 2
++ retries=30
++ sleep=2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 true
++ retries=29
++ '[' 29 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 true
++ retries=28
++ '[' 28 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 true
++ retries=27
++ '[' 27 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 true
++ retries=26
++ '[' 26 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 true
++ retries=25
++ '[' 25 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 true
++ retries=24
++ '[' 24 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 true
++ retries=23
++ '[' 23 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 true
++ retries=22
++ '[' 22 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 true
++ retries=21
++ '[' 21 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 true
++ retries=20
++ '[' 20 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 true
++ retries=19
++ '[' 19 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 true
++ retries=18
++ '[' 18 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 true
++ retries=17
++ '[' 17 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 true
++ retries=16
++ '[' 16 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 true
++ retries=15
++ '[' 15 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 true
++ retries=14
++ '[' 14 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 true
++ retries=13
++ '[' 13 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 true
++ retries=12
++ '[' 12 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 true
++ retries=11
++ '[' 11 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 true
++ retries=10
++ '[' 10 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 true
++ retries=9
++ '[' 9 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 true
++ retries=8
++ '[' 8 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 true
++ retries=7
++ '[' 7 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 true
++ retries=6
++ '[' 6 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 true
++ retries=5
++ '[' 5 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 true
++ retries=4
++ '[' 4 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 true
++ wait_for_ssh 120 2
++ retries=120
++ sleep=2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 true
++ retries=119
++ '[' 119 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 true
++ retries=118
++ '[' 118 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 true
++ retries=117
++ '[' 117 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 true
++ retries=116
++ '[' 116 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 true
++ retries=115
++ '[' 115 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 true
++ retries=114
++ '[' 114 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 true
++ retries=113
++ '[' 113 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 true
++ retries=112
++ '[' 112 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 true
++ retries=111
++ '[' 111 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 true
++ retries=110
++ '[' 110 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 true
++ retries=109
++ '[' 109 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 true
++ retries=108
++ '[' 108 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 true
++ retries=107
++ '[' 107 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 true
++ retry_until 'snap info core' 'tracking: +edge' 10 2
++ command='snap info core'
++ output='tracking: +edge'
++ retries=10
++ sleep=2
++ execute_remote 'snap info core'
++ '[' -z ubuntu ']'
++ grep -q -E 'tracking: +edge'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 'snap info core'
++ retry_until 'sudo snap install --devmode jq' 'jq .* installed' 20 10
++ command='sudo snap install --devmode jq'
++ output='jq .* installed'
++ retries=20
++ sleep=10
++ execute_remote 'sudo snap install --devmode jq'
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 'sudo snap install --devmode jq'
++ grep -q -E 'jq .* installed'
++ execute_remote 'sudo snap remove jq'
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.12 'sudo snap remove jq'
jq removed
+ . snappy-qa-jobs/scripts/utils/run_setup.sh 10.101.51.12 22 test ubuntu ''
++ echo 'Running setup command'
Running setup command
++ '[' 5 -ne 5 ']'
++ DEVICE_IP=10.101.51.12
++ DEVICE_PORT=22
++ USER=test
++ PASS=ubuntu
++ SETUP=
++ '[' -z '' ']'
++ echo 'No setup command to run'
No setup command to run
+ . snappy-qa-jobs/scripts/utils/get_spread.sh
++ echo 'Getting spread'
Getting spread
+++ pwd
++ export WORKSPACE=/home/ubuntu
++ WORKSPACE=/home/ubuntu
++ export SPREAD_DIR=/home/ubuntu/spread
++ SPREAD_DIR=/home/ubuntu/spread
++ export PATH=/home/ubuntu/spread:/srv/testflinger-agent/dragonboard002/env/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
++ PATH=/home/ubuntu/spread:/srv/testflinger-agent/dragonboard002/env/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
++ '[' -f /home/ubuntu/spread/spread ']'
++ mkdir -p /home/ubuntu/spread
++ cd /home/ubuntu/spread
++ curl -s -O https://niemeyer.s3.amazonaws.com/spread-amd64.tar.gz
++ tar xzvf spread-amd64.tar.gz
spread
++ echo 'Spread downloaded and ready to use'
Spread downloaded and ready to use
+ . snappy-qa-jobs/scripts/utils/run_spread.sh 10.101.51.12 22 snapd external:ubuntu-core-16-arm-64:tests/ '' tests/main/auto-refresh,tests/main/interfaces-content,tests/main/install-sideload,tests/main/snap-core-symlinks -v
++ echo 'Running spread'
Running spread
++ '[' 7 -ne 7 ']'
++ export WORKSPACE=/home/ubuntu
++ WORKSPACE=/home/ubuntu
++ DEVICE_IP=10.101.51.12
++ DEVICE_PORT=22
++ PROJECT_PATH=snapd
++ SPREAD_TESTS=external:ubuntu-core-16-arm-64:tests/
++ SPREAD_ENV=
++ SKIP_TESTS=tests/main/auto-refresh,tests/main/interfaces-content,tests/main/install-sideload,tests/main/snap-core-symlinks
++ SPREAD_PARAMS=-v
++ '[' -z external:ubuntu-core-16-arm-64:tests/ ']'
++ '[' '!' -z '' ']'
++ export SPREAD_EXTERNAL_ADDRESS=10.101.51.12:22
++ SPREAD_EXTERNAL_ADDRESS=10.101.51.12:22
+++ which spread
++ [[ -n /home/ubuntu/spread/spread ]]
++ echo 'Spread found'
Spread found
++ cd snapd
++ echo 'Moving to manual all the tests to skip: tests/main/auto-refresh,tests/main/interfaces-content,tests/main/install-sideload,tests/main/snap-core-symlinks'
Moving to manual all the tests to skip: tests/main/auto-refresh,tests/main/interfaces-content,tests/main/install-sideload,tests/main/snap-core-symlinks
+++ echo tests/main/auto-refresh,tests/main/interfaces-content,tests/main/install-sideload,tests/main/snap-core-symlinks
+++ tr , ' '
++ tests_skip='tests/main/auto-refresh tests/main/interfaces-content tests/main/install-sideload tests/main/snap-core-symlinks'
++ for test in '$tests_skip'
++ '[' -f tests/main/auto-refresh/task.yaml ']'
++ cp tests/main/auto-refresh/task.yaml tests/main/auto-refresh/task.yaml.back
++ echo 'manual: true'
++ for test in '$tests_skip'
++ '[' -f tests/main/interfaces-content/task.yaml ']'
++ cp tests/main/interfaces-content/task.yaml tests/main/interfaces-content/task.yaml.back
++ echo 'manual: true'
++ for test in '$tests_skip'
++ '[' -f tests/main/install-sideload/task.yaml ']'
++ cp tests/main/install-sideload/task.yaml tests/main/install-sideload/task.yaml.back
++ echo 'manual: true'
++ for test in '$tests_skip'
++ '[' -f tests/main/snap-core-symlinks/task.yaml ']'
++ cp tests/main/snap-core-symlinks/task.yaml tests/main/snap-core-symlinks/task.yaml.back
++ echo 'manual: true'
+++ echo -v
+++ tr , ' '
++ spread_params=-v
++ echo 'Running command: spread -v external:ubuntu-core-16-arm-64:tests/'
Running command: spread -v external:ubuntu-core-16-arm-64:tests/
++ spread -v external:ubuntu-core-16-arm-64:tests/
2018-10-12 14:33:15 Found /home/ubuntu/snapd/spread.yaml.
2018-10-12 14:33:19 Project content is packed for delivery (3.11MB).
2018-10-12 14:33:19 Sequence of jobs produced with -seed=1539354799
2018-10-12 14:33:19 If killed, discard servers with: spread -reuse-pid=811 -discard
2018-10-12 14:33:19 Allocating external:ubuntu-core-16-arm-64...
2018-10-12 14:33:19 Waiting for external:ubuntu-core-16-arm-64 to make SSH available at 10.101.51.12:22...
2018-10-12 14:33:19 Allocated external:ubuntu-core-16-arm-64.
2018-10-12 14:33:19 Connecting to external:ubuntu-core-16-arm-64...
2018-10-12 14:33:19 Connected to external:ubuntu-core-16-arm-64 at 10.101.51.12:22.
2018-10-12 14:33:19 Sending project content to external:ubuntu-core-16-arm-64...
2018-10-12 14:33:20 Preparing external:ubuntu-core-16-arm-64...
2018-10-12 14:33:21 Preparing external:ubuntu-core-16-arm-64:tests/main/...
2018-10-12 14:34:19 Preparing external:ubuntu-core-16-arm-64:tests/main/lxd...
2018-10-12 14:34:29 Executing external:ubuntu-core-16-arm-64:tests/main/lxd (1/225)...
2018-10-12 14:34:30 Restoring external:ubuntu-core-16-arm-64:tests/main/lxd...
2018-10-12 14:34:30 Preparing external:ubuntu-core-16-arm-64:tests/main/degraded...
2018-10-12 14:34:34 Executing external:ubuntu-core-16-arm-64:tests/main/degraded (2/225)...
2018-10-12 14:34:35 Restoring external:ubuntu-core-16-arm-64:tests/main/degraded...
2018-10-12 14:34:35 Preparing external:ubuntu-core-16-arm-64:tests/main/interfaces-broadcom-asic-control...
2018-10-12 14:35:01 Executing external:ubuntu-core-16-arm-64:tests/main/interfaces-broadcom-asic-control (3/225)...
2018-10-12 14:35:15 Restoring external:ubuntu-core-16-arm-64:tests/main/interfaces-broadcom-asic-control...
2018-10-12 14:35:16 Preparing external:ubuntu-core-16-arm-64:tests/main/failover:emptysystemd...
2018-10-12 14:35:23 Executing external:ubuntu-core-16-arm-64:tests/main/failover:emptysystemd (4/225)...
2018-10-12 14:38:34 Rebooting on external:ubuntu-core-16-arm-64 (external:ubuntu-core-16-arm-64:tests/main/failover:emptysystemd) as requested...
2018-10-12 14:40:07 Restoring external:ubuntu-core-16-arm-64:tests/main/failover:emptysystemd...
2018-10-12 14:40:09 Preparing external:ubuntu-core-16-arm-64:tests/main/failover:rclocalcrash...
2018-10-12 14:40:13 Executing external:ubuntu-core-16-arm-64:tests/main/failover:rclocalcrash (5/225)...
2018-10-12 14:43:17 Rebooting on external:ubuntu-core-16-arm-64 (external:ubuntu-core-16-arm-64:tests/main/failover:rclocalcrash) as requested...
2018-10-12 14:45:09 Restoring external:ubuntu-core-16-arm-64:tests/main/failover:rclocalcrash...
2018-10-12 14:45:11 Preparing external:ubuntu-core-16-arm-64:tests/main/ubuntu-core-reboot...
2018-10-12 14:45:47 Executing external:ubuntu-core-16-arm-64:tests/main/ubuntu-core-reboot (6/225)...
2018-10-12 14:45:48 Rebooting on external:ubuntu-core-16-arm-64 (external:ubuntu-core-16-arm-64:tests/main/ubuntu-core-reboot) as requested...
2018-10-12 14:46:51 Restoring external:ubuntu-core-16-arm-64:tests/main/ubuntu-core-reboot...
2018-10-12 14:46:51 Preparing external:ubuntu-core-16-arm-64:tests/main/ubuntu-core-upgrade...
2018-10-12 14:47:59 Executing external:ubuntu-core-16-arm-64:tests/main/ubuntu-core-upgrade (7/225)...
2018-10-12 14:48:24 Rebooting on external:ubuntu-core-16-arm-64 (external:ubuntu-core-16-arm-64:tests/main/ubuntu-core-upgrade) as requested...
2018-10-12 14:49:24 Rebooting on external:ubuntu-core-16-arm-64 (external:ubuntu-core-16-arm-64:tests/main/ubuntu-core-upgrade) as requested...

2018-10-12 14:49:26 Error executing external:ubuntu-core-16-arm-64:tests/main/ubuntu-core-upgrade : 
-----
mesg: ttyname failed: Inappropriate ioctl for device
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/boot.sh
++ GRUB_EDITENV=grub-editenv
++ case "$SPREAD_SYSTEM" in
+ '[' 0 '!=' 0 ']'
+ snap list
+ awk '/^core / {print($3)}'
+ '[' -f curChg ']'
+ case "$SPREAD_REBOOT" in
++ cat prevBoot
+ cmd='snap install --dangerous /var/lib/snapd/snaps/core_5712.snap'
++ eval snap install --dangerous /var/lib/snapd/snaps/core_5712.snap --no-wait
+++ snap install --dangerous /var/lib/snapd/snaps/core_5712.snap --no-wait
+ chg_id=15
+ echo 15
+ journalctl -b -u snapd
+ grep -q 'Waiting for system reboot'
+ sleep 1
+ journalctl -b -u snapd
+ grep -q 'Waiting for system reboot'
+ sleep 1
+ journalctl -b -u snapd
+ grep -q 'Waiting for system reboot'
+ sleep 1
+ journalctl -b -u snapd
+ grep -q 'Waiting for system reboot'
+ sleep 1
+ journalctl -b -u snapd
+ grep -q 'Waiting for system reboot'
+ sleep 1
+ journalctl -b -u snapd
+ grep -q 'Waiting for system reboot'
+ sleep 1
+ journalctl -b -u snapd
+ grep -q 'Waiting for system reboot'
+ sleep 1
+ journalctl -b -u snapd
+ grep -q 'Waiting for system reboot'
+ sleep 1
+ journalctl -b -u snapd
+ grep -q 'Waiting for system reboot'
+ sleep 1
+ journalctl -b -u snapd
+ grep -q 'Waiting for system reboot'
+ sleep 1
+ journalctl -b -u snapd
+ grep -q 'Waiting for system reboot'
+ sleep 1
+ grep -q 'Waiting for system reboot'
+ journalctl -b -u snapd
+ sleep 1
+ grep -q 'Waiting for system reboot'
+ journalctl -b -u snapd
+ sleep 1
+ journalctl -b -u snapd
+ grep -q 'Waiting for system reboot'
+ sleep 1
+ journalctl -b -u snapd
+ grep -q 'Waiting for system reboot'
+ sleep 1
+ journalctl -b -u snapd
+ grep -q 'Waiting for system reboot'
+ sleep 1
+ journalctl -b -u snapd
+ grep -q 'Waiting for system reboot'
+ sleep 1
+ journalctl -b -u snapd
+ grep -q 'Waiting for system reboot'
+ sleep 1
+ journalctl -b -u snapd
+ grep -q 'Waiting for system reboot'
+ echo 'Ensure the test snap still runs'
Ensure the test snap still runs
+ test-snapd-tools.echo hello
+ MATCH hello
+ echo 'Ensure the bootloader is correct before reboot'
Ensure the bootloader is correct before reboot
+ readlink /snap/core/current
++ cat prevBoot
++ cat nextBoot
+ test 5712 '!=' x1
++ bootenv snap_try_core
++ '[' 1 -eq 0 ']'
++ command -v grub-editenv
++ sed 's/^snap_try_core=//'
++ fw_printenv snap_try_core
++ cat nextBoot
+ test core_x1.snap = core_x1.snap
++ bootenv snap_mode
++ '[' 1 -eq 0 ']'
++ command -v grub-editenv
++ fw_printenv snap_mode
++ sed 's/^snap_mode=//'
+ test try = try
+ echo 'Ensure the device is scheduled for auto-reboot'
Ensure the device is scheduled for auto-reboot
++ dbus-send --print-reply --type=method_call --system --dest=org.freedesktop.login1 /org/freedesktop/login1 org.freedesktop.DBus.Properties.Get string:org.freedesktop.login1.Manager string:ScheduledShutdown
+ output='method return time=1539355796.512701 sender=:1.1 -> destination=:1.6 serial=35 reply_serial=2
   variant       struct {
         string "reboot"
         uint64 1539356395253278
      }'
+ echo 'method return time=1539355796.512701 sender=:1.1 -> destination=:1.6 serial=35 reply_serial=2
   variant       struct {
         string "reboot"
         uint64 1539356395253278
      }'
+ MATCH 'string "reboot"'
+ REBOOT
<REBOOT>

mesg: ttyname failed: Inappropriate ioctl for device
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/boot.sh
++ GRUB_EDITENV=grub-editenv
++ case "$SPREAD_SYSTEM" in
+ '[' 1 '!=' 0 ']'
+ echo 'Waiting for snapd to clean snap_mode'
Waiting for snapd to clean snap_mode
++ bootenv snap_mode
++ '[' 1 -eq 0 ']'
++ command -v grub-editenv
++ sed 's/^snap_mode=//'
++ fw_printenv snap_mode
## Error: "snap_mode" not defined
+ '[' '' '!=' '' ']'
+ echo 'Ensure the bootloader is correct after reboot'
Ensure the bootloader is correct after reboot
++ bootenv snap_core
++ '[' 1 -eq 0 ']'
++ command -v grub-editenv
++ fw_printenv snap_core
++ sed 's/^snap_core=//'
++ cat nextBoot
+ test core_x1.snap = core_x1.snap
++ bootenv snap_try_core
++ '[' 1 -eq 0 ']'
++ command -v grub-editenv
++ sed 's/^snap_try_core=//'
++ fw_printenv snap_try_core
## Error: "snap_try_core" not defined
+ test '' = ''
++ bootenv snap_mode
++ '[' 1 -eq 0 ']'
++ command -v grub-editenv
++ fw_printenv snap_mode
++ sed 's/^snap_mode=//'
## Error: "snap_mode" not defined
+ test '' = ''
+ snap list
+ awk '/^core / {print($3)}'
+ '[' -f curChg ']'
++ cat curChg
+ snap watch 15
+ rm -f curChg
+ case "$SPREAD_REBOOT" in
+ cmd='snap revert core'
++ eval snap revert core --no-wait
+++ snap revert core --no-wait
+ chg_id=17
+ echo 17
+ journalctl -b -u snapd
+ grep -q 'Waiting for system reboot'
+ sleep 1
+ journalctl -b -u snapd
+ grep -q 'Waiting for system reboot'
+ sleep 1
+ journalctl -b -u snapd
+ grep -q 'Waiting for system reboot'
+ sleep 1
+ journalctl -b -u snapd
+ grep -q 'Waiting for system reboot'
+ sleep 1
+ journalctl -b -u snapd
+ grep -q 'Waiting for system reboot'
+ sleep 1
+ journalctl -b -u snapd
+ grep -q 'Waiting for system reboot'
+ sleep 1
+ journalctl -b -u snapd
+ grep -q 'Waiting for system reboot'
+ echo 'Ensure the test snap still runs'
Ensure the test snap still runs
+ test-snapd-tools.echo hello
+ MATCH hello
+ echo 'Ensure the bootloader is correct before reboot'
Ensure the bootloader is correct before reboot
+ readlink /snap/core/current
++ cat prevBoot
++ cat nextBoot
+ test x1 '!=' 5712
++ bootenv snap_try_core
++ '[' 1 -eq 0 ']'
++ command -v grub-editenv
++ sed 's/^snap_try_core=//'
++ fw_printenv snap_try_core
++ cat nextBoot
+ test core_5712.snap = core_5712.snap
++ bootenv snap_mode
++ '[' 1 -eq 0 ']'
++ command -v grub-editenv
++ sed 's/^snap_mode=//'
++ fw_printenv snap_mode
+ test try = try
+ echo 'Ensure the device is scheduled for auto-reboot'
Ensure the device is scheduled for auto-reboot
++ dbus-send --print-reply --type=method_call --system --dest=org.freedesktop.login1 /org/freedesktop/login1 org.freedesktop.DBus.Properties.Get string:org.freedesktop.login1.Manager string:ScheduledShutdown
+ output='method return time=1539355801.092476 sender=:1.2 -> destination=:1.6 serial=35 reply_serial=2
   variant       struct {
         string "reboot"
         uint64 1539356400097733
      }'
+ echo 'method return time=1539355801.092476 sender=:1.2 -> destination=:1.6 serial=35 reply_serial=2
   variant       struct {
         string "reboot"
         uint64 1539356400097733
      }'
+ MATCH 'string "reboot"'
+ REBOOT
<REBOOT>

+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/boot.sh
++ GRUB_EDITENV=grub-editenv
++ case "$SPREAD_SYSTEM" in
+ '[' 2 '!=' 0 ']'
+ echo 'Waiting for snapd to clean snap_mode'
Waiting for snapd to clean snap_mode
++ bootenv snap_mode
++ '[' 1 -eq 0 ']'
++ command -v grub-editenv
++ sed 's/^snap_mode=//'
++ fw_printenv snap_mode
+ '[' try '!=' '' ']'
+ sleep 1
++ bootenv snap_mode
++ '[' 1 -eq 0 ']'
++ command -v grub-editenv
++ fw_printenv snap_mode
++ sed 's/^snap_mode=//'
Cannot access MTD device /boot/uboot/uboot.env: No such file or directory
+ '[' '' '!=' '' ']'
+ echo 'Ensure the bootloader is correct after reboot'
Ensure the bootloader is correct after reboot
++ bootenv snap_core
++ '[' 1 -eq 0 ']'
++ command -v grub-editenv
++ sed 's/^snap_core=//'
++ fw_printenv snap_core
Cannot access MTD device /boot/uboot/uboot.env: No such file or directory
++ cat nextBoot
+ test '' = core_5712.snap
-----
.
2018-10-12 14:49:26 Error debugging external:ubuntu-core-16-arm-64:tests/main/ubuntu-core-upgrade : sudo: unknown uid 1001: who are you?
2018-10-12 14:49:26 Restoring external:ubuntu-core-16-arm-64:tests/main/ubuntu-core-upgrade...
2018-10-12 14:49:26 Error restoring external:ubuntu-core-16-arm-64:tests/main/ubuntu-core-upgrade : sudo: unknown uid 1001: who are you?
2018-10-12 14:49:26 Restoring external:ubuntu-core-16-arm-64:tests/main/...
2018-10-12 14:49:26 Error restoring external:ubuntu-core-16-arm-64:tests/main/ : sudo: unknown uid 1001: who are you?
2018-10-12 14:49:26 Restoring external:ubuntu-core-16-arm-64...
2018-10-12 14:49:26 Error restoring external:ubuntu-core-16-arm-64 : sudo: unknown uid 1001: who are you?
2018-10-12 14:49:26 Discarding external:ubuntu-core-16-arm-64...
2018-10-12 14:49:26 Successful tasks: 6
2018-10-12 14:49:26 Aborted tasks: 218
2018-10-12 14:49:26 Failed tasks: 1
    - external:ubuntu-core-16-arm-64:tests/main/ubuntu-core-upgrade
2018-10-12 14:49:26 Failed task restore: 1
    - external:ubuntu-core-16-arm-64:tests/main/ubuntu-core-upgrade
2018-10-12 14:49:26 Failed suite restore: 1
    - external:ubuntu-core-16-arm-64:tests/main/
2018-10-12 14:49:26 Failed project restore: 1
    - external:ubuntu-core-16-arm-64:project
error: unsuccessful run
2018-10-12 14:49:26,182 dragonboard_002 WARNING: DEVICE AGENT: Tests failed, rc=1
2018-10-12 14:49:26,182 dragonboard_002 INFO: DEVICE AGENT: END testrun
complete
