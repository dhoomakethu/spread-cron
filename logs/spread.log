Running tests on a test flinger device
Loading environment variables
Using environment file: tf_snapd_db
Deleting test flinger data
Creating job for snapd using a device
Running testflinger client
Submitting job to testflinger
JOB_ID: 7987c721-6766-42d3-8545-a59cdf625bbf
Print job: /var/snap/testflinger-cli/current/job.yaml 
job_queue: dragonboard
global_timeout: 36000
provision_data:
    channel: beta
test_data:
    test_cmds: |
        #!/bin/bash
        sudo apt update || ps aux | grep apt
        sudo apt install -y git curl sshpass
        git clone https://github.com/sergiocazzolato/snappy-qa-jobs.git
        (cd snappy-qa-jobs && git checkout master)
        git clone https://git.launchpad.net/snapd-vendor snapd
        (cd snapd && git checkout master)
        . snapd/tests/lib/external/prepare-ssh.sh "{device_ip}" "22" "ubuntu"
        . snappy-qa-jobs/scripts/utils/register_device.sh "{device_ip}" "22" "test" "ubuntu" "sergiocazzolato@yahoo.com.ar"
        . snappy-qa-jobs/scripts/utils/refresh_core.sh "{device_ip}" "22" "test" "ubuntu" "beta" "edge"
        . snappy-qa-jobs/scripts/utils/run_setup.sh "{device_ip}" "22" "test" "ubuntu" ""
        . snappy-qa-jobs/scripts/utils/get_spread.sh
        . snappy-qa-jobs/scripts/utils/run_spread.sh "{device_ip}" "22" "snapd" "external:ubuntu-core-16-arm-64:tests/" "" "tests/main/auto-refresh,tests/main/failover,tests/main/ubuntu-core-services"
Showing job data
This job is currently waiting on a node to become available. You will see no further output until the job starts running.
*******************************************

* Starting setup phase on dragonboard-004 *

*******************************************

Cleaning up container if it exists...
Error response from daemon: No such container: dragonboard004
***********************************************

* Starting provision phase on dragonboard-004 *

***********************************************
Install python-logstash if you want to use logstash logging
2017-12-27 04:41:49,842 dragonboard_004 INFO: BEGIN provision
2017-12-27 04:41:49,842 dragonboard_004 INFO: Booting Master Image
2017-12-27 04:41:49,842 dragonboard_004 INFO: Making sure the master image is booted
2017-12-27 04:41:49,842 dragonboard_004 INFO: Checking if test image booted.
2017-12-27 04:41:51,199 dragonboard_004 INFO: Running ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null ubuntu@10.101.51.14 sudo sgdisk -o /dev/mmcblk1
Warning: Permanently added '10.101.51.14' (ECDSA) to the list of known hosts.
Warning: The kernel is still using the old partition table.
The new table will be used at the next reboot or after you
run partprobe(8) or kpartx(8)
The operation has completed successfully.
2017-12-27 04:41:53,328 dragonboard_004 INFO: Running ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null ubuntu@10.101.51.14 sudo sync
Warning: Permanently added '10.101.51.14' (ECDSA) to the list of known hosts.
2017-12-27 04:41:54,099 dragonboard_004 INFO: Running snmpset -c private -v1 10.101.48.13 .1.3.6.1.4.1.318.1.1.12.3.3.1.1.4.4 i 2
iso.3.6.1.4.1.318.1.1.12.3.3.1.1.4.4 = INTEGER: 2
2017-12-27 04:41:54,267 dragonboard_004 INFO: Running sleep 10
2017-12-27 04:42:04,288 dragonboard_004 INFO: Running snmpset -c private -v1 10.101.48.13 .1.3.6.1.4.1.318.1.1.12.3.3.1.1.4.4 i 1
iso.3.6.1.4.1.318.1.1.12.3.3.1.1.4.4 = INTEGER: 1
2017-12-27 04:42:14,417 dragonboard_004 INFO: Checking if master image booted.
2017-12-27 04:44:53,767 dragonboard_004 INFO: Flashing Test Image
2017-12-27 04:44:54,148 dragonboard_004 INFO: Running: nc 10.101.50.22 46635| gunzip| sudo dd of=/dev/mmcblk1 bs=16M
2017-12-27 04:46:33,187 dragonboard_004 INFO: Creating Test User
Warning: Permanently added '10.101.51.14' (ECDSA) to the list of known hosts.
2017-12-27 04:46:35,586 dragonboard_004 INFO: Booting Test Image
2017-12-27 04:46:35,586 dragonboard_004 INFO: Booting the test image
/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: "/home/ubuntu/.ssh/id_rsa.pub"

/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed
/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys
Warning: Permanently added '10.101.51.14' (ECDSA) to the list of known hosts.

Number of key(s) added: 1

Now try logging into the machine, with:   "ssh -o 'StrictHostKeyChecking=no' -o 'UserKnownHostsFile=/dev/null' 'ubuntu@10.101.51.14'"
and check to make sure that only the key(s) you wanted were added.

2017-12-27 04:47:48,271 dragonboard_004 INFO: Checking if test image booted.
2017-12-27 04:47:48,749 dragonboard_004 INFO: END provision

******************************************

* Starting test phase on dragonboard-004 *

******************************************
Install python-logstash if you want to use logstash logging
2017-12-27 04:47:53,517 dragonboard_004 INFO: BEGIN testrun

WARNING: apt does not have a stable CLI interface. Use with caution in scripts.

Hit:1 http://archive.ubuntu.com/ubuntu xenial InRelease
Get:2 http://security.ubuntu.com/ubuntu xenial-security InRelease [102 kB]
Get:3 http://archive.ubuntu.com/ubuntu xenial-updates InRelease [102 kB]
Get:4 http://security.ubuntu.com/ubuntu xenial-security/universe Sources [56.7 kB]
Get:5 http://archive.ubuntu.com/ubuntu xenial-backports InRelease [102 kB]
Get:6 http://security.ubuntu.com/ubuntu xenial-security/main amd64 Packages [521 kB]
Get:7 http://security.ubuntu.com/ubuntu xenial-security/restricted amd64 Packages [12.9 kB]
Get:8 http://security.ubuntu.com/ubuntu xenial-security/universe amd64 Packages [239 kB]
Get:9 http://security.ubuntu.com/ubuntu xenial-security/multiverse amd64 Packages [3481 B]
Get:10 http://archive.ubuntu.com/ubuntu xenial-updates/universe Sources [233 kB]
Get:11 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 Packages [882 kB]
Get:12 http://archive.ubuntu.com/ubuntu xenial-updates/restricted amd64 Packages [13.7 kB]
Get:13 http://archive.ubuntu.com/ubuntu xenial-updates/universe amd64 Packages [726 kB]
Get:14 http://archive.ubuntu.com/ubuntu xenial-updates/multiverse amd64 Packages [18.5 kB]
Get:15 http://archive.ubuntu.com/ubuntu xenial-backports/main amd64 Packages [5162 B]
Get:16 http://archive.ubuntu.com/ubuntu xenial-backports/universe amd64 Packages [7146 B]
Fetched 3025 kB in 7s (420 kB/s)
Reading package lists...
Building dependency tree...
Reading state information...
52 packages can be upgraded. Run 'apt list --upgradable' to see them.

WARNING: apt does not have a stable CLI interface. Use with caution in scripts.

Reading package lists...
Building dependency tree...
Reading state information...
The following additional packages will be installed:
  git-man ifupdown iproute2 isc-dhcp-client isc-dhcp-common less
  libasn1-8-heimdal libatm1 libcurl3-gnutls libdns-export162 liberror-perl
  libgdbm3 libgmp10 libgnutls30 libgssapi3-heimdal libhcrypto4-heimdal
  libheimbase1-heimdal libheimntlm0-heimdal libhogweed4 libhx509-5-heimdal
  libisc-export160 libkrb5-26-heimdal libldap-2.4-2 libmnl0 libnettle6
  libp11-kit0 libperl5.22 libpopt0 libroken18-heimdal librtmp1 libsasl2-2
  libsasl2-modules libsasl2-modules-db libtasn1-6 libwind0-heimdal
  libxtables11 netbase patch perl perl-base perl-modules-5.22 rename rsync
Suggested packages:
  gettext-base git-daemon-run | git-daemon-sysvinit git-doc git-el git-email
  git-gui gitk gitweb git-arch git-cvs git-mediawiki git-svn ppp rdnssd
  iproute2-doc resolvconf avahi-autoipd isc-dhcp-client-ddns apparmor
  gnutls-bin libsasl2-modules-otp libsasl2-modules-ldap libsasl2-modules-sql
  libsasl2-modules-gssapi-mit | libsasl2-modules-gssapi-heimdal ed
  diffutils-doc perl-doc libterm-readline-gnu-perl
  | libterm-readline-perl-perl make openssh-server
The following NEW packages will be installed:
  curl git git-man ifupdown iproute2 isc-dhcp-client isc-dhcp-common less
  libasn1-8-heimdal libatm1 libcurl3-gnutls libdns-export162 liberror-perl
  libgdbm3 libgmp10 libgnutls30 libgssapi3-heimdal libhcrypto4-heimdal
  libheimbase1-heimdal libheimntlm0-heimdal libhogweed4 libhx509-5-heimdal
  libisc-export160 libkrb5-26-heimdal libldap-2.4-2 libmnl0 libnettle6
  libp11-kit0 libperl5.22 libpopt0 libroken18-heimdal librtmp1 libsasl2-2
  libsasl2-modules libsasl2-modules-db libtasn1-6 libwind0-heimdal
  libxtables11 netbase patch perl perl-modules-5.22 rename rsync sshpass
The following packages will be upgraded:
  perl-base
1 upgraded, 45 newly installed, 0 to remove and 51 not upgraded.
Need to get 16.4 MB of archives.
After this operation, 79.8 MB of additional disk space will be used.
Get:1 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 perl-base amd64 5.22.1-9ubuntu0.2 [1282 kB]
Get:2 http://archive.ubuntu.com/ubuntu xenial/main amd64 libatm1 amd64 1:2.5.1-1.5 [24.2 kB]
Get:3 http://archive.ubuntu.com/ubuntu xenial/main amd64 libmnl0 amd64 1.0.3-5 [12.0 kB]
Get:4 http://archive.ubuntu.com/ubuntu xenial/main amd64 libpopt0 amd64 1.16-10 [26.0 kB]
Get:5 http://archive.ubuntu.com/ubuntu xenial/main amd64 libgdbm3 amd64 1.8.3-13.1 [16.9 kB]
Get:6 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 perl-modules-5.22 all 5.22.1-9ubuntu0.2 [2661 kB]
Get:7 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 libperl5.22 amd64 5.22.1-9ubuntu0.2 [3391 kB]
Get:8 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 perl amd64 5.22.1-9ubuntu0.2 [237 kB]
Get:9 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 iproute2 amd64 4.3.0-1ubuntu3.16.04.2 [522 kB]
Get:10 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 ifupdown amd64 0.8.10ubuntu1.2 [54.9 kB]
Get:11 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 libisc-export160 amd64 1:9.10.3.dfsg.P4-8ubuntu1.9 [153 kB]
Get:12 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 libdns-export162 amd64 1:9.10.3.dfsg.P4-8ubuntu1.9 [666 kB]
Get:13 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 isc-dhcp-client amd64 4.3.3-5ubuntu12.7 [223 kB]
Get:14 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 isc-dhcp-common amd64 4.3.3-5ubuntu12.7 [105 kB]
Get:15 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 less amd64 481-2.1ubuntu0.2 [110 kB]
Get:16 http://archive.ubuntu.com/ubuntu xenial/main amd64 libgmp10 amd64 2:6.1.0+dfsg-2 [240 kB]
Get:17 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 libnettle6 amd64 3.2-1ubuntu0.16.04.1 [93.5 kB]
Get:18 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 libhogweed4 amd64 3.2-1ubuntu0.16.04.1 [136 kB]
Get:19 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 libp11-kit0 amd64 0.23.2-5~ubuntu16.04.1 [105 kB]
Get:20 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 libtasn1-6 amd64 4.7-3ubuntu0.16.04.2 [43.3 kB]
Get:21 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 libgnutls30 amd64 3.4.10-4ubuntu1.4 [548 kB]
Get:22 http://archive.ubuntu.com/ubuntu xenial/main amd64 libxtables11 amd64 1.6.0-2ubuntu3 [27.2 kB]
Get:23 http://archive.ubuntu.com/ubuntu xenial/main amd64 netbase all 5.3 [12.9 kB]
Get:24 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 libroken18-heimdal amd64 1.7~git20150920+dfsg-4ubuntu1.16.04.1 [41.4 kB]
Get:25 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 libasn1-8-heimdal amd64 1.7~git20150920+dfsg-4ubuntu1.16.04.1 [174 kB]
Get:26 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 libhcrypto4-heimdal amd64 1.7~git20150920+dfsg-4ubuntu1.16.04.1 [85.0 kB]
Get:27 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 libheimbase1-heimdal amd64 1.7~git20150920+dfsg-4ubuntu1.16.04.1 [29.3 kB]
Get:28 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 libwind0-heimdal amd64 1.7~git20150920+dfsg-4ubuntu1.16.04.1 [47.8 kB]
Get:29 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 libhx509-5-heimdal amd64 1.7~git20150920+dfsg-4ubuntu1.16.04.1 [107 kB]
Get:30 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 libkrb5-26-heimdal amd64 1.7~git20150920+dfsg-4ubuntu1.16.04.1 [202 kB]
Get:31 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 libheimntlm0-heimdal amd64 1.7~git20150920+dfsg-4ubuntu1.16.04.1 [15.1 kB]
Get:32 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 libgssapi3-heimdal amd64 1.7~git20150920+dfsg-4ubuntu1.16.04.1 [96.1 kB]
Get:33 http://archive.ubuntu.com/ubuntu xenial/main amd64 libsasl2-modules-db amd64 2.1.26.dfsg1-14build1 [14.5 kB]
Get:34 http://archive.ubuntu.com/ubuntu xenial/main amd64 libsasl2-2 amd64 2.1.26.dfsg1-14build1 [48.7 kB]
Get:35 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 libldap-2.4-2 amd64 2.4.42+dfsg-2ubuntu3.2 [160 kB]
Get:36 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 librtmp1 amd64 2.4+20151223.gitfa8646d-1ubuntu0.1 [54.4 kB]
Get:37 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 libcurl3-gnutls amd64 7.47.0-1ubuntu2.5 [184 kB]
Get:38 http://archive.ubuntu.com/ubuntu xenial/main amd64 libsasl2-modules amd64 2.1.26.dfsg1-14build1 [47.5 kB]
Get:39 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 rsync amd64 3.1.1-3ubuntu1.1 [329 kB]
Get:40 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 curl amd64 7.47.0-1ubuntu2.5 [138 kB]
Get:41 http://archive.ubuntu.com/ubuntu xenial/main amd64 liberror-perl all 0.17-1.2 [19.6 kB]
Get:42 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 git-man all 1:2.7.4-0ubuntu1.3 [736 kB]
Get:43 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 git amd64 1:2.7.4-0ubuntu1.3 [3102 kB]
Get:44 http://archive.ubuntu.com/ubuntu xenial/main amd64 patch amd64 2.7.5-1 [90.4 kB]
Get:45 http://archive.ubuntu.com/ubuntu xenial/main amd64 rename all 0.20-4 [12.0 kB]
Get:46 http://archive.ubuntu.com/ubuntu xenial/universe amd64 sshpass amd64 1.05-1 [10.5 kB]
debconf: delaying package configuration, since apt-utils is not installed
Fetched 16.4 MB in 11s (1474 kB/s)
(Reading database ... (Reading database ... 5%(Reading database ... 10%(Reading database ... 15%(Reading database ... 20%(Reading database ... 25%(Reading database ... 30%(Reading database ... 35%(Reading database ... 40%(Reading database ... 45%(Reading database ... 50%(Reading database ... 55%(Reading database ... 60%(Reading database ... 65%(Reading database ... 70%(Reading database ... 75%(Reading database ... 80%(Reading database ... 85%(Reading database ... 90%(Reading database ... 95%(Reading database ... 100%(Reading database ... 9540 files and directories currently installed.)
Preparing to unpack .../perl-base_5.22.1-9ubuntu0.2_amd64.deb ...
Unpacking perl-base (5.22.1-9ubuntu0.2) over (5.22.1-9) ...
Setting up perl-base (5.22.1-9ubuntu0.2) ...
Selecting previously unselected package libatm1:amd64.
(Reading database ... (Reading database ... 5%(Reading database ... 10%(Reading database ... 15%(Reading database ... 20%(Reading database ... 25%(Reading database ... 30%(Reading database ... 35%(Reading database ... 40%(Reading database ... 45%(Reading database ... 50%(Reading database ... 55%(Reading database ... 60%(Reading database ... 65%(Reading database ... 70%(Reading database ... 75%(Reading database ... 80%(Reading database ... 85%(Reading database ... 90%(Reading database ... 95%(Reading database ... 100%(Reading database ... 9540 files and directories currently installed.)
Preparing to unpack .../libatm1_1%3a2.5.1-1.5_amd64.deb ...
Unpacking libatm1:amd64 (1:2.5.1-1.5) ...
Selecting previously unselected package libmnl0:amd64.
Preparing to unpack .../libmnl0_1.0.3-5_amd64.deb ...
Unpacking libmnl0:amd64 (1.0.3-5) ...
Selecting previously unselected package libpopt0:amd64.
Preparing to unpack .../libpopt0_1.16-10_amd64.deb ...
Unpacking libpopt0:amd64 (1.16-10) ...
Selecting previously unselected package libgdbm3:amd64.
Preparing to unpack .../libgdbm3_1.8.3-13.1_amd64.deb ...
Unpacking libgdbm3:amd64 (1.8.3-13.1) ...
Selecting previously unselected package perl-modules-5.22.
Preparing to unpack .../perl-modules-5.22_5.22.1-9ubuntu0.2_all.deb ...
Unpacking perl-modules-5.22 (5.22.1-9ubuntu0.2) ...
Selecting previously unselected package libperl5.22:amd64.
Preparing to unpack .../libperl5.22_5.22.1-9ubuntu0.2_amd64.deb ...
Unpacking libperl5.22:amd64 (5.22.1-9ubuntu0.2) ...
Selecting previously unselected package perl.
Preparing to unpack .../perl_5.22.1-9ubuntu0.2_amd64.deb ...
Unpacking perl (5.22.1-9ubuntu0.2) ...
Selecting previously unselected package iproute2.
Preparing to unpack .../iproute2_4.3.0-1ubuntu3.16.04.2_amd64.deb ...
Unpacking iproute2 (4.3.0-1ubuntu3.16.04.2) ...
Selecting previously unselected package ifupdown.
Preparing to unpack .../ifupdown_0.8.10ubuntu1.2_amd64.deb ...
Unpacking ifupdown (0.8.10ubuntu1.2) ...
Selecting previously unselected package libisc-export160.
Preparing to unpack .../libisc-export160_1%3a9.10.3.dfsg.P4-8ubuntu1.9_amd64.deb ...
Unpacking libisc-export160 (1:9.10.3.dfsg.P4-8ubuntu1.9) ...
Selecting previously unselected package libdns-export162.
Preparing to unpack .../libdns-export162_1%3a9.10.3.dfsg.P4-8ubuntu1.9_amd64.deb ...
Unpacking libdns-export162 (1:9.10.3.dfsg.P4-8ubuntu1.9) ...
Selecting previously unselected package isc-dhcp-client.
Preparing to unpack .../isc-dhcp-client_4.3.3-5ubuntu12.7_amd64.deb ...
Unpacking isc-dhcp-client (4.3.3-5ubuntu12.7) ...
Selecting previously unselected package isc-dhcp-common.
Preparing to unpack .../isc-dhcp-common_4.3.3-5ubuntu12.7_amd64.deb ...
Unpacking isc-dhcp-common (4.3.3-5ubuntu12.7) ...
Selecting previously unselected package less.
Preparing to unpack .../less_481-2.1ubuntu0.2_amd64.deb ...
Unpacking less (481-2.1ubuntu0.2) ...
Selecting previously unselected package libgmp10:amd64.
Preparing to unpack .../libgmp10_2%3a6.1.0+dfsg-2_amd64.deb ...
Unpacking libgmp10:amd64 (2:6.1.0+dfsg-2) ...
Selecting previously unselected package libnettle6:amd64.
Preparing to unpack .../libnettle6_3.2-1ubuntu0.16.04.1_amd64.deb ...
Unpacking libnettle6:amd64 (3.2-1ubuntu0.16.04.1) ...
Selecting previously unselected package libhogweed4:amd64.
Preparing to unpack .../libhogweed4_3.2-1ubuntu0.16.04.1_amd64.deb ...
Unpacking libhogweed4:amd64 (3.2-1ubuntu0.16.04.1) ...
Selecting previously unselected package libp11-kit0:amd64.
Preparing to unpack .../libp11-kit0_0.23.2-5~ubuntu16.04.1_amd64.deb ...
Unpacking libp11-kit0:amd64 (0.23.2-5~ubuntu16.04.1) ...
Selecting previously unselected package libtasn1-6:amd64.
Preparing to unpack .../libtasn1-6_4.7-3ubuntu0.16.04.2_amd64.deb ...
Unpacking libtasn1-6:amd64 (4.7-3ubuntu0.16.04.2) ...
Selecting previously unselected package libgnutls30:amd64.
Preparing to unpack .../libgnutls30_3.4.10-4ubuntu1.4_amd64.deb ...
Unpacking libgnutls30:amd64 (3.4.10-4ubuntu1.4) ...
Selecting previously unselected package libxtables11:amd64.
Preparing to unpack .../libxtables11_1.6.0-2ubuntu3_amd64.deb ...
Unpacking libxtables11:amd64 (1.6.0-2ubuntu3) ...
Selecting previously unselected package netbase.
Preparing to unpack .../archives/netbase_5.3_all.deb ...
Unpacking netbase (5.3) ...
Selecting previously unselected package libroken18-heimdal:amd64.
Preparing to unpack .../libroken18-heimdal_1.7~git20150920+dfsg-4ubuntu1.16.04.1_amd64.deb ...
Unpacking libroken18-heimdal:amd64 (1.7~git20150920+dfsg-4ubuntu1.16.04.1) ...
Selecting previously unselected package libasn1-8-heimdal:amd64.
Preparing to unpack .../libasn1-8-heimdal_1.7~git20150920+dfsg-4ubuntu1.16.04.1_amd64.deb ...
Unpacking libasn1-8-heimdal:amd64 (1.7~git20150920+dfsg-4ubuntu1.16.04.1) ...
Selecting previously unselected package libhcrypto4-heimdal:amd64.
Preparing to unpack .../libhcrypto4-heimdal_1.7~git20150920+dfsg-4ubuntu1.16.04.1_amd64.deb ...
Unpacking libhcrypto4-heimdal:amd64 (1.7~git20150920+dfsg-4ubuntu1.16.04.1) ...
Selecting previously unselected package libheimbase1-heimdal:amd64.
Preparing to unpack .../libheimbase1-heimdal_1.7~git20150920+dfsg-4ubuntu1.16.04.1_amd64.deb ...
Unpacking libheimbase1-heimdal:amd64 (1.7~git20150920+dfsg-4ubuntu1.16.04.1) ...
Selecting previously unselected package libwind0-heimdal:amd64.
Preparing to unpack .../libwind0-heimdal_1.7~git20150920+dfsg-4ubuntu1.16.04.1_amd64.deb ...
Unpacking libwind0-heimdal:amd64 (1.7~git20150920+dfsg-4ubuntu1.16.04.1) ...
Selecting previously unselected package libhx509-5-heimdal:amd64.
Preparing to unpack .../libhx509-5-heimdal_1.7~git20150920+dfsg-4ubuntu1.16.04.1_amd64.deb ...
Unpacking libhx509-5-heimdal:amd64 (1.7~git20150920+dfsg-4ubuntu1.16.04.1) ...
Selecting previously unselected package libkrb5-26-heimdal:amd64.
Preparing to unpack .../libkrb5-26-heimdal_1.7~git20150920+dfsg-4ubuntu1.16.04.1_amd64.deb ...
Unpacking libkrb5-26-heimdal:amd64 (1.7~git20150920+dfsg-4ubuntu1.16.04.1) ...
Selecting previously unselected package libheimntlm0-heimdal:amd64.
Preparing to unpack .../libheimntlm0-heimdal_1.7~git20150920+dfsg-4ubuntu1.16.04.1_amd64.deb ...
Unpacking libheimntlm0-heimdal:amd64 (1.7~git20150920+dfsg-4ubuntu1.16.04.1) ...
Selecting previously unselected package libgssapi3-heimdal:amd64.
Preparing to unpack .../libgssapi3-heimdal_1.7~git20150920+dfsg-4ubuntu1.16.04.1_amd64.deb ...
Unpacking libgssapi3-heimdal:amd64 (1.7~git20150920+dfsg-4ubuntu1.16.04.1) ...
Selecting previously unselected package libsasl2-modules-db:amd64.
Preparing to unpack .../libsasl2-modules-db_2.1.26.dfsg1-14build1_amd64.deb ...
Unpacking libsasl2-modules-db:amd64 (2.1.26.dfsg1-14build1) ...
Selecting previously unselected package libsasl2-2:amd64.
Preparing to unpack .../libsasl2-2_2.1.26.dfsg1-14build1_amd64.deb ...
Unpacking libsasl2-2:amd64 (2.1.26.dfsg1-14build1) ...
Selecting previously unselected package libldap-2.4-2:amd64.
Preparing to unpack .../libldap-2.4-2_2.4.42+dfsg-2ubuntu3.2_amd64.deb ...
Unpacking libldap-2.4-2:amd64 (2.4.42+dfsg-2ubuntu3.2) ...
Selecting previously unselected package librtmp1:amd64.
Preparing to unpack .../librtmp1_2.4+20151223.gitfa8646d-1ubuntu0.1_amd64.deb ...
Unpacking librtmp1:amd64 (2.4+20151223.gitfa8646d-1ubuntu0.1) ...
Selecting previously unselected package libcurl3-gnutls:amd64.
Preparing to unpack .../libcurl3-gnutls_7.47.0-1ubuntu2.5_amd64.deb ...
Unpacking libcurl3-gnutls:amd64 (7.47.0-1ubuntu2.5) ...
Selecting previously unselected package libsasl2-modules:amd64.
Preparing to unpack .../libsasl2-modules_2.1.26.dfsg1-14build1_amd64.deb ...
Unpacking libsasl2-modules:amd64 (2.1.26.dfsg1-14build1) ...
Selecting previously unselected package rsync.
Preparing to unpack .../rsync_3.1.1-3ubuntu1.1_amd64.deb ...
Unpacking rsync (3.1.1-3ubuntu1.1) ...
Selecting previously unselected package curl.
Preparing to unpack .../curl_7.47.0-1ubuntu2.5_amd64.deb ...
Unpacking curl (7.47.0-1ubuntu2.5) ...
Selecting previously unselected package liberror-perl.
Preparing to unpack .../liberror-perl_0.17-1.2_all.deb ...
Unpacking liberror-perl (0.17-1.2) ...
Selecting previously unselected package git-man.
Preparing to unpack .../git-man_1%3a2.7.4-0ubuntu1.3_all.deb ...
Unpacking git-man (1:2.7.4-0ubuntu1.3) ...
Selecting previously unselected package git.
Preparing to unpack .../git_1%3a2.7.4-0ubuntu1.3_amd64.deb ...
Unpacking git (1:2.7.4-0ubuntu1.3) ...
Selecting previously unselected package patch.
Preparing to unpack .../patch_2.7.5-1_amd64.deb ...
Unpacking patch (2.7.5-1) ...
Selecting previously unselected package rename.
Preparing to unpack .../archives/rename_0.20-4_all.deb ...
Unpacking rename (0.20-4) ...
Selecting previously unselected package sshpass.
Preparing to unpack .../sshpass_1.05-1_amd64.deb ...
Unpacking sshpass (1.05-1) ...
Processing triggers for systemd (229-4ubuntu16) ...
Processing triggers for libc-bin (2.23-0ubuntu7) ...
Processing triggers for mime-support (3.59ubuntu1) ...
Setting up libatm1:amd64 (1:2.5.1-1.5) ...
Setting up libmnl0:amd64 (1.0.3-5) ...
Setting up libpopt0:amd64 (1.16-10) ...
Setting up libgdbm3:amd64 (1.8.3-13.1) ...
Setting up perl-modules-5.22 (5.22.1-9ubuntu0.2) ...
Setting up libperl5.22:amd64 (5.22.1-9ubuntu0.2) ...
Setting up perl (5.22.1-9ubuntu0.2) ...
update-alternatives: using /usr/bin/prename to provide /usr/bin/rename (rename) in auto mode
Setting up iproute2 (4.3.0-1ubuntu3.16.04.2) ...
Setting up ifupdown (0.8.10ubuntu1.2) ...
Creating /etc/network/interfaces.
Setting up libisc-export160 (1:9.10.3.dfsg.P4-8ubuntu1.9) ...
Setting up libdns-export162 (1:9.10.3.dfsg.P4-8ubuntu1.9) ...
Setting up isc-dhcp-client (4.3.3-5ubuntu12.7) ...
Setting up isc-dhcp-common (4.3.3-5ubuntu12.7) ...
Setting up less (481-2.1ubuntu0.2) ...
debconf: unable to initialize frontend: Dialog
debconf: (No usable dialog-like program is installed, so the dialog based frontend cannot be used. at /usr/share/perl5/Debconf/FrontEnd/Dialog.pm line 76.)
debconf: falling back to frontend: Readline
Setting up libgmp10:amd64 (2:6.1.0+dfsg-2) ...
Setting up libnettle6:amd64 (3.2-1ubuntu0.16.04.1) ...
Setting up libhogweed4:amd64 (3.2-1ubuntu0.16.04.1) ...
Setting up libp11-kit0:amd64 (0.23.2-5~ubuntu16.04.1) ...
Setting up libtasn1-6:amd64 (4.7-3ubuntu0.16.04.2) ...
Setting up libgnutls30:amd64 (3.4.10-4ubuntu1.4) ...
Setting up libxtables11:amd64 (1.6.0-2ubuntu3) ...
Setting up netbase (5.3) ...
Setting up libroken18-heimdal:amd64 (1.7~git20150920+dfsg-4ubuntu1.16.04.1) ...
Setting up libasn1-8-heimdal:amd64 (1.7~git20150920+dfsg-4ubuntu1.16.04.1) ...
Setting up libhcrypto4-heimdal:amd64 (1.7~git20150920+dfsg-4ubuntu1.16.04.1) ...
Setting up libheimbase1-heimdal:amd64 (1.7~git20150920+dfsg-4ubuntu1.16.04.1) ...
Setting up libwind0-heimdal:amd64 (1.7~git20150920+dfsg-4ubuntu1.16.04.1) ...
Setting up libhx509-5-heimdal:amd64 (1.7~git20150920+dfsg-4ubuntu1.16.04.1) ...
Setting up libkrb5-26-heimdal:amd64 (1.7~git20150920+dfsg-4ubuntu1.16.04.1) ...
Setting up libheimntlm0-heimdal:amd64 (1.7~git20150920+dfsg-4ubuntu1.16.04.1) ...
Setting up libgssapi3-heimdal:amd64 (1.7~git20150920+dfsg-4ubuntu1.16.04.1) ...
Setting up libsasl2-modules-db:amd64 (2.1.26.dfsg1-14build1) ...
Setting up libsasl2-2:amd64 (2.1.26.dfsg1-14build1) ...
Setting up libldap-2.4-2:amd64 (2.4.42+dfsg-2ubuntu3.2) ...
Setting up librtmp1:amd64 (2.4+20151223.gitfa8646d-1ubuntu0.1) ...
Setting up libcurl3-gnutls:amd64 (7.47.0-1ubuntu2.5) ...
Setting up libsasl2-modules:amd64 (2.1.26.dfsg1-14build1) ...
Setting up rsync (3.1.1-3ubuntu1.1) ...
invoke-rc.d: could not determine current runlevel
invoke-rc.d: policy-rc.d denied execution of restart.
Setting up curl (7.47.0-1ubuntu2.5) ...
Setting up liberror-perl (0.17-1.2) ...
Setting up git-man (1:2.7.4-0ubuntu1.3) ...
Setting up git (1:2.7.4-0ubuntu1.3) ...
Setting up patch (2.7.5-1) ...
Setting up rename (0.20-4) ...
update-alternatives: using /usr/bin/file-rename to provide /usr/bin/rename (rename) in auto mode
Setting up sshpass (1.05-1) ...
Processing triggers for libc-bin (2.23-0ubuntu7) ...
Processing triggers for systemd (229-4ubuntu16) ...
Cloning into 'snappy-qa-jobs'...
Already on 'master'
Your branch is up-to-date with 'origin/master'.
Cloning into 'snapd'...
Already on 'master'
Your branch is up-to-date with 'origin/master'.
++ INSTANCE_IP=10.101.51.14
++ INSTANCE_PORT=22
++ USER=ubuntu
++ execute_remote 'sudo adduser --extrausers --quiet --disabled-password --gecos '\'''\'' test'
++ ssh -q -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no -p 22 ubuntu@10.101.51.14 'sudo adduser --extrausers --quiet --disabled-password --gecos '\'''\'' test'
ENTER EXTRAUSERS_GROUP_FILEEXIT EXTRAUSERS_GROUP_FILEENTER EXTRAUSERS_SHADOWGROUP_FILEEXIT EXTRAUSERS_SHADOWGROUP_FILE++ execute_remote 'echo test:ubuntu | sudo chpasswd'
++ ssh -q -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no -p 22 ubuntu@10.101.51.14 'echo test:ubuntu | sudo chpasswd'
++ execute_remote 'echo '\''test ALL=(ALL) NOPASSWD:ALL'\'' | sudo tee /etc/sudoers.d/create-user-test'
++ ssh -q -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no -p 22 ubuntu@10.101.51.14 'echo '\''test ALL=(ALL) NOPASSWD:ALL'\'' | sudo tee /etc/sudoers.d/create-user-test'
test ALL=(ALL) NOPASSWD:ALL
+ . snappy-qa-jobs/scripts/utils/register_device.sh 10.101.51.14 22 test ubuntu sergiocazzolato@yahoo.com.ar
++ echo 'Register device'
Register device
++ '[' 5 -ne 5 ']'
++ DEVICE_IP=10.101.51.14
++ DEVICE_PORT=22
++ USER=test
++ PASS=ubuntu
++ EMAIL=sergiocazzolato@yahoo.com.ar
++ SCRIPT='sudo snap install jq;         sudo cp /var/lib/snapd/state.json /var/lib/snapd/state.json.bak;         sudo cat /var/lib/snapd/state.json.bak | jq -r '\''.data.auth.users=[]'\'' | sudo tee /var/lib/snapd/state.json > /dev/null;         sudo systemctl stop snapd.service snapd.socket;         sudo systemctl start snapd.service snapd.socket;         sudo snap create-user sergiocazzolato@yahoo.com.ar;         sudo snap remove jq'
++ '[' -z sergiocazzolato@yahoo.com.ar ']'
++ '[' -z ubuntu ']'
++ echo 'Registering device (with pass): sudo snap install jq;         sudo cp /var/lib/snapd/state.json /var/lib/snapd/state.json.bak;         sudo cat /var/lib/snapd/state.json.bak | jq -r '\''.data.auth.users=[]'\'' | sudo tee /var/lib/snapd/state.json > /dev/null;         sudo systemctl stop snapd.service snapd.socket;         sudo systemctl start snapd.service snapd.socket;         sudo snap create-user sergiocazzolato@yahoo.com.ar;         sudo snap remove jq'
Registering device (with pass): sudo snap install jq;         sudo cp /var/lib/snapd/state.json /var/lib/snapd/state.json.bak;         sudo cat /var/lib/snapd/state.json.bak | jq -r '.data.auth.users=[]' | sudo tee /var/lib/snapd/state.json > /dev/null;         sudo systemctl stop snapd.service snapd.socket;         sudo systemctl start snapd.service snapd.socket;         sudo snap create-user sergiocazzolato@yahoo.com.ar;         sudo snap remove jq
++ sshpass -p ubuntu ssh -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no -p 22 test@10.101.51.14 'sudo snap install jq;         sudo cp /var/lib/snapd/state.json /var/lib/snapd/state.json.bak;         sudo cat /var/lib/snapd/state.json.bak | jq -r '\''.data.auth.users=[]'\'' | sudo tee /var/lib/snapd/state.json > /dev/null;         sudo systemctl stop snapd.service snapd.socket;         sudo systemctl start snapd.service snapd.socket;         sudo snap create-user sergiocazzolato@yahoo.com.ar;         sudo snap remove jq'
Warning: Permanently added '10.101.51.14' (ECDSA) to the list of known hosts.
jq 1.5+dfsg-1 from 'canonical' installed
created user "snappytestaccount1"
jq removed
+ . snappy-qa-jobs/scripts/utils/refresh_core.sh 10.101.51.14 22 test ubuntu beta edge
++ echo 'Refresh core on device'
Refresh core on device
++ '[' 6 -ne 6 ']'
++ DEVICE_IP=10.101.51.14
++ DEVICE_PORT=22
++ USER=test
++ PASS=ubuntu
++ CHANNEL=beta
++ CORE_CHANNEL=edge
++ execute_remote 'snap changes'
++ '[' -z ubuntu ']'
++ grep -q -E 'Doing.*Auto-refresh snap "core"'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.14 'snap changes'
++ '[' -z edge ']'
++ '[' beta = edge ']'
++ execute_remote 'sudo snap refresh --edge core'
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.14 'sudo snap refresh --edge core'
2017-12-27T04:55:06Z INFO Waiting for restart...
2017-12-27T05:00:08Z INFO Waiting for restart...
2017-12-27T05:00:10Z INFO Waiting for restart...
2017-12-27T05:00:16Z INFO Waiting for restart...
2017-12-27T05:02:26Z INFO Waiting for restart...
Connection to 10.101.51.14 closed by remote host.
++ true
++ wait_for_ssh 120 2
++ retries=120
++ sleep=2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.14 true
Connection to 10.101.51.14 closed by remote host.
++ retries=119
++ '[' 119 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.14 true
++ retries=118
++ '[' 118 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.14 true
++ retries=117
++ '[' 117 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.14 true
++ retries=116
++ '[' 116 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.14 true
++ retries=115
++ '[' 115 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.14 true
++ retries=114
++ '[' 114 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.14 true
++ retries=113
++ '[' 113 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.14 true
++ retries=112
++ '[' 112 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.14 true
++ retries=111
++ '[' 111 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.14 true
++ retries=110
++ '[' 110 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.14 true
++ retries=109
++ '[' 109 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.14 true
++ retries=108
++ '[' 108 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.14 true
++ retries=107
++ '[' 107 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.14 true
++ retry_until 'snap changes' 'Done.*Refresh "core" snap from "edge" channel' 120 2
++ command='snap changes'
++ output='Done.*Refresh "core" snap from "edge" channel'
++ retries=120
++ sleep=2
++ execute_remote 'snap changes'
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.14 'snap changes'
++ grep -q -E 'Done.*Refresh "core" snap from "edge" channel'
++ retries=119
++ '[' 119 -le 0 ']'
++ sleep 2
++ execute_remote 'snap changes'
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.14 'snap changes'
++ grep -q -E 'Done.*Refresh "core" snap from "edge" channel'
++ retries=118
++ '[' 118 -le 0 ']'
++ sleep 2
++ execute_remote 'snap changes'
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.14 'snap changes'
++ grep -q -E 'Done.*Refresh "core" snap from "edge" channel'
++ retries=117
++ '[' 117 -le 0 ']'
++ sleep 2
++ execute_remote 'snap changes'
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.14 'snap changes'
++ grep -q -E 'Done.*Refresh "core" snap from "edge" channel'
++ retries=116
++ '[' 116 -le 0 ']'
++ sleep 2
++ execute_remote 'snap changes'
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.14 'snap changes'
++ grep -q -E 'Done.*Refresh "core" snap from "edge" channel'
++ retries=115
++ '[' 115 -le 0 ']'
++ sleep 2
++ execute_remote 'snap changes'
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.14 'snap changes'
++ grep -q -E 'Done.*Refresh "core" snap from "edge" channel'
++ retries=114
++ '[' 114 -le 0 ']'
++ sleep 2
++ execute_remote 'snap changes'
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.14 'snap changes'
++ grep -q -E 'Done.*Refresh "core" snap from "edge" channel'
++ retries=113
++ '[' 113 -le 0 ']'
++ sleep 2
++ execute_remote 'snap changes'
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.14 'snap changes'
++ grep -q -E 'Done.*Refresh "core" snap from "edge" channel'
++ retries=112
++ '[' 112 -le 0 ']'
++ sleep 2
++ execute_remote 'snap changes'
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.14 'snap changes'
++ grep -q -E 'Done.*Refresh "core" snap from "edge" channel'
++ execute_remote 'snap info core'
++ '[' -z ubuntu ']'
++ grep -q -E 'tracking: +edge'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.51.14 'snap info core'
+ . snappy-qa-jobs/scripts/utils/run_setup.sh 10.101.51.14 22 test ubuntu ''
++ echo 'Running setup command'
Running setup command
++ '[' 5 -ne 5 ']'
++ DEVICE_IP=10.101.51.14
++ DEVICE_PORT=22
++ USER=test
++ PASS=ubuntu
++ SETUP=
++ '[' -z '' ']'
++ echo 'No setup command to run'
No setup command to run
+ . snappy-qa-jobs/scripts/utils/get_spread.sh
++ echo 'Getting spread'
Getting spread
+++ pwd
++ export WORKSPACE=/home/ubuntu
++ WORKSPACE=/home/ubuntu
++ export SPREAD_DIR=/home/ubuntu/spread
++ SPREAD_DIR=/home/ubuntu/spread
++ export PATH=/home/ubuntu/spread:/srv/testflinger-agent/dragonboard004/env/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
++ PATH=/home/ubuntu/spread:/srv/testflinger-agent/dragonboard004/env/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
++ '[' -f /home/ubuntu/spread/spread ']'
++ mkdir -p /home/ubuntu/spread
++ cd /home/ubuntu/spread
++ curl -s -O https://niemeyer.s3.amazonaws.com/spread-amd64.tar.gz
++ tar xzvf spread-amd64.tar.gz
spread
++ echo 'Spread downloaded and ready to use'
Spread downloaded and ready to use
+ . snappy-qa-jobs/scripts/utils/run_spread.sh 10.101.51.14 22 snapd external:ubuntu-core-16-arm-64:tests/ '' tests/main/auto-refresh,tests/main/failover,tests/main/ubuntu-core-services
++ echo 'Running spread'
Running spread
++ '[' 6 -ne 6 ']'
++ export WORKSPACE=/home/ubuntu
++ WORKSPACE=/home/ubuntu
++ DEVICE_IP=10.101.51.14
++ DEVICE_PORT=22
++ PROJECT_PATH=snapd
++ SPREAD_TESTS=external:ubuntu-core-16-arm-64:tests/
++ SPREAD_ENV=
++ SKIP_TESTS=tests/main/auto-refresh,tests/main/failover,tests/main/ubuntu-core-services
++ '[' -z external:ubuntu-core-16-arm-64:tests/ ']'
++ '[' '!' -z '' ']'
++ export SPREAD_EXTERNAL_ADDRESS=10.101.51.14:22
++ SPREAD_EXTERNAL_ADDRESS=10.101.51.14:22
+++ which spread
++ [[ -n /home/ubuntu/spread/spread ]]
++ echo 'Spread found'
Spread found
++ cd snapd
++ echo 'Moving to manual all the tests to skip: tests/main/auto-refresh,tests/main/failover,tests/main/ubuntu-core-services'
Moving to manual all the tests to skip: tests/main/auto-refresh,tests/main/failover,tests/main/ubuntu-core-services
+++ echo tests/main/auto-refresh,tests/main/failover,tests/main/ubuntu-core-services
+++ tr , ' '
++ tests_skip='tests/main/auto-refresh tests/main/failover tests/main/ubuntu-core-services'
++ for test in '$tests_skip'
++ '[' -f tests/main/auto-refresh/task.yaml ']'
++ cp tests/main/auto-refresh/task.yaml tests/main/auto-refresh/task.yaml.back
++ echo 'manual: true'
++ for test in '$tests_skip'
++ '[' -f tests/main/failover/task.yaml ']'
++ cp tests/main/failover/task.yaml tests/main/failover/task.yaml.back
++ echo 'manual: true'
++ for test in '$tests_skip'
++ '[' -f tests/main/ubuntu-core-services/task.yaml ']'
++ cp tests/main/ubuntu-core-services/task.yaml tests/main/ubuntu-core-services/task.yaml.back
++ echo 'manual: true'
++ echo 'Running command: spread -v external:ubuntu-core-16-arm-64:tests/'
Running command: spread -v external:ubuntu-core-16-arm-64:tests/
++ spread -v external:ubuntu-core-16-arm-64:tests/
2017-12-27 05:06:44 Found /home/ubuntu/snapd/spread.yaml.
2017-12-27 05:06:46 Project content is packed for delivery (2.19MB).
2017-12-27 05:06:46 Sequence of jobs produced with -seed=1514351206
2017-12-27 05:06:46 Allocating external:ubuntu-core-16-arm-64...
2017-12-27 05:06:46 Waiting for external:ubuntu-core-16-arm-64 to make SSH available at 10.101.51.14:22...
2017-12-27 05:06:46 Allocated external:ubuntu-core-16-arm-64.
2017-12-27 05:06:46 If killed, discard servers with: spread -reuse-pid=899 -discard
2017-12-27 05:06:46 Connecting to external:ubuntu-core-16-arm-64...
2017-12-27 05:06:46 Connected to external:ubuntu-core-16-arm-64 at 10.101.51.14:22.
2017-12-27 05:06:46 Sending project content to external:ubuntu-core-16-arm-64...
2017-12-27 05:06:48 Preparing project on external:ubuntu-core-16-arm-64...
2017-12-27 05:06:48 Preparing external:ubuntu-core-16-arm-64:tests/main/...
2017-12-27 05:11:48 WARNING: external:ubuntu-core-16-arm-64 running late. Current output:
-----
(... 82 lines above ...)

/boot/uboot/dragonboard-kernel_41.snap:
dtbs
initrd.img
kernel.img
+ BOOT=/boot/uboot/
+ systemctl stop snapd.service snapd.socket
+ tar cf /home/gopath/src/github.com/snapcore/snapd/snapd-state.tar.gz /var/lib/snapd /boot/uboot/ /etc/systemd/system/snap-core-3751.mount /etc/systemd/system/snap-core-3811.mount
tar: Removing leading `/' from member names
tar: Removing leading `/' from hard link targets
-----
.
2017-12-27 05:12:04 Preparing external:ubuntu-core-16-arm-64:tests/main/ubuntu-core-reboot...
2017-12-27 05:14:53 Executing external:ubuntu-core-16-arm-64:tests/main/ubuntu-core-reboot (1/162)...
2017-12-27 05:14:54 Rebooting external:ubuntu-core-16-arm-64 as requested...
2017-12-27 05:15:54 Restoring external:ubuntu-core-16-arm-64:tests/main/ubuntu-core-reboot...
2017-12-27 05:15:54 Preparing external:ubuntu-core-16-arm-64:tests/main/interfaces-fuse_support...
2017-12-27 05:17:49 Executing external:ubuntu-core-16-arm-64:tests/main/interfaces-fuse_support (2/162)...
2017-12-27 05:17:57 Restoring external:ubuntu-core-16-arm-64:tests/main/interfaces-fuse_support...
2017-12-27 05:17:57 Preparing external:ubuntu-core-16-arm-64:tests/main/interfaces-content...
2017-12-27 05:22:33 Executing external:ubuntu-core-16-arm-64:tests/main/interfaces-content (3/162)...
2017-12-27 05:22:57 Restoring external:ubuntu-core-16-arm-64:tests/main/interfaces-content...
2017-12-27 05:22:57 Preparing external:ubuntu-core-16-arm-64:tests/main/interfaces-bluez...
2017-12-27 05:24:27 Executing external:ubuntu-core-16-arm-64:tests/main/interfaces-bluez (4/162)...
2017-12-27 05:25:00 Restoring external:ubuntu-core-16-arm-64:tests/main/interfaces-bluez...
2017-12-27 05:25:00 Preparing external:ubuntu-core-16-arm-64:tests/main/interfaces-network-control-ip-netns...
2017-12-27 05:26:45 Executing external:ubuntu-core-16-arm-64:tests/main/interfaces-network-control-ip-netns (5/162)...
2017-12-27 05:26:46 Restoring external:ubuntu-core-16-arm-64:tests/main/interfaces-network-control-ip-netns...
2017-12-27 05:26:50 Preparing external:ubuntu-core-16-arm-64:tests/main/ubuntu-core-uboot:kernelimg...
2017-12-27 05:28:14 Executing external:ubuntu-core-16-arm-64:tests/main/ubuntu-core-uboot:kernelimg (6/162)...
2017-12-27 05:28:14 Restoring external:ubuntu-core-16-arm-64:tests/main/ubuntu-core-uboot:kernelimg...
2017-12-27 05:28:14 Preparing external:ubuntu-core-16-arm-64:tests/main/ubuntu-core-apt...
2017-12-27 05:29:37 Executing external:ubuntu-core-16-arm-64:tests/main/ubuntu-core-apt (7/162)...
2017-12-27 05:29:38 Restoring external:ubuntu-core-16-arm-64:tests/main/ubuntu-core-apt...
2017-12-27 05:29:38 Preparing external:ubuntu-core-16-arm-64:tests/main/refresh:strict_fake...
2017-12-27 05:31:01 Executing external:ubuntu-core-16-arm-64:tests/main/refresh:strict_fake (8/162)...
2017-12-27 05:31:01 Restoring external:ubuntu-core-16-arm-64:tests/main/refresh:strict_fake...
2017-12-27 05:31:02 Preparing external:ubuntu-core-16-arm-64:tests/main/remove-errors...
2017-12-27 05:34:20 Executing external:ubuntu-core-16-arm-64:tests/main/remove-errors (9/162)...
2017-12-27 05:35:35 Restoring external:ubuntu-core-16-arm-64:tests/main/remove-errors...
2017-12-27 05:35:35 Preparing external:ubuntu-core-16-arm-64:tests/main/interfaces-hooks...
2017-12-27 05:37:47 Executing external:ubuntu-core-16-arm-64:tests/main/interfaces-hooks (10/162)...
2017-12-27 05:37:52 Restoring external:ubuntu-core-16-arm-64:tests/main/interfaces-hooks...
2017-12-27 05:37:52 Preparing external:ubuntu-core-16-arm-64:tests/main/snap-run-symlink-error...
2017-12-27 05:39:50 Executing external:ubuntu-core-16-arm-64:tests/main/snap-run-symlink-error (11/162)...
2017-12-27 05:39:51 Restoring external:ubuntu-core-16-arm-64:tests/main/snap-run-symlink-error...
2017-12-27 05:39:52 Preparing external:ubuntu-core-16-arm-64:tests/main/install-sideload:reexec1...
2017-12-27 05:43:51 Executing external:ubuntu-core-16-arm-64:tests/main/install-sideload:reexec1 (12/162)...
2017-12-27 05:48:51 WARNING: external:ubuntu-core-16-arm-64 running late. Current output:
-----
(... 54 lines above ...)
+ grep -Pq '^test-snapd-devmode +.* +jailmode'
+ echo 'Sideload devmode snap fails with both --devmode and --jailmode'
Sideload devmode snap fails with both --devmode and --jailmode
+ expected='cannot use devmode and jailmode flags together'
+ snap install --devmode --jailmode ./test-snapd-devmode_1.0_all.snap
+ grep -Pzq 'cannot use devmode and jailmode flags together'
+ true
+ echo 'Sideload a second time succeeds'
Sideload a second time succeeds
+ snap install --dangerous ./test-snapd-tools_1.0_all.snap
-----
.
2017-12-27 05:50:08 Restoring external:ubuntu-core-16-arm-64:tests/main/install-sideload:reexec1...
2017-12-27 05:50:08 Preparing external:ubuntu-core-16-arm-64:tests/main/security-devpts...
2017-12-27 05:52:58 Executing external:ubuntu-core-16-arm-64:tests/main/security-devpts (13/162)...
2017-12-27 05:53:22 Restoring external:ubuntu-core-16-arm-64:tests/main/security-devpts...
2017-12-27 05:53:23 Preparing external:ubuntu-core-16-arm-64:tests/main/interfaces-timeserver-control...
2017-12-27 05:55:00 Executing external:ubuntu-core-16-arm-64:tests/main/interfaces-timeserver-control (14/162)...
2017-12-27 05:55:07 Restoring external:ubuntu-core-16-arm-64:tests/main/interfaces-timeserver-control...
2017-12-27 05:55:08 Preparing external:ubuntu-core-16-arm-64:tests/main/interfaces-content-empty-content-attr...
2017-12-27 05:59:21 Executing external:ubuntu-core-16-arm-64:tests/main/interfaces-content-empty-content-attr (15/162)...
2017-12-27 05:59:46 Restoring external:ubuntu-core-16-arm-64:tests/main/interfaces-content-empty-content-attr...
2017-12-27 05:59:46 Preparing external:ubuntu-core-16-arm-64:tests/main/find-private...
2017-12-27 06:02:39 Executing external:ubuntu-core-16-arm-64:tests/main/find-private (16/162)...
2017-12-27 06:02:41 Restoring external:ubuntu-core-16-arm-64:tests/main/find-private...
2017-12-27 06:02:42 Preparing external:ubuntu-core-16-arm-64:tests/main/snap-switch...
2017-12-27 06:04:03 Executing external:ubuntu-core-16-arm-64:tests/main/snap-switch (17/162)...
2017-12-27 06:04:32 Restoring external:ubuntu-core-16-arm-64:tests/main/snap-switch...
2017-12-27 06:04:32 Preparing external:ubuntu-core-16-arm-64:tests/main/interfaces-network-observe...
2017-12-27 06:08:37 Executing external:ubuntu-core-16-arm-64:tests/main/interfaces-network-observe (18/162)...
2017-12-27 06:09:05 Restoring external:ubuntu-core-16-arm-64:tests/main/interfaces-network-observe...
2017-12-27 06:09:05 Preparing external:ubuntu-core-16-arm-64:tests/main/interfaces-browser-support:allow...
2017-12-27 06:11:08 Executing external:ubuntu-core-16-arm-64:tests/main/interfaces-browser-support:allow (19/162)...
2017-12-27 06:11:22 Restoring external:ubuntu-core-16-arm-64:tests/main/interfaces-browser-support:allow...
2017-12-27 06:11:22 Preparing external:ubuntu-core-16-arm-64:tests/main/snap-connect...
2017-12-27 06:15:16 Executing external:ubuntu-core-16-arm-64:tests/main/snap-connect (20/162)...
2017-12-27 06:18:52 Restoring external:ubuntu-core-16-arm-64:tests/main/snap-connect...
2017-12-27 06:18:52 Preparing external:ubuntu-core-16-arm-64:tests/main/snapctl-configure-core...
2017-12-27 06:20:22 Executing external:ubuntu-core-16-arm-64:tests/main/snapctl-configure-core (21/162)...
2017-12-27 06:20:54 Restoring external:ubuntu-core-16-arm-64:tests/main/snapctl-configure-core...
2017-12-27 06:20:55 Preparing external:ubuntu-core-16-arm-64:tests/main/ubuntu-core-writablepaths...
2017-12-27 06:22:49 Executing external:ubuntu-core-16-arm-64:tests/main/ubuntu-core-writablepaths (22/162)...
2017-12-27 06:22:52 Restoring external:ubuntu-core-16-arm-64:tests/main/ubuntu-core-writablepaths...
2017-12-27 06:22:52 Preparing external:ubuntu-core-16-arm-64:tests/main/snap-multi-service-failing...
2017-12-27 06:26:26 Executing external:ubuntu-core-16-arm-64:tests/main/snap-multi-service-failing (23/162)...
2017-12-27 06:26:46 Restoring external:ubuntu-core-16-arm-64:tests/main/snap-multi-service-failing...
2017-12-27 06:26:47 Preparing external:ubuntu-core-16-arm-64:tests/main/security-device-cgroups-devmode...
2017-12-27 06:28:30 Executing external:ubuntu-core-16-arm-64:tests/main/security-device-cgroups-devmode (24/162)...
2017-12-27 06:28:55 Restoring external:ubuntu-core-16-arm-64:tests/main/security-device-cgroups-devmode...
2017-12-27 06:28:55 Preparing external:ubuntu-core-16-arm-64:tests/main/interfaces-upower-observe...
2017-12-27 06:33:25 Executing external:ubuntu-core-16-arm-64:tests/main/interfaces-upower-observe (25/162)...
2017-12-27 06:33:43 Restoring external:ubuntu-core-16-arm-64:tests/main/interfaces-upower-observe...
2017-12-27 06:33:43 Preparing external:ubuntu-core-16-arm-64:tests/main/security-profiles...
2017-12-27 06:36:07 Executing external:ubuntu-core-16-arm-64:tests/main/security-profiles (26/162)...
2017-12-27 06:36:26 Restoring external:ubuntu-core-16-arm-64:tests/main/security-profiles...
2017-12-27 06:36:27 Preparing external:ubuntu-core-16-arm-64:tests/main/abort...
2017-12-27 06:37:53 Executing external:ubuntu-core-16-arm-64:tests/main/abort (27/162)...
2017-12-27 06:39:59 Restoring external:ubuntu-core-16-arm-64:tests/main/abort...
2017-12-27 06:39:59 Preparing external:ubuntu-core-16-arm-64:tests/main/interfaces-framebuffer...
2017-12-27 06:42:15 Executing external:ubuntu-core-16-arm-64:tests/main/interfaces-framebuffer (28/162)...
2017-12-27 06:42:21 Restoring external:ubuntu-core-16-arm-64:tests/main/interfaces-framebuffer...
2017-12-27 06:42:21 Preparing external:ubuntu-core-16-arm-64:tests/main/interfaces-log-observe...
2017-12-27 06:45:46 Executing external:ubuntu-core-16-arm-64:tests/main/interfaces-log-observe (29/162)...
2017-12-27 06:46:39 Restoring external:ubuntu-core-16-arm-64:tests/main/interfaces-log-observe...
2017-12-27 06:46:39 Preparing external:ubuntu-core-16-arm-64:tests/main/interfaces-content-mkdir-writable:data...
2017-12-27 06:49:04 Executing external:ubuntu-core-16-arm-64:tests/main/interfaces-content-mkdir-writable:data (30/162)...
2017-12-27 06:49:12 Restoring external:ubuntu-core-16-arm-64:tests/main/interfaces-content-mkdir-writable:data...
2017-12-27 06:49:12 Preparing external:ubuntu-core-16-arm-64:tests/main/op-remove...
2017-12-27 06:50:38 Executing external:ubuntu-core-16-arm-64:tests/main/op-remove (31/162)...
2017-12-27 06:51:02 Restoring external:ubuntu-core-16-arm-64:tests/main/op-remove...
2017-12-27 06:51:02 Preparing external:ubuntu-core-16-arm-64:tests/main/refresh:strict_remote...
2017-12-27 06:55:56 Executing external:ubuntu-core-16-arm-64:tests/main/refresh:strict_remote (32/162)...
2017-12-27 06:58:43 Restoring external:ubuntu-core-16-arm-64:tests/main/refresh:strict_remote...
2017-12-27 06:58:43 Preparing external:ubuntu-core-16-arm-64:tests/main/install-remove-multi...
2017-12-27 07:03:08 Executing external:ubuntu-core-16-arm-64:tests/main/install-remove-multi (33/162)...
2017-12-27 07:04:32 Restoring external:ubuntu-core-16-arm-64:tests/main/install-remove-multi...
2017-12-27 07:04:32 Preparing external:ubuntu-core-16-arm-64:tests/main/help:interfaces...
2017-12-27 07:05:51 Executing external:ubuntu-core-16-arm-64:tests/main/help:interfaces (34/162)...
2017-12-27 07:05:52 Restoring external:ubuntu-core-16-arm-64:tests/main/help:interfaces...
2017-12-27 07:05:52 Preparing external:ubuntu-core-16-arm-64:tests/main/fakestore-install...
2017-12-27 07:09:02 Executing external:ubuntu-core-16-arm-64:tests/main/fakestore-install (35/162)...
2017-12-27 07:09:03 Restoring external:ubuntu-core-16-arm-64:tests/main/fakestore-install...
2017-12-27 07:09:03 Preparing external:ubuntu-core-16-arm-64:tests/main/snap-seccomp...
2017-12-27 07:13:12 Executing external:ubuntu-core-16-arm-64:tests/main/snap-seccomp (36/162)...
2017-12-27 07:17:03 Restoring external:ubuntu-core-16-arm-64:tests/main/snap-seccomp...
2017-12-27 07:17:04 Preparing external:ubuntu-core-16-arm-64:tests/main/known-remote...
2017-12-27 07:18:56 Executing external:ubuntu-core-16-arm-64:tests/main/known-remote (37/162)...
2017-12-27 07:18:59 Restoring external:ubuntu-core-16-arm-64:tests/main/known-remote...
2017-12-27 07:18:59 Preparing external:ubuntu-core-16-arm-64:tests/main/known...
2017-12-27 07:20:27 Executing external:ubuntu-core-16-arm-64:tests/main/known (38/162)...
2017-12-27 07:20:28 Restoring external:ubuntu-core-16-arm-64:tests/main/known...
2017-12-27 07:20:29 Preparing external:ubuntu-core-16-arm-64:tests/main/try-snap-goes-away:network_bind_consumer...
2017-12-27 07:24:04 Executing external:ubuntu-core-16-arm-64:tests/main/try-snap-goes-away:network_bind_consumer (39/162)...
2017-12-27 07:25:28 Restoring external:ubuntu-core-16-arm-64:tests/main/try-snap-goes-away:network_bind_consumer...
2017-12-27 07:25:28 Preparing external:ubuntu-core-16-arm-64:tests/main/snap-interface...
2017-12-27 07:28:22 Executing external:ubuntu-core-16-arm-64:tests/main/snap-interface (40/162)...
2017-12-27 07:28:23 Restoring external:ubuntu-core-16-arm-64:tests/main/snap-interface...
2017-12-27 07:28:23 Preparing external:ubuntu-core-16-arm-64:tests/main/interfaces-netlink-connector...
2017-12-27 07:32:57 Executing external:ubuntu-core-16-arm-64:tests/main/interfaces-netlink-connector (41/162)...
2017-12-27 07:33:25 Restoring external:ubuntu-core-16-arm-64:tests/main/interfaces-netlink-connector...
2017-12-27 07:33:25 Preparing external:ubuntu-core-16-arm-64:tests/main/interfaces-bluetooth-control...
2017-12-27 07:35:41 Executing external:ubuntu-core-16-arm-64:tests/main/interfaces-bluetooth-control (42/162)...
2017-12-27 07:35:46 Restoring external:ubuntu-core-16-arm-64:tests/main/interfaces-bluetooth-control...
2017-12-27 07:35:46 Preparing external:ubuntu-core-16-arm-64:tests/main/security-device-cgroups-jailmode...
2017-12-27 07:37:27 Executing external:ubuntu-core-16-arm-64:tests/main/security-device-cgroups-jailmode (43/162)...
2017-12-27 07:37:43 Restoring external:ubuntu-core-16-arm-64:tests/main/security-device-cgroups-jailmode...
2017-12-27 07:37:43 Preparing external:ubuntu-core-16-arm-64:tests/main/xauth-migration...
2017-12-27 07:39:43 Executing external:ubuntu-core-16-arm-64:tests/main/xauth-migration (44/162)...
2017-12-27 07:41:21 Restoring external:ubuntu-core-16-arm-64:tests/main/xauth-migration...
2017-12-27 07:41:22 Preparing external:ubuntu-core-16-arm-64:tests/main/refresh:classic_fake...
2017-12-27 07:45:22 Executing external:ubuntu-core-16-arm-64:tests/main/refresh:classic_fake (45/162)...
2017-12-27 07:45:22 Restoring external:ubuntu-core-16-arm-64:tests/main/refresh:classic_fake...
2017-12-27 07:45:23 Preparing external:ubuntu-core-16-arm-64:tests/main/interfaces-kernel-module-control...
2017-12-27 07:50:23 WARNING: external:ubuntu-core-16-arm-64 running late. Current output:
-----
(... 87 lines above ...)
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
+++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/quiet.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/boot.sh
+++ GRUB_EDITENV=grub-editenv
+++ case "$SPREAD_SYSTEM" in
+ [[ ubuntu-core-16-arm-64 != ubuntu-core-16-* ]]
+ echo 'Given a snap declaring a plug on the kernel-module-control interface is installed'
Given a snap declaring a plug on the kernel-module-control interface is installed
+ snap install --edge test-snapd-kernel-module-consumer
-----
.
2017-12-27 07:51:07 Executing external:ubuntu-core-16-arm-64:tests/main/interfaces-kernel-module-control (46/162)...
2017-12-27 07:52:12 Restoring external:ubuntu-core-16-arm-64:tests/main/interfaces-kernel-module-control...
2017-12-27 07:52:12 Preparing external:ubuntu-core-16-arm-64:tests/main/help:install...
2017-12-27 07:54:20 Executing external:ubuntu-core-16-arm-64:tests/main/help:install (47/162)...
2017-12-27 07:54:21 Restoring external:ubuntu-core-16-arm-64:tests/main/help:install...
2017-12-27 07:54:21 Preparing external:ubuntu-core-16-arm-64:tests/main/security-device-cgroups:uinput...
2017-12-27 07:55:45 Executing external:ubuntu-core-16-arm-64:tests/main/security-device-cgroups:uinput (48/162)...
2017-12-27 07:56:05 Restoring external:ubuntu-core-16-arm-64:tests/main/security-device-cgroups:uinput...
2017-12-27 07:56:06 Preparing external:ubuntu-core-16-arm-64:tests/main/op-remove-retry...
2017-12-27 07:57:30 Executing external:ubuntu-core-16-arm-64:tests/main/op-remove-retry (49/162)...
2017-12-27 07:57:56 Restoring external:ubuntu-core-16-arm-64:tests/main/op-remove-retry...
2017-12-27 07:57:56 Preparing external:ubuntu-core-16-arm-64:tests/main/snap-run-hook:reexec1...
2017-12-27 08:02:05 Executing external:ubuntu-core-16-arm-64:tests/main/snap-run-hook:reexec1 (50/162)...
2017-12-27 08:02:11 Restoring external:ubuntu-core-16-arm-64:tests/main/snap-run-hook:reexec1...
2017-12-27 08:02:12 Preparing external:ubuntu-core-16-arm-64:tests/main/snap-set...
2017-12-27 08:07:12 WARNING: external:ubuntu-core-16-arm-64 running late. Current output:
-----
(... 104 lines above ...)
basic 1.0 installed
+ echo 'Build failing hooks package'
Build failing hooks package
+ snap pack /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps/failing-config-hooks
built: failing-config-hooks_1.0_all.snap
+ echo 'Build package with hook to run snapctl set'
Build package with hook to run snapctl set
+ snap pack /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps/snapctl-hooks
built: snapctl-hooks_1.0_all.snap
+ snap install --dangerous snapctl-hooks_1.0_all.snap
-----
.
2017-12-27 08:07:35 Executing external:ubuntu-core-16-arm-64:tests/main/snap-set (51/162)...
2017-12-27 08:08:40 Restoring external:ubuntu-core-16-arm-64:tests/main/snap-set...
2017-12-27 08:08:40 Preparing external:ubuntu-core-16-arm-64:tests/main/security-device-cgroups:kmsg...
2017-12-27 08:10:02 Executing external:ubuntu-core-16-arm-64:tests/main/security-device-cgroups:kmsg (52/162)...
2017-12-27 08:10:26 Restoring external:ubuntu-core-16-arm-64:tests/main/security-device-cgroups:kmsg...
2017-12-27 08:10:27 Preparing external:ubuntu-core-16-arm-64:tests/main/user-data-handling...
2017-12-27 08:12:26 Executing external:ubuntu-core-16-arm-64:tests/main/user-data-handling (53/162)...
2017-12-27 08:15:21 Restoring external:ubuntu-core-16-arm-64:tests/main/user-data-handling...
2017-12-27 08:15:21 Preparing external:ubuntu-core-16-arm-64:tests/main/snapctl-services...
2017-12-27 08:18:21 Error preparing external:ubuntu-core-16-arm-64:tests/main/snapctl-services : 
-----
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare-restore.sh --prepare-project-each
+ set -e
+ set -o pipefail
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/quiet.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/boot.sh
++ GRUB_EDITENV=grub-editenv
++ case "$SPREAD_SYSTEM" in
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/dirs.sh
++ export SNAP_MOUNT_DIR=/snap
++ SNAP_MOUNT_DIR=/snap
++ export LIBEXECDIR=/usr/lib
++ LIBEXECDIR=/usr/lib
++ case "$SPREAD_SYSTEM" in
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/quiet.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/random.sh
+ case "$1" in
+ prepare_project_each
+ case "$SPREAD_SYSTEM" in
+ journalctl --rotate
+ sleep .1
+ journalctl --vacuum-time=1ms
Deleted archived journal /run/log/journal/ca6e64f3ce124855b482aff606f31054/system@1fd5442ac6564f2b98b58bee63aa3dce-000000000000212a-0005614df05e2a6b.journal (1012.0K).
Vacuuming done, freed 1012.0K of archived journals on disk.
+ dmesg -c
+ fixup_dev_random
+ mv /dev/random /dev/random.orig
+ mknod /dev/random c 1 9
+ kill_gpg_agent
+ pkill -9 -e gpg-agent
+ true
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/reset.sh --reuse-core
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/dirs.sh
++ export SNAP_MOUNT_DIR=/snap
++ SNAP_MOUNT_DIR=/snap
++ export LIBEXECDIR=/usr/lib
++ LIBEXECDIR=/usr/lib
++ case "$SPREAD_SYSTEM" in
+ [[ ubuntu-core-16-arm-64 == ubuntu-core-16-* ]]
+ reset_all_snap --reuse-core
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/names.sh
+++ snap list
+++ sed -n 's/^\(pc\|pi[23]\|dragonboard\|cm3\) .*/\1/p'
++ gadget_name=dragonboard
++ kernel_name=dragonboard-kernel
++ '[' dragonboard-kernel = pi3-kernel ']'
++ '[' dragonboard-kernel = cm3-kernel ']'
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=README
+ case "$snap" in
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=bin
+ case "$snap" in
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=core
+ case "$snap" in
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=dragonboard
+ case "$snap" in
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=dragonboard-kernel
+ case "$snap" in
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=manifest.yaml
+ case "$snap" in
+ snap remove manifest.yaml
snap "manifest.yaml" is not installed
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=snapcraft.yaml
+ case "$snap" in
+ snap remove snapcraft.yaml
snap "snapcraft.yaml" is not installed
+ systemctl stop snapd.service snapd.socket
+ rm -rf /var/lib/snapd/apparmor /var/lib/snapd/assertions /var/lib/snapd/auto-import /var/lib/snapd/cache /var/lib/snapd/cookie /var/lib/snapd/desktop /var/lib/snapd/device /var/lib/snapd/environment /var/lib/snapd/firstboot /var/lib/snapd/hostfs /var/lib/snapd/lib /var/lib/snapd/mount /var/lib/snapd/seccomp /var/lib/snapd/seed /var/lib/snapd/snaps /var/lib/snapd/state.json /var/lib/snapd/state.json.bak /var/lib/snapd/void
+ tar -C/ -xf /home/gopath/src/github.com/snapcore/snapd/snapd-state.tar.gz

<kill-timeout reached>
-----
.
2017-12-27 08:18:31 Debug output for external:ubuntu-core-16-arm-64:tests/main/snapctl-services : 
-----
+ '[' 1 = 1 ']'
+ echo '# journal messages for snapd'
# journal messages for snapd
+ journalctl -u snapd
-- Logs begin at Wed 2017-12-27 08:15:51 UTC, end at Wed 2017-12-27 08:18:53 UTC. --
Dec 27 08:15:51 localhost.localdomain snapd[28619]: 2017/12/27 08:15:51.826760 daemon.go:233: DEBUG: pid=29085;uid=0;@ GET /v2/snaps 6.721ms 200
Dec 27 08:15:51 localhost.localdomain snapd[28619]: 2017/12/27 08:15:51.900049 daemon.go:233: DEBUG: pid=29093;uid=0;@ POST /v2/snaps/manifest.yaml 1.053ms 400
Dec 27 08:15:51 localhost.localdomain snapd[28619]: 2017/12/27 08:15:51.967236 daemon.go:233: DEBUG: pid=29099;uid=0;@ POST /v2/snaps/snapcraft.yaml 876µs 400
Dec 27 08:15:51 localhost.localdomain systemd[1]: Stopping Snappy daemon...
Dec 27 08:15:51 localhost.localdomain snapd[28619]: 2017/12/27 08:15:51.987953 main.go:78: Exiting on terminated signal.
Dec 27 08:15:51 localhost.localdomain systemd[1]: Stopped Snappy daemon.
+ echo '# apparmor denials '
# apparmor denials 
+ dmesg --ctime
+ grep DENIED
+ true
+ echo '# seccomp denials (kills) '
# seccomp denials (kills) 
+ dmesg --ctime
+ grep type=1326
+ true
+ echo '# snap interfaces'
# snap interfaces
+ snap interfaces
error: cannot communicate with server: Get http://localhost/v2/interfaces: dial unix /run/snapd.socket: connect: connection refused
+ true
-----
.
2017-12-27 08:18:31 Restoring external:ubuntu-core-16-arm-64:tests/main/snapctl-services...
2017-12-27 08:18:34 Preparing external:ubuntu-core-16-arm-64:tests/main/ubuntu-core-os-release...
2017-12-27 08:18:39 Error preparing external:ubuntu-core-16-arm-64:tests/main/ubuntu-core-os-release : 
-----
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare-restore.sh --prepare-project-each
+ set -e
+ set -o pipefail
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/quiet.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/boot.sh
++ GRUB_EDITENV=grub-editenv
++ case "$SPREAD_SYSTEM" in
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/dirs.sh
++ export SNAP_MOUNT_DIR=/snap
++ SNAP_MOUNT_DIR=/snap
++ export LIBEXECDIR=/usr/lib
++ LIBEXECDIR=/usr/lib
++ case "$SPREAD_SYSTEM" in
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/quiet.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/random.sh
+ case "$1" in
+ prepare_project_each
+ case "$SPREAD_SYSTEM" in
+ journalctl --rotate
+ sleep .1
+ journalctl --vacuum-time=1ms
Deleted archived journal /run/log/journal/ca6e64f3ce124855b482aff606f31054/system@1fd5442ac6564f2b98b58bee63aa3dce-0000000000002218-0005614e01f0357e.journal (1012.0K).
Vacuuming done, freed 1012.0K of archived journals on disk.
+ dmesg -c
+ fixup_dev_random
+ mv /dev/random /dev/random.orig
+ mknod /dev/random c 1 9
+ kill_gpg_agent
+ pkill -9 -e gpg-agent
+ true
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/reset.sh --reuse-core
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/dirs.sh
++ export SNAP_MOUNT_DIR=/snap
++ SNAP_MOUNT_DIR=/snap
++ export LIBEXECDIR=/usr/lib
++ LIBEXECDIR=/usr/lib
++ case "$SPREAD_SYSTEM" in
+ [[ ubuntu-core-16-arm-64 == ubuntu-core-16-* ]]
+ reset_all_snap --reuse-core
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/names.sh
+++ snap list
+++ sed -n 's/^\(pc\|pi[23]\|dragonboard\|cm3\) .*/\1/p'
error: cannot list snaps: cannot communicate with server: Get http://localhost/v2/snaps: dial unix /run/snapd.socket: connect: connection refused
++ gadget_name=
++ kernel_name=-kernel
++ '[' -kernel = pi3-kernel ']'
++ '[' -kernel = cm3-kernel ']'
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=README
+ case "$snap" in
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=bin
+ case "$snap" in
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=core
+ case "$snap" in
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=dragonboard
+ case "$snap" in
+ snap remove dragonboard
error: cannot communicate with server: Post http://localhost/v2/snaps/dragonboard: dial unix /run/snapd.socket: connect: connection refused
-----
.
2017-12-27 08:18:45 Debug output for external:ubuntu-core-16-arm-64:tests/main/ubuntu-core-os-release : 
-----
+ '[' 1 = 1 ']'
+ echo '# journal messages for snapd'
# journal messages for snapd
+ journalctl -u snapd
-- No entries --
+ echo '# apparmor denials '
# apparmor denials 
+ dmesg --ctime
+ grep DENIED
+ true
+ echo '# seccomp denials (kills) '
# seccomp denials (kills) 
+ dmesg --ctime
+ grep type=1326
+ true
+ echo '# snap interfaces'
# snap interfaces
+ snap interfaces
error: cannot communicate with server: Get http://localhost/v2/interfaces: dial unix /run/snapd.socket: connect: connection refused
+ true
-----
.
2017-12-27 08:18:45 Restoring external:ubuntu-core-16-arm-64:tests/main/ubuntu-core-os-release...
2017-12-27 08:18:45 Preparing external:ubuntu-core-16-arm-64:tests/main/refresh:classic_remote...
2017-12-27 08:18:51 Error preparing external:ubuntu-core-16-arm-64:tests/main/refresh:classic_remote : 
-----
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare-restore.sh --prepare-project-each
+ set -e
+ set -o pipefail
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/quiet.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/boot.sh
++ GRUB_EDITENV=grub-editenv
++ case "$SPREAD_SYSTEM" in
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/dirs.sh
++ export SNAP_MOUNT_DIR=/snap
++ SNAP_MOUNT_DIR=/snap
++ export LIBEXECDIR=/usr/lib
++ LIBEXECDIR=/usr/lib
++ case "$SPREAD_SYSTEM" in
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/quiet.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/random.sh
+ case "$1" in
+ prepare_project_each
+ case "$SPREAD_SYSTEM" in
+ journalctl --rotate
+ sleep .1
+ journalctl --vacuum-time=1ms
Deleted archived journal /run/log/journal/ca6e64f3ce124855b482aff606f31054/system@1fd5442ac6564f2b98b58bee63aa3dce-000000000000222f-0005614e0d660445.journal (1012.0K).
Vacuuming done, freed 1012.0K of archived journals on disk.
+ dmesg -c
+ fixup_dev_random
+ mv /dev/random /dev/random.orig
+ mknod /dev/random c 1 9
+ kill_gpg_agent
+ pkill -9 -e gpg-agent
+ true
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/reset.sh --reuse-core
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/dirs.sh
++ export SNAP_MOUNT_DIR=/snap
++ SNAP_MOUNT_DIR=/snap
++ export LIBEXECDIR=/usr/lib
++ LIBEXECDIR=/usr/lib
++ case "$SPREAD_SYSTEM" in
+ [[ ubuntu-core-16-arm-64 == ubuntu-core-16-* ]]
+ reset_all_snap --reuse-core
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/names.sh
+++ snap list
+++ sed -n 's/^\(pc\|pi[23]\|dragonboard\|cm3\) .*/\1/p'
error: cannot list snaps: cannot communicate with server: Get http://localhost/v2/snaps: dial unix /run/snapd.socket: connect: connection refused
++ gadget_name=
++ kernel_name=-kernel
++ '[' -kernel = pi3-kernel ']'
++ '[' -kernel = cm3-kernel ']'
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=README
+ case "$snap" in
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=bin
+ case "$snap" in
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=core
+ case "$snap" in
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=dragonboard
+ case "$snap" in
+ snap remove dragonboard
error: cannot communicate with server: Post http://localhost/v2/snaps/dragonboard: dial unix /run/snapd.socket: connect: connection refused
-----
.
2017-12-27 08:18:56 Debug output for external:ubuntu-core-16-arm-64:tests/main/refresh:classic_remote : 
-----
+ '[' 1 = 1 ']'
+ echo '# journal messages for snapd'
# journal messages for snapd
+ journalctl -u snapd
-- No entries --
+ echo '# apparmor denials '
# apparmor denials 
+ dmesg --ctime
+ grep DENIED
+ true
+ echo '# seccomp denials (kills) '
# seccomp denials (kills) 
+ dmesg --ctime
+ grep type=1326
+ true
+ echo '# snap interfaces'
# snap interfaces
+ snap interfaces
error: cannot communicate with server: Get http://localhost/v2/interfaces: dial unix /run/snapd.socket: connect: connection refused
+ true
-----
.
2017-12-27 08:18:56 Restoring external:ubuntu-core-16-arm-64:tests/main/refresh:classic_remote...
2017-12-27 08:18:56 Preparing external:ubuntu-core-16-arm-64:tests/main/ubuntu-core-fan...
2017-12-27 08:19:02 Error preparing external:ubuntu-core-16-arm-64:tests/main/ubuntu-core-fan : 
-----
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare-restore.sh --prepare-project-each
+ set -e
+ set -o pipefail
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/quiet.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/boot.sh
++ GRUB_EDITENV=grub-editenv
++ case "$SPREAD_SYSTEM" in
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/dirs.sh
++ export SNAP_MOUNT_DIR=/snap
++ SNAP_MOUNT_DIR=/snap
++ export LIBEXECDIR=/usr/lib
++ LIBEXECDIR=/usr/lib
++ case "$SPREAD_SYSTEM" in
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/quiet.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/random.sh
+ case "$1" in
+ prepare_project_each
+ case "$SPREAD_SYSTEM" in
+ journalctl --rotate
+ sleep .1
+ journalctl --vacuum-time=1ms
Deleted archived journal /run/log/journal/ca6e64f3ce124855b482aff606f31054/system@1fd5442ac6564f2b98b58bee63aa3dce-000000000000223a-0005614e0e114f14.journal (1012.0K).
Vacuuming done, freed 1012.0K of archived journals on disk.
+ dmesg -c
+ fixup_dev_random
+ mv /dev/random /dev/random.orig
+ mknod /dev/random c 1 9
+ kill_gpg_agent
+ pkill -9 -e gpg-agent
+ true
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/reset.sh --reuse-core
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/dirs.sh
++ export SNAP_MOUNT_DIR=/snap
++ SNAP_MOUNT_DIR=/snap
++ export LIBEXECDIR=/usr/lib
++ LIBEXECDIR=/usr/lib
++ case "$SPREAD_SYSTEM" in
+ [[ ubuntu-core-16-arm-64 == ubuntu-core-16-* ]]
+ reset_all_snap --reuse-core
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/names.sh
+++ snap list
+++ sed -n 's/^\(pc\|pi[23]\|dragonboard\|cm3\) .*/\1/p'
error: cannot list snaps: cannot communicate with server: Get http://localhost/v2/snaps: dial unix /run/snapd.socket: connect: connection refused
++ gadget_name=
++ kernel_name=-kernel
++ '[' -kernel = pi3-kernel ']'
++ '[' -kernel = cm3-kernel ']'
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=README
+ case "$snap" in
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=bin
+ case "$snap" in
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=core
+ case "$snap" in
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=dragonboard
+ case "$snap" in
+ snap remove dragonboard
error: cannot communicate with server: Post http://localhost/v2/snaps/dragonboard: dial unix /run/snapd.socket: connect: connection refused
-----
.
2017-12-27 08:19:07 Debug output for external:ubuntu-core-16-arm-64:tests/main/ubuntu-core-fan : 
-----
+ '[' 1 = 1 ']'
+ echo '# journal messages for snapd'
# journal messages for snapd
+ journalctl -u snapd
-- No entries --
+ echo '# apparmor denials '
# apparmor denials 
+ dmesg --ctime
+ grep DENIED
+ true
+ echo '# seccomp denials (kills) '
# seccomp denials (kills) 
+ dmesg --ctime
+ grep type=1326
+ true
+ echo '# snap interfaces'
# snap interfaces
+ snap interfaces
error: cannot communicate with server: Get http://localhost/v2/interfaces: dial unix /run/snapd.socket: connect: connection refused
+ true
-----
.
2017-12-27 08:19:07 Restoring external:ubuntu-core-16-arm-64:tests/main/ubuntu-core-fan...
2017-12-27 08:19:10 Preparing external:ubuntu-core-16-arm-64:tests/main/security-apparmor...
2017-12-27 08:19:15 Error preparing external:ubuntu-core-16-arm-64:tests/main/security-apparmor : 
-----
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare-restore.sh --prepare-project-each
+ set -e
+ set -o pipefail
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/quiet.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/boot.sh
++ GRUB_EDITENV=grub-editenv
++ case "$SPREAD_SYSTEM" in
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/dirs.sh
++ export SNAP_MOUNT_DIR=/snap
++ SNAP_MOUNT_DIR=/snap
++ export LIBEXECDIR=/usr/lib
++ LIBEXECDIR=/usr/lib
++ case "$SPREAD_SYSTEM" in
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/quiet.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/random.sh
+ case "$1" in
+ prepare_project_each
+ case "$SPREAD_SYSTEM" in
+ journalctl --rotate
+ sleep .1
+ journalctl --vacuum-time=1ms
Deleted archived journal /run/log/journal/ca6e64f3ce124855b482aff606f31054/system@1fd5442ac6564f2b98b58bee63aa3dce-0000000000002244-0005614e0ebec2a5.journal (1012.0K).
Vacuuming done, freed 1012.0K of archived journals on disk.
+ dmesg -c
+ fixup_dev_random
+ mv /dev/random /dev/random.orig
+ mknod /dev/random c 1 9
+ kill_gpg_agent
+ pkill -9 -e gpg-agent
+ true
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/reset.sh --reuse-core
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/dirs.sh
++ export SNAP_MOUNT_DIR=/snap
++ SNAP_MOUNT_DIR=/snap
++ export LIBEXECDIR=/usr/lib
++ LIBEXECDIR=/usr/lib
++ case "$SPREAD_SYSTEM" in
+ [[ ubuntu-core-16-arm-64 == ubuntu-core-16-* ]]
+ reset_all_snap --reuse-core
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/names.sh
+++ snap list
+++ sed -n 's/^\(pc\|pi[23]\|dragonboard\|cm3\) .*/\1/p'
error: cannot list snaps: cannot communicate with server: Get http://localhost/v2/snaps: dial unix /run/snapd.socket: connect: connection refused
++ gadget_name=
++ kernel_name=-kernel
++ '[' -kernel = pi3-kernel ']'
++ '[' -kernel = cm3-kernel ']'
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=README
+ case "$snap" in
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=bin
+ case "$snap" in
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=core
+ case "$snap" in
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=dragonboard
+ case "$snap" in
+ snap remove dragonboard
error: cannot communicate with server: Post http://localhost/v2/snaps/dragonboard: dial unix /run/snapd.socket: connect: connection refused
-----
.
2017-12-27 08:19:20 Debug output for external:ubuntu-core-16-arm-64:tests/main/security-apparmor : 
-----
+ '[' 1 = 1 ']'
+ echo '# journal messages for snapd'
# journal messages for snapd
+ journalctl -u snapd
-- No entries --
+ echo '# apparmor denials '
# apparmor denials 
+ dmesg --ctime
+ grep DENIED
+ true
+ echo '# seccomp denials (kills) '
# seccomp denials (kills) 
+ dmesg --ctime
+ grep type=1326
+ true
+ echo '# snap interfaces'
# snap interfaces
+ snap interfaces
error: cannot communicate with server: Get http://localhost/v2/interfaces: dial unix /run/snapd.socket: connect: connection refused
+ true
-----
.
2017-12-27 08:19:20 Restoring external:ubuntu-core-16-arm-64:tests/main/security-apparmor...
2017-12-27 08:19:21 Preparing external:ubuntu-core-16-arm-64:tests/main/help:abort...
2017-12-27 08:19:26 Error preparing external:ubuntu-core-16-arm-64:tests/main/help:abort : 
-----
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare-restore.sh --prepare-project-each
+ set -e
+ set -o pipefail
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/quiet.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/boot.sh
++ GRUB_EDITENV=grub-editenv
++ case "$SPREAD_SYSTEM" in
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/dirs.sh
++ export SNAP_MOUNT_DIR=/snap
++ SNAP_MOUNT_DIR=/snap
++ export LIBEXECDIR=/usr/lib
++ LIBEXECDIR=/usr/lib
++ case "$SPREAD_SYSTEM" in
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/quiet.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/random.sh
+ case "$1" in
+ prepare_project_each
+ case "$SPREAD_SYSTEM" in
+ journalctl --rotate
+ sleep .1
+ journalctl --vacuum-time=1ms
Deleted archived journal /run/log/journal/ca6e64f3ce124855b482aff606f31054/system@1fd5442ac6564f2b98b58bee63aa3dce-000000000000224e-0005614e0f87ab6a.journal (1012.0K).
Vacuuming done, freed 1012.0K of archived journals on disk.
+ dmesg -c
+ fixup_dev_random
+ mv /dev/random /dev/random.orig
+ mknod /dev/random c 1 9
+ kill_gpg_agent
+ pkill -9 -e gpg-agent
+ true
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/reset.sh --reuse-core
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/dirs.sh
++ export SNAP_MOUNT_DIR=/snap
++ SNAP_MOUNT_DIR=/snap
++ export LIBEXECDIR=/usr/lib
++ LIBEXECDIR=/usr/lib
++ case "$SPREAD_SYSTEM" in
+ [[ ubuntu-core-16-arm-64 == ubuntu-core-16-* ]]
+ reset_all_snap --reuse-core
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/names.sh
+++ snap list
+++ sed -n 's/^\(pc\|pi[23]\|dragonboard\|cm3\) .*/\1/p'
error: cannot list snaps: cannot communicate with server: Get http://localhost/v2/snaps: dial unix /run/snapd.socket: connect: connection refused
++ gadget_name=
++ kernel_name=-kernel
++ '[' -kernel = pi3-kernel ']'
++ '[' -kernel = cm3-kernel ']'
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=README
+ case "$snap" in
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=bin
+ case "$snap" in
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=core
+ case "$snap" in
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=dragonboard
+ case "$snap" in
+ snap remove dragonboard
error: cannot communicate with server: Post http://localhost/v2/snaps/dragonboard: dial unix /run/snapd.socket: connect: connection refused
-----
.
2017-12-27 08:19:32 Debug output for external:ubuntu-core-16-arm-64:tests/main/help:abort : 
-----
+ '[' 1 = 1 ']'
+ echo '# journal messages for snapd'
# journal messages for snapd
+ journalctl -u snapd
-- No entries --
+ echo '# apparmor denials '
# apparmor denials 
+ dmesg --ctime
+ grep DENIED
+ true
+ echo '# seccomp denials (kills) '
# seccomp denials (kills) 
+ dmesg --ctime
+ grep type=1326
+ true
+ echo '# snap interfaces'
# snap interfaces
+ snap interfaces
error: cannot communicate with server: Get http://localhost/v2/interfaces: dial unix /run/snapd.socket: connect: connection refused
+ true
-----
.
2017-12-27 08:19:32 Restoring external:ubuntu-core-16-arm-64:tests/main/help:abort...
2017-12-27 08:19:32 Preparing external:ubuntu-core-16-arm-64:tests/main/interfaces-firewall-control...
2017-12-27 08:19:38 Error preparing external:ubuntu-core-16-arm-64:tests/main/interfaces-firewall-control : 
-----
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare-restore.sh --prepare-project-each
+ set -e
+ set -o pipefail
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/quiet.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/boot.sh
++ GRUB_EDITENV=grub-editenv
++ case "$SPREAD_SYSTEM" in
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/dirs.sh
++ export SNAP_MOUNT_DIR=/snap
++ SNAP_MOUNT_DIR=/snap
++ export LIBEXECDIR=/usr/lib
++ LIBEXECDIR=/usr/lib
++ case "$SPREAD_SYSTEM" in
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/quiet.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/random.sh
+ case "$1" in
+ prepare_project_each
+ case "$SPREAD_SYSTEM" in
+ journalctl --rotate
+ sleep .1
+ journalctl --vacuum-time=1ms
Deleted archived journal /run/log/journal/ca6e64f3ce124855b482aff606f31054/system@1fd5442ac6564f2b98b58bee63aa3dce-0000000000002258-0005614e10330c1b.journal (1012.0K).
Vacuuming done, freed 1012.0K of archived journals on disk.
+ dmesg -c
+ fixup_dev_random
+ mv /dev/random /dev/random.orig
+ mknod /dev/random c 1 9
+ kill_gpg_agent
+ pkill -9 -e gpg-agent
+ true
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/reset.sh --reuse-core
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/dirs.sh
++ export SNAP_MOUNT_DIR=/snap
++ SNAP_MOUNT_DIR=/snap
++ export LIBEXECDIR=/usr/lib
++ LIBEXECDIR=/usr/lib
++ case "$SPREAD_SYSTEM" in
+ [[ ubuntu-core-16-arm-64 == ubuntu-core-16-* ]]
+ reset_all_snap --reuse-core
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/names.sh
+++ snap list
+++ sed -n 's/^\(pc\|pi[23]\|dragonboard\|cm3\) .*/\1/p'
error: cannot list snaps: cannot communicate with server: Get http://localhost/v2/snaps: dial unix /run/snapd.socket: connect: connection refused
++ gadget_name=
++ kernel_name=-kernel
++ '[' -kernel = pi3-kernel ']'
++ '[' -kernel = cm3-kernel ']'
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=README
+ case "$snap" in
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=bin
+ case "$snap" in
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=core
+ case "$snap" in
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=dragonboard
+ case "$snap" in
+ snap remove dragonboard
error: cannot communicate with server: Post http://localhost/v2/snaps/dragonboard: dial unix /run/snapd.socket: connect: connection refused
-----
.
2017-12-27 08:19:43 Debug output for external:ubuntu-core-16-arm-64:tests/main/interfaces-firewall-control : 
-----
+ '[' 1 = 1 ']'
+ echo '# journal messages for snapd'
# journal messages for snapd
+ journalctl -u snapd
-- No entries --
+ echo '# apparmor denials '
# apparmor denials 
+ dmesg --ctime
+ grep DENIED
+ true
+ echo '# seccomp denials (kills) '
# seccomp denials (kills) 
+ dmesg --ctime
+ grep type=1326
+ true
+ echo '# snap interfaces'
# snap interfaces
+ snap interfaces
error: cannot communicate with server: Get http://localhost/v2/interfaces: dial unix /run/snapd.socket: connect: connection refused
+ true
-----
.
2017-12-27 08:19:43 Restoring external:ubuntu-core-16-arm-64:tests/main/interfaces-firewall-control...
2017-12-27 08:19:44 Preparing external:ubuntu-core-16-arm-64:tests/main/install-store-laaaarge...
2017-12-27 08:19:50 Error preparing external:ubuntu-core-16-arm-64:tests/main/install-store-laaaarge : 
-----
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare-restore.sh --prepare-project-each
+ set -e
+ set -o pipefail
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/quiet.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/boot.sh
++ GRUB_EDITENV=grub-editenv
++ case "$SPREAD_SYSTEM" in
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/dirs.sh
++ export SNAP_MOUNT_DIR=/snap
++ SNAP_MOUNT_DIR=/snap
++ export LIBEXECDIR=/usr/lib
++ LIBEXECDIR=/usr/lib
++ case "$SPREAD_SYSTEM" in
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/quiet.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/random.sh
+ case "$1" in
+ prepare_project_each
+ case "$SPREAD_SYSTEM" in
+ journalctl --rotate
+ sleep .1
+ journalctl --vacuum-time=1ms
Deleted archived journal /run/log/journal/ca6e64f3ce124855b482aff606f31054/system@1fd5442ac6564f2b98b58bee63aa3dce-0000000000002262-0005614e10dd27c7.journal (1012.0K).
Vacuuming done, freed 1012.0K of archived journals on disk.
+ dmesg -c
+ fixup_dev_random
+ mv /dev/random /dev/random.orig
+ mknod /dev/random c 1 9
+ kill_gpg_agent
+ pkill -9 -e gpg-agent
+ true
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/reset.sh --reuse-core
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/dirs.sh
++ export SNAP_MOUNT_DIR=/snap
++ SNAP_MOUNT_DIR=/snap
++ export LIBEXECDIR=/usr/lib
++ LIBEXECDIR=/usr/lib
++ case "$SPREAD_SYSTEM" in
+ [[ ubuntu-core-16-arm-64 == ubuntu-core-16-* ]]
+ reset_all_snap --reuse-core
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/names.sh
+++ snap list
+++ sed -n 's/^\(pc\|pi[23]\|dragonboard\|cm3\) .*/\1/p'
error: cannot list snaps: cannot communicate with server: Get http://localhost/v2/snaps: dial unix /run/snapd.socket: connect: connection refused
++ gadget_name=
++ kernel_name=-kernel
++ '[' -kernel = pi3-kernel ']'
++ '[' -kernel = cm3-kernel ']'
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=README
+ case "$snap" in
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=bin
+ case "$snap" in
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=core
+ case "$snap" in
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=dragonboard
+ case "$snap" in
+ snap remove dragonboard
error: cannot communicate with server: Post http://localhost/v2/snaps/dragonboard: dial unix /run/snapd.socket: connect: connection refused
-----
.
2017-12-27 08:19:55 Debug output for external:ubuntu-core-16-arm-64:tests/main/install-store-laaaarge : 
-----
+ '[' 1 = 1 ']'
+ echo '# journal messages for snapd'
# journal messages for snapd
+ journalctl -u snapd
-- No entries --
+ echo '# apparmor denials '
# apparmor denials 
+ dmesg --ctime
+ grep DENIED
+ true
+ echo '# seccomp denials (kills) '
# seccomp denials (kills) 
+ dmesg --ctime
+ grep type=1326
+ true
+ echo '# snap interfaces'
# snap interfaces
+ snap interfaces
error: cannot communicate with server: Get http://localhost/v2/interfaces: dial unix /run/snapd.socket: connect: connection refused
+ true
-----
.
2017-12-27 08:19:55 Restoring external:ubuntu-core-16-arm-64:tests/main/install-store-laaaarge...
2017-12-27 08:19:58 Preparing external:ubuntu-core-16-arm-64:tests/main/security-device-cgroups-strict...
2017-12-27 08:21:43 Error preparing external:ubuntu-core-16-arm-64:tests/main/security-device-cgroups-strict : 
-----
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare-restore.sh --prepare-project-each
+ set -e
+ set -o pipefail
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/quiet.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/boot.sh
++ GRUB_EDITENV=grub-editenv
++ case "$SPREAD_SYSTEM" in
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/dirs.sh
++ export SNAP_MOUNT_DIR=/snap
++ SNAP_MOUNT_DIR=/snap
++ export LIBEXECDIR=/usr/lib
++ LIBEXECDIR=/usr/lib
++ case "$SPREAD_SYSTEM" in
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/quiet.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/random.sh
+ case "$1" in
+ prepare_project_each
+ case "$SPREAD_SYSTEM" in
+ journalctl --rotate
+ sleep .1
+ journalctl --vacuum-time=1ms
Deleted archived journal /run/log/journal/ca6e64f3ce124855b482aff606f31054/system@1fd5442ac6564f2b98b58bee63aa3dce-000000000000226d-0005614e1193496a.journal (1012.0K).
Vacuuming done, freed 1012.0K of archived journals on disk.
+ dmesg -c
+ fixup_dev_random
+ mv /dev/random /dev/random.orig
+ mknod /dev/random c 1 9
+ kill_gpg_agent
+ pkill -9 -e gpg-agent
+ true
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/reset.sh --reuse-core
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/dirs.sh
++ export SNAP_MOUNT_DIR=/snap
++ SNAP_MOUNT_DIR=/snap
++ export LIBEXECDIR=/usr/lib
++ LIBEXECDIR=/usr/lib
++ case "$SPREAD_SYSTEM" in
+ [[ ubuntu-core-16-arm-64 == ubuntu-core-16-* ]]
+ reset_all_snap --reuse-core
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/names.sh
+++ snap list
+++ sed -n 's/^\(pc\|pi[23]\|dragonboard\|cm3\) .*/\1/p'
++ gadget_name=dragonboard
++ kernel_name=dragonboard-kernel
++ '[' dragonboard-kernel = pi3-kernel ']'
++ '[' dragonboard-kernel = cm3-kernel ']'
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=README
+ case "$snap" in
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=bin
+ case "$snap" in
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=core
+ case "$snap" in
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=dragonboard
+ case "$snap" in
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=dragonboard-kernel
+ case "$snap" in
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=manifest.yaml
+ case "$snap" in
+ snap remove manifest.yaml
snap "manifest.yaml" is not installed
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=snapcraft.yaml
+ case "$snap" in
+ snap remove snapcraft.yaml
snap "snapcraft.yaml" is not installed
+ systemctl stop snapd.service snapd.socket
+ rm -rf /var/lib/snapd/apparmor /var/lib/snapd/assertions /var/lib/snapd/auto-import /var/lib/snapd/cache /var/lib/snapd/cookie /var/lib/snapd/desktop /var/lib/snapd/device /var/lib/snapd/environment /var/lib/snapd/firstboot /var/lib/snapd/hostfs /var/lib/snapd/lib /var/lib/snapd/mount /var/lib/snapd/seccomp /var/lib/snapd/seed /var/lib/snapd/snaps /var/lib/snapd/state.json /var/lib/snapd/state.json.bak /var/lib/snapd/void
+ tar -C/ -xf /home/gopath/src/github.com/snapcore/snapd/snapd-state.tar.gz
+ rm -rf /root/.snap
+ '[' --reuse-core '!=' --keep-stopped ']'
+ systemctl start snapd.service snapd.socket
+ '[' production = staging ']'
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare.sh
++ set -eux
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/dirs.sh
+++ export SNAP_MOUNT_DIR=/snap
+++ SNAP_MOUNT_DIR=/snap
+++ export LIBEXECDIR=/usr/lib
+++ LIBEXECDIR=/usr/lib
+++ case "$SPREAD_SYSTEM" in
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
+++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/quiet.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/boot.sh
+++ GRUB_EDITENV=grub-editenv
+++ case "$SPREAD_SYSTEM" in
+ [[ ubuntu-core-16-arm-64 != ubuntu-core-16-* ]]
+ '[' '!' -e /dev/fb0 ']'
+ echo 'Given a snap declaring a plug on framebuffer is installed in strict'
Given a snap declaring a plug on framebuffer is installed in strict
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
+ install_local test-strict-cgroup
+ local SNAP_NAME=test-strict-cgroup
+ shift
++ make_snap test-strict-cgroup
++ local SNAP_NAME=test-strict-cgroup
++ shift
++ local SNAP_FILE=/home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps/test-strict-cgroup/test-strict-cgroup_1.0_all.snap
++ local SNAP_DIR
+++ dirname /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps/test-strict-cgroup/test-strict-cgroup_1.0_all.snap
++ SNAP_DIR=/home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps/test-strict-cgroup
++ '[' '!' -f /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps/test-strict-cgroup/test-strict-cgroup_1.0_all.snap ']'
++ snap pack /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps/test-strict-cgroup /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps/test-strict-cgroup
error: cannot pack "/home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps/test-strict-cgroup": mkdir /tmp/snappy-build-439912480: read-only file system
++ echo /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps/test-strict-cgroup/test-strict-cgroup_1.0_all.snap
+ SNAP_FILE=/home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps/test-strict-cgroup/test-strict-cgroup_1.0_all.snap
+ snap install --dangerous /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps/test-strict-cgroup/test-strict-cgroup_1.0_all.snap
error: cannot open: "/home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps/test-strict-cgroup/test-strict-cgroup_1.0_all.snap"
-----
.
2017-12-27 08:21:43 Debug output for external:ubuntu-core-16-arm-64:tests/main/security-device-cgroups-strict : 
-----
+ '[' 1 = 1 ']'
+ echo '# journal messages for snapd'
# journal messages for snapd
+ journalctl -u snapd
-- Logs begin at Wed 2017-12-27 08:20:27 UTC, end at Wed 2017-12-27 08:22:12 UTC. --
Dec 27 08:20:28 localhost.localdomain snapd[29600]: 2017/12/27 08:20:28.618574 catalogrefresh.go:69: DEBUG: Catalog refresh starting now; next scheduled for 2017-12-28 08:20:28.618344 +0000 UTC.
Dec 27 08:20:28 localhost.localdomain snapd[29600]: 2017/12/27 08:20:28.620154 retry.go:40: DEBUG: Retrying https://api.snapcraft.io/api/v1/snaps/sections, attempt 1, elapsed time=109µs
Dec 27 08:20:28 localhost.localdomain snapd[29600]: 2017/12/27 08:20:28.649141 logger.go:69: DEBUG: > "GET /api/v1/snaps/sections HTTP/1.1\r\nHost: api.snapcraft.io\r\nUser-Agent: snapd/2.30+git476.f91a849~ubuntu16.04.1 (series 16; testing) ubuntu-core/16 (arm64) linux/4.4.0-1082-snapdragon\r\nAccept: application/hal+json\r\nX-Ubuntu-Architecture: arm64\r\nX-Ubuntu-Classic: false\r\nX-Ubuntu-No-Cdn: false\r\nX-Ubuntu-Series: 16\r\nX-Ubuntu-Wire-Protocol: 1\r\nAccept-Encoding: gzip\r\n\r\n"
Dec 27 08:20:28 localhost.localdomain snapd[29600]: 2017/12/27 08:20:28.650797 daemon.go:233: DEBUG: pid=29639;uid=0;@ GET /v2/snaps 715.842ms 200
Dec 27 08:20:28 localhost.localdomain snapd[29600]: 2017/12/27 08:20:28.806505 daemon.go:233: DEBUG: pid=29646;uid=0;@ POST /v2/snaps/manifest.yaml 1.231ms 400
Dec 27 08:20:28 localhost.localdomain snapd[29600]: 2017/12/27 08:20:28.873524 daemon.go:233: DEBUG: pid=29652;uid=0;@ POST /v2/snaps/snapcraft.yaml 898µs 400
Dec 27 08:20:28 localhost.localdomain systemd[1]: Stopping Snappy daemon...
Dec 27 08:20:28 localhost.localdomain snapd[29600]: 2017/12/27 08:20:28.894106 main.go:78: Exiting on terminated signal.
Dec 27 08:20:30 localhost.localdomain snapd[29600]: 2017/12/27 08:20:30.172481 logger.go:76: DEBUG: < "HTTP/1.1 200 OK\r\nContent-Length: 263\r\nAge: 3150\r\nCache-Control: public, max-age=3600\r\nContent-Type: application/hal+json\r\nDate: Wed, 27 Dec 2017 07:28:00 GMT\r\nServer: gunicorn/19.7.1\r\nVary: X-Ubuntu-Series\r\nVia: 1.1 juju-7794b8-prod-ols-snap-store-indep-397 (squid/3.5.23)\r\nX-Cache: HIT from juju-7794b8-prod-ols-snap-store-indep-397\r\nX-Cache-Lookup: HIT from juju-7794b8-prod-ols-snap-store-indep-397:3128\r\nX-Request-Id: 1993ffbd-fae9-4f18-8131-dbf80432fc29\r\nX-Vcs-Revision: efa4de8\r\n\r\n{\"_embedded\": {\"clickindex:sections\": [{\"name\": \"ops\"}, {\"name\": \"database\"}, {\"name\": \"internet-of-things\"}, {\"name\": \"featured\"}, {\"name\": \"messaging\"}, {\"name\": \"media\"}, {\"name\": \"editors\"}, {\"name\": \"devops\"}, {\"name\": \"cryptocurrency\"}, {\"name\": \"games\"}]}}"
Dec 27 08:20:30 localhost.localdomain snapd[29600]: 2017/12/27 08:20:30.173610 retry.go:52: DEBUG: The retry loop for https://api.snapcraft.io/api/v1/snaps/sections finished after 1 retries, elapsed time=1.553622s, status: 200
Dec 27 08:20:30 localhost.localdomain snapd[29600]: 2017/12/27 08:20:30.886429 retry.go:40: DEBUG: Retrying https://api.snapcraft.io/api/v1/snaps/names?confinement=strict, attempt 1, elapsed time=84µs
Dec 27 08:20:30 localhost.localdomain snapd[29600]: 2017/12/27 08:20:30.895103 logger.go:69: DEBUG: > "GET /api/v1/snaps/names?confinement=strict HTTP/1.1\r\nHost: api.snapcraft.io\r\nUser-Agent: snapd/2.30+git476.f91a849~ubuntu16.04.1 (series 16; testing) ubuntu-core/16 (arm64) linux/4.4.0-1082-snapdragon\r\nAccept: application/hal+json\r\nX-Ubuntu-Architecture: arm64\r\nX-Ubuntu-Classic: false\r\nX-Ubuntu-No-Cdn: false\r\nX-Ubuntu-Series: 16\r\nX-Ubuntu-Wire-Protocol: 1\r\nAccept-Encoding: gzip\r\n\r\n"
Dec 27 08:20:32 localhost.localdomain snapd[29600]: 2017/12/27 08:20:32.373059 logger.go:76: DEBUG: < "HTTP/1.1 200 OK\r\nContent-Length: 37861\r\nAge: 1456\r\nCache-Control: public, max-age=3600\r\nContent-Type: application/hal+json\r\nDate: Wed, 27 Dec 2017 07:56:18 GMT\r\nServer: gunicorn/19.7.1\r\nVary: X-Ubuntu-Store, X-Ubuntu-Series, X-Ubuntu-Architecture\r\nVia: 1.1 juju-7794b8-prod-ols-snap-store-indep-397 (squid/3.5.23)\r\nX-Cache: HIT from juju-7794b8-prod-ols-snap-store-indep-397\r\nX-Cache-Lookup: HIT from juju-7794b8-prod-ols-snap-store-indep-397:3128\r\nX-Request-Id: 79d12271-20d0-48d3-befc-9afc41a845bb\r\nX-Vcs-Revision: efa4de8\r\n\r\n"
Dec 27 08:20:32 localhost.localdomain snapd[29600]: 2017/12/27 08:20:32.958125 retry.go:52: DEBUG: The retry loop for https://api.snapcraft.io/api/v1/snaps/names?confinement=strict finished after 1 retries, elapsed time=2.071843s, status: 200
Dec 27 08:20:37 localhost.localdomain snapd[29600]: 2017/12/27 08:20:37.263592 taskrunner.go:370: DEBUG: Running task 109 on Do: Generate device key
Dec 27 08:20:38 localhost.localdomain systemd[1]: Stopped Snappy daemon.
Dec 27 08:22:09 localhost.localdomain systemd[1]: Starting Snappy daemon...
Dec 27 08:22:11 localhost.localdomain snapd[29669]: AppArmor status: apparmor is enabled and all features are available
Dec 27 08:22:11 localhost.localdomain snapd[29669]: 2017/12/27 08:22:11.814961 daemon.go:306: started snapd/2.30+git476.f91a849~ubuntu16.04.1 (series 16; testing) ubuntu-core/16 (arm64) linux/4.4.0-1082-snapdragon.
Dec 27 08:22:11 localhost.localdomain snapd[29669]: 2017/12/27 08:22:11.815663 main.go:72: DEBUG: activation done in 303ms
Dec 27 08:22:11 localhost.localdomain systemd[1]: Started Snappy daemon.
Dec 27 08:22:11 localhost.localdomain snapd[29669]: 2017/12/27 08:22:11.874605 catalogrefresh.go:69: DEBUG: Catalog refresh starting now; next scheduled for 2017-12-28 08:22:11.874519 +0000 UTC.
Dec 27 08:22:11 localhost.localdomain snapd[29669]: 2017/12/27 08:22:11.875129 retry.go:40: DEBUG: Retrying https://api.snapcraft.io/api/v1/snaps/sections, attempt 1, elapsed time=39µs
Dec 27 08:22:11 localhost.localdomain snapd[29669]: 2017/12/27 08:22:11.878203 logger.go:69: DEBUG: > "GET /api/v1/snaps/sections HTTP/1.1\r\nHost: api.snapcraft.io\r\nUser-Agent: snapd/2.30+git476.f91a849~ubuntu16.04.1 (series 16; testing) ubuntu-core/16 (arm64) linux/4.4.0-1082-snapdragon\r\nAccept: application/hal+json\r\nX-Ubuntu-Architecture: arm64\r\nX-Ubuntu-Classic: false\r\nX-Ubuntu-No-Cdn: false\r\nX-Ubuntu-Series: 16\r\nX-Ubuntu-Wire-Protocol: 1\r\nAccept-Encoding: gzip\r\n\r\n"
+ echo '# apparmor denials '
# apparmor denials 
+ dmesg --ctime
+ grep DENIED
+ true
+ echo '# seccomp denials (kills) '
# seccomp denials (kills) 
+ dmesg --ctime
+ grep type=1326
+ true
+ echo '# snap interfaces'
# snap interfaces
+ snap interfaces
Slot                      Plug
:account-control          -
:alsa                     -
:autopilot-introspection  -
:bluetooth-control        -
:broadcom-asic-control    -
:browser-support          -
:camera                   -
:classic-support          -
:core-support             core:core-support-plug
:dcdbas-control           -
:docker-support           -
:firewall-control         -
:framebuffer              -
:fuse-support             -
:gpg-keys                 -
:gpg-public-keys          -
:gpio-memory-control      -
:greengrass-support       -
:hardware-observe         -
:hardware-random-control  -
:hardware-random-observe  -
:home                     -
:io-ports-control         -
:joystick                 -
:kernel-module-control    -
:kubernetes-support       -
:kvm                      -
:log-observe              -
:lxd-support              -
:mount-observe            -
:netlink-audit            -
:netlink-connector        -
:network                  -
:network-bind             -
:network-control          -
:network-observe          -
:network-setup-control    -
:network-setup-observe    -
:opengl                   -
:openvswitch-support      -
:physical-memory-control  -
:physical-memory-observe  -
:ppp                      -
:process-control          -
:raw-usb                  -
:removable-media          -
:shutdown                 -
:snapd-control            -
:ssh-keys                 -
:ssh-public-keys          -
:system-observe           -
:system-trace             -
:time-control             -
:timeserver-control       -
:timezone-control         -
:tpm                      -
:uhid                     -
-----
.
2017-12-27 08:21:43 Restoring external:ubuntu-core-16-arm-64:tests/main/security-device-cgroups-strict...
2017-12-27 08:21:43 Preparing external:ubuntu-core-16-arm-64:tests/main/cmdline...
2017-12-27 08:23:57 Executing external:ubuntu-core-16-arm-64:tests/main/cmdline (63/162)...
2017-12-27 08:23:58 Restoring external:ubuntu-core-16-arm-64:tests/main/cmdline...
2017-12-27 08:23:58 Preparing external:ubuntu-core-16-arm-64:tests/main/snap-remove-not-mounted...
2017-12-27 08:27:36 Executing external:ubuntu-core-16-arm-64:tests/main/snap-remove-not-mounted (64/162)...
2017-12-27 08:27:36 Error executing external:ubuntu-core-16-arm-64:tests/main/snap-remove-not-mounted : 
-----
+ cp -ar /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps/test-snapd-tools /tmp
cp: cannot create directory '/tmp/test-snapd-tools': Read-only file system
-----
.
2017-12-27 08:27:48 Debug output for external:ubuntu-core-16-arm-64:tests/main/snap-remove-not-mounted : 
-----
+ '[' 1 = 1 ']'
+ echo '# journal messages for snapd'
# journal messages for snapd
+ journalctl -u snapd
-- Logs begin at Wed 2017-12-27 08:24:28 UTC, end at Wed 2017-12-27 08:28:06 UTC. --
Dec 27 08:24:28 localhost.localdomain snapd[29781]: 2017/12/27 08:24:28.556099 daemon.go:233: DEBUG: pid=29844;uid=0;@ GET /v2/snaps 10.457ms 200
Dec 27 08:24:28 localhost.localdomain snapd[29781]: 2017/12/27 08:24:28.619818 daemon.go:233: DEBUG: pid=29851;uid=0;@ POST /v2/snaps/manifest.yaml 1.107ms 400
Dec 27 08:24:28 localhost.localdomain snapd[29781]: 2017/12/27 08:24:28.679922 daemon.go:233: DEBUG: pid=29857;uid=0;@ POST /v2/snaps/snapcraft.yaml 772µs 400
Dec 27 08:24:28 localhost.localdomain systemd[1]: Stopping Snappy daemon...
Dec 27 08:24:28 localhost.localdomain snapd[29781]: 2017/12/27 08:24:28.697970 main.go:78: Exiting on terminated signal.
Dec 27 08:24:29 localhost.localdomain snapd[29781]: 2017/12/27 08:24:29.265006 logger.go:76: DEBUG: < "HTTP/1.1 200 OK\r\nContent-Length: 263\r\nAge: 3389\r\nCache-Control: public, max-age=3600\r\nContent-Type: application/hal+json\r\nDate: Wed, 27 Dec 2017 07:28:00 GMT\r\nServer: gunicorn/19.7.1\r\nVary: X-Ubuntu-Series\r\nVia: 1.1 juju-7794b8-prod-ols-snap-store-indep-397 (squid/3.5.23)\r\nX-Cache: HIT from juju-7794b8-prod-ols-snap-store-indep-397\r\nX-Cache-Lookup: HIT from juju-7794b8-prod-ols-snap-store-indep-397:3128\r\nX-Request-Id: 1993ffbd-fae9-4f18-8131-dbf80432fc29\r\nX-Vcs-Revision: efa4de8\r\n\r\n{\"_embedded\": {\"clickindex:sections\": [{\"name\": \"ops\"}, {\"name\": \"database\"}, {\"name\": \"internet-of-things\"}, {\"name\": \"featured\"}, {\"name\": \"messaging\"}, {\"name\": \"media\"}, {\"name\": \"editors\"}, {\"name\": \"devops\"}, {\"name\": \"cryptocurrency\"}, {\"name\": \"games\"}]}}"
Dec 27 08:24:29 localhost.localdomain snapd[29781]: 2017/12/27 08:24:29.265958 retry.go:52: DEBUG: The retry loop for https://api.snapcraft.io/api/v1/snaps/sections finished after 1 retries, elapsed time=1.267619s, status: 200
Dec 27 08:24:32 localhost.localdomain snapd[29781]: 2017/12/27 08:24:32.814515 retry.go:40: DEBUG: Retrying https://api.snapcraft.io/api/v1/snaps/names?confinement=strict, attempt 1, elapsed time=87µs
Dec 27 08:24:32 localhost.localdomain snapd[29781]: 2017/12/27 08:24:32.823100 logger.go:69: DEBUG: > "GET /api/v1/snaps/names?confinement=strict HTTP/1.1\r\nHost: api.snapcraft.io\r\nUser-Agent: snapd/2.30+git476.f91a849~ubuntu16.04.1 (series 16; testing) ubuntu-core/16 (arm64) linux/4.4.0-1082-snapdragon\r\nAccept: application/hal+json\r\nX-Ubuntu-Architecture: arm64\r\nX-Ubuntu-Classic: false\r\nX-Ubuntu-No-Cdn: false\r\nX-Ubuntu-Series: 16\r\nX-Ubuntu-Wire-Protocol: 1\r\nAccept-Encoding: gzip\r\n\r\n"
Dec 27 08:24:34 localhost.localdomain snapd[29781]: 2017/12/27 08:24:34.182660 logger.go:76: DEBUG: < "HTTP/1.1 200 OK\r\nContent-Length: 37861\r\nAge: 694\r\nCache-Control: public, max-age=3600\r\nContent-Type: application/hal+json\r\nDate: Wed, 27 Dec 2017 08:13:02 GMT\r\nServer: gunicorn/19.7.1\r\nVary: X-Ubuntu-Store, X-Ubuntu-Series, X-Ubuntu-Architecture\r\nVia: 1.1 juju-7794b8-prod-ols-snap-store-indep-398 (squid/3.5.12)\r\nX-Cache: HIT from juju-7794b8-prod-ols-snap-store-indep-398\r\nX-Cache-Lookup: HIT from juju-7794b8-prod-ols-snap-store-indep-398:3128\r\nX-Request-Id: 447f3c58-78ca-43cb-83d4-f94cdcb988c0\r\nX-Vcs-Revision: efa4de8\r\n\r\n"
Dec 27 08:24:34 localhost.localdomain snapd[29781]: 2017/12/27 08:24:34.584732 retry.go:52: DEBUG: The retry loop for https://api.snapcraft.io/api/v1/snaps/names?confinement=strict finished after 1 retries, elapsed time=1.770311s, status: 200
Dec 27 08:24:37 localhost.localdomain snapd[29781]: 2017/12/27 08:24:37.917508 taskrunner.go:370: DEBUG: Running task 109 on Do: Generate device key
Dec 27 08:24:39 localhost.localdomain systemd[1]: Stopped Snappy daemon.
Dec 27 08:28:03 localhost.localdomain systemd[1]: Starting Snappy daemon...
Dec 27 08:28:04 localhost.localdomain snapd[29878]: AppArmor status: apparmor is enabled and all features are available
Dec 27 08:28:05 localhost.localdomain snapd[29878]: 2017/12/27 08:28:05.658767 daemon.go:306: started snapd/2.30+git476.f91a849~ubuntu16.04.1 (series 16; testing) ubuntu-core/16 (arm64) linux/4.4.0-1082-snapdragon.
Dec 27 08:28:05 localhost.localdomain snapd[29878]: 2017/12/27 08:28:05.661583 main.go:72: DEBUG: activation done in 884ms
Dec 27 08:28:05 localhost.localdomain systemd[1]: Started Snappy daemon.
+ echo '# apparmor denials '
# apparmor denials 
+ dmesg --ctime
+ grep DENIED
+ true
+ echo '# seccomp denials (kills) '
# seccomp denials (kills) 
+ dmesg --ctime
+ grep type=1326
+ true
+ echo '# snap interfaces'
# snap interfaces
+ snap interfaces
Slot                      Plug
:account-control          -
:alsa                     -
:autopilot-introspection  -
:bluetooth-control        -
:broadcom-asic-control    -
:browser-support          -
:camera                   -
:classic-support          -
:core-support             core:core-support-plug
:dcdbas-control           -
:docker-support           -
:firewall-control         -
:framebuffer              -
:fuse-support             -
:gpg-keys                 -
:gpg-public-keys          -
:gpio-memory-control      -
:greengrass-support       -
:hardware-observe         -
:hardware-random-control  -
:hardware-random-observe  -
:home                     -
:io-ports-control         -
:joystick                 -
:kernel-module-control    -
:kubernetes-support       -
:kvm                      -
:log-observe              -
:lxd-support              -
:mount-observe            -
:netlink-audit            -
:netlink-connector        -
:network                  -
:network-bind             -
:network-control          -
:network-observe          -
:network-setup-control    -
:network-setup-observe    -
:opengl                   -
:openvswitch-support      -
:physical-memory-control  -
:physical-memory-observe  -
:ppp                      -
:process-control          -
:raw-usb                  -
:removable-media          -
:shutdown                 -
:snapd-control            -
:ssh-keys                 -
:ssh-public-keys          -
:system-observe           -
:system-trace             -
:time-control             -
:timeserver-control       -
:timezone-control         -
:tpm                      -
:uhid                     -
-----
.
2017-12-27 08:27:48 Restoring external:ubuntu-core-16-arm-64:tests/main/snap-remove-not-mounted...
2017-12-27 08:27:48 Preparing external:ubuntu-core-16-arm-64:tests/main/interfaces-process-control...
2017-12-27 08:29:47 Error preparing external:ubuntu-core-16-arm-64:tests/main/interfaces-process-control : 
-----
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare-restore.sh --prepare-project-each
+ set -e
+ set -o pipefail
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/quiet.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/boot.sh
++ GRUB_EDITENV=grub-editenv
++ case "$SPREAD_SYSTEM" in
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/dirs.sh
++ export SNAP_MOUNT_DIR=/snap
++ SNAP_MOUNT_DIR=/snap
++ export LIBEXECDIR=/usr/lib
++ LIBEXECDIR=/usr/lib
++ case "$SPREAD_SYSTEM" in
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/quiet.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/random.sh
+ case "$1" in
+ prepare_project_each
+ case "$SPREAD_SYSTEM" in
+ journalctl --rotate
+ sleep .1
+ journalctl --vacuum-time=1ms
Deleted archived journal /run/log/journal/ca6e64f3ce124855b482aff606f31054/system@1fd5442ac6564f2b98b58bee63aa3dce-00000000000022d0-0005614e20bc9c2a.journal (1012.0K).
Vacuuming done, freed 1012.0K of archived journals on disk.
+ dmesg -c
+ fixup_dev_random
+ mv /dev/random /dev/random.orig
+ mknod /dev/random c 1 9
+ kill_gpg_agent
+ pkill -9 -e gpg-agent
+ true
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/reset.sh --reuse-core
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/dirs.sh
++ export SNAP_MOUNT_DIR=/snap
++ SNAP_MOUNT_DIR=/snap
++ export LIBEXECDIR=/usr/lib
++ LIBEXECDIR=/usr/lib
++ case "$SPREAD_SYSTEM" in
+ [[ ubuntu-core-16-arm-64 == ubuntu-core-16-* ]]
+ reset_all_snap --reuse-core
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/names.sh
+++ snap list
+++ sed -n 's/^\(pc\|pi[23]\|dragonboard\|cm3\) .*/\1/p'
++ gadget_name=dragonboard
++ kernel_name=dragonboard-kernel
++ '[' dragonboard-kernel = pi3-kernel ']'
++ '[' dragonboard-kernel = cm3-kernel ']'
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=README
+ case "$snap" in
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=bin
+ case "$snap" in
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=core
+ case "$snap" in
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=dragonboard
+ case "$snap" in
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=dragonboard-kernel
+ case "$snap" in
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=manifest.yaml
+ case "$snap" in
+ snap remove manifest.yaml
snap "manifest.yaml" is not installed
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=snapcraft.yaml
+ case "$snap" in
+ snap remove snapcraft.yaml
snap "snapcraft.yaml" is not installed
+ systemctl stop snapd.service snapd.socket
+ rm -rf /var/lib/snapd/apparmor /var/lib/snapd/assertions /var/lib/snapd/auto-import /var/lib/snapd/cache /var/lib/snapd/cookie /var/lib/snapd/desktop /var/lib/snapd/device /var/lib/snapd/environment /var/lib/snapd/firstboot /var/lib/snapd/hostfs /var/lib/snapd/lib /var/lib/snapd/mount /var/lib/snapd/seccomp /var/lib/snapd/seed /var/lib/snapd/snaps /var/lib/snapd/state.json /var/lib/snapd/state.json.bak /var/lib/snapd/void
+ tar -C/ -xf /home/gopath/src/github.com/snapcore/snapd/snapd-state.tar.gz
+ rm -rf /root/.snap
+ '[' --reuse-core '!=' --keep-stopped ']'
+ systemctl start snapd.service snapd.socket
+ '[' production = staging ']'
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare.sh
++ set -eux
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/dirs.sh
+++ export SNAP_MOUNT_DIR=/snap
+++ SNAP_MOUNT_DIR=/snap
+++ export LIBEXECDIR=/usr/lib
+++ LIBEXECDIR=/usr/lib
+++ case "$SPREAD_SYSTEM" in
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
+++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/quiet.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/boot.sh
+++ GRUB_EDITENV=grub-editenv
+++ case "$SPREAD_SYSTEM" in
+ [[ ubuntu-core-16-arm-64 != ubuntu-core-16-* ]]
+ echo 'Given a snap declaring a plug on the process-control interface is installed'
Given a snap declaring a plug on the process-control interface is installed
+ snap pack /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps/process-control-consumer
error: cannot pack "/home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps/process-control-consumer": mkdir /tmp/snappy-build-235475922: read-only file system
-----
.
2017-12-27 08:29:48 Debug output for external:ubuntu-core-16-arm-64:tests/main/interfaces-process-control : 
-----
+ '[' 1 = 1 ']'
+ echo '# journal messages for snapd'
# journal messages for snapd
+ journalctl -u snapd
-- Logs begin at Wed 2017-12-27 08:28:18 UTC, end at Wed 2017-12-27 08:30:17 UTC. --
Dec 27 08:28:18 localhost.localdomain snapd[29878]: 2017/12/27 08:28:18.615880 daemon.go:233: DEBUG: pid=29950;uid=0;@ GET /v2/snaps 11.344ms 200
Dec 27 08:28:18 localhost.localdomain snapd[29878]: 2017/12/27 08:28:18.717426 daemon.go:233: DEBUG: pid=29957;uid=0;@ POST /v2/snaps/manifest.yaml 1.819ms 400
Dec 27 08:28:18 localhost.localdomain snapd[29878]: 2017/12/27 08:28:18.809641 daemon.go:233: DEBUG: pid=29963;uid=0;@ POST /v2/snaps/snapcraft.yaml 1.314ms 400
Dec 27 08:28:18 localhost.localdomain systemd[1]: Stopping Snappy daemon...
Dec 27 08:28:18 localhost.localdomain snapd[29878]: 2017/12/27 08:28:18.836136 main.go:78: Exiting on terminated signal.
Dec 27 08:28:19 localhost.localdomain snapd[29878]: 2017/12/27 08:28:19.039955 logger.go:76: DEBUG: < "HTTP/1.1 200 OK\r\nContent-Length: 263\r\nAge: 18\r\nCache-Control: public, max-age=3600\r\nContent-Type: application/hal+json\r\nDate: Wed, 27 Dec 2017 08:28:00 GMT\r\nServer: gunicorn/19.7.1\r\nVary: X-Ubuntu-Series\r\nVia: 1.1 juju-7794b8-prod-ols-snap-store-indep-397 (squid/3.5.23)\r\nX-Cache: HIT from juju-7794b8-prod-ols-snap-store-indep-397\r\nX-Cache-Lookup: HIT from juju-7794b8-prod-ols-snap-store-indep-397:3128\r\nX-Request-Id: 53fcd713-70a7-4a14-9b5e-e56b2715a93a\r\nX-Vcs-Revision: efa4de8\r\n\r\n{\"_embedded\": {\"clickindex:sections\": [{\"name\": \"ops\"}, {\"name\": \"database\"}, {\"name\": \"internet-of-things\"}, {\"name\": \"featured\"}, {\"name\": \"messaging\"}, {\"name\": \"media\"}, {\"name\": \"editors\"}, {\"name\": \"devops\"}, {\"name\": \"cryptocurrency\"}, {\"name\": \"games\"}]}}"
Dec 27 08:28:19 localhost.localdomain snapd[29878]: 2017/12/27 08:28:19.040773 retry.go:52: DEBUG: The retry loop for https://api.snapcraft.io/api/v1/snaps/sections finished after 1 retries, elapsed time=1.357462s, status: 200
Dec 27 08:28:19 localhost.localdomain snapd[29878]: 2017/12/27 08:28:19.649591 retry.go:40: DEBUG: Retrying https://api.snapcraft.io/api/v1/snaps/names?confinement=strict, attempt 1, elapsed time=82µs
Dec 27 08:28:19 localhost.localdomain snapd[29878]: 2017/12/27 08:28:19.658148 logger.go:69: DEBUG: > "GET /api/v1/snaps/names?confinement=strict HTTP/1.1\r\nHost: api.snapcraft.io\r\nUser-Agent: snapd/2.30+git476.f91a849~ubuntu16.04.1 (series 16; testing) ubuntu-core/16 (arm64) linux/4.4.0-1082-snapdragon\r\nAccept: application/hal+json\r\nX-Ubuntu-Architecture: arm64\r\nX-Ubuntu-Classic: false\r\nX-Ubuntu-No-Cdn: false\r\nX-Ubuntu-Series: 16\r\nX-Ubuntu-Wire-Protocol: 1\r\nAccept-Encoding: gzip\r\n\r\n"
Dec 27 08:28:20 localhost.localdomain snapd[29878]: 2017/12/27 08:28:20.977578 logger.go:76: DEBUG: < "HTTP/1.1 200 OK\r\nContent-Length: 37861\r\nAge: 1924\r\nCache-Control: public, max-age=3600\r\nContent-Type: application/hal+json\r\nDate: Wed, 27 Dec 2017 07:56:18 GMT\r\nServer: gunicorn/19.7.1\r\nVary: X-Ubuntu-Store, X-Ubuntu-Series, X-Ubuntu-Architecture\r\nVia: 1.1 juju-7794b8-prod-ols-snap-store-indep-397 (squid/3.5.23)\r\nX-Cache: HIT from juju-7794b8-prod-ols-snap-store-indep-397\r\nX-Cache-Lookup: HIT from juju-7794b8-prod-ols-snap-store-indep-397:3128\r\nX-Request-Id: 79d12271-20d0-48d3-befc-9afc41a845bb\r\nX-Vcs-Revision: efa4de8\r\n\r\n"
Dec 27 08:28:21 localhost.localdomain snapd[29878]: 2017/12/27 08:28:21.331110 retry.go:52: DEBUG: The retry loop for https://api.snapcraft.io/api/v1/snaps/names?confinement=strict finished after 1 retries, elapsed time=1.681608s, status: 200
Dec 27 08:28:24 localhost.localdomain snapd[29878]: 2017/12/27 08:28:24.081699 taskrunner.go:370: DEBUG: Running task 109 on Do: Generate device key
Dec 27 08:28:25 localhost.localdomain systemd[1]: Stopped Snappy daemon.
Dec 27 08:30:14 localhost.localdomain systemd[1]: Starting Snappy daemon...
Dec 27 08:30:16 localhost.localdomain snapd[29980]: AppArmor status: apparmor is enabled and all features are available
Dec 27 08:30:16 localhost.localdomain snapd[29980]: 2017/12/27 08:30:16.348164 daemon.go:306: started snapd/2.30+git476.f91a849~ubuntu16.04.1 (series 16; testing) ubuntu-core/16 (arm64) linux/4.4.0-1082-snapdragon.
Dec 27 08:30:16 localhost.localdomain snapd[29980]: 2017/12/27 08:30:16.348946 main.go:72: DEBUG: activation done in 314ms
Dec 27 08:30:16 localhost.localdomain systemd[1]: Started Snappy daemon.
Dec 27 08:30:16 localhost.localdomain snapd[29980]: 2017/12/27 08:30:16.406257 catalogrefresh.go:69: DEBUG: Catalog refresh starting now; next scheduled for 2017-12-28 08:30:16.40618 +0000 UTC.
Dec 27 08:30:16 localhost.localdomain snapd[29980]: 2017/12/27 08:30:16.406786 retry.go:40: DEBUG: Retrying https://api.snapcraft.io/api/v1/snaps/sections, attempt 1, elapsed time=44µs
Dec 27 08:30:16 localhost.localdomain snapd[29980]: 2017/12/27 08:30:16.409621 logger.go:69: DEBUG: > "GET /api/v1/snaps/sections HTTP/1.1\r\nHost: api.snapcraft.io\r\nUser-Agent: snapd/2.30+git476.f91a849~ubuntu16.04.1 (series 16; testing) ubuntu-core/16 (arm64) linux/4.4.0-1082-snapdragon\r\nAccept: application/hal+json\r\nX-Ubuntu-Architecture: arm64\r\nX-Ubuntu-Classic: false\r\nX-Ubuntu-No-Cdn: false\r\nX-Ubuntu-Series: 16\r\nX-Ubuntu-Wire-Protocol: 1\r\nAccept-Encoding: gzip\r\n\r\n"
+ echo '# apparmor denials '
# apparmor denials 
+ dmesg --ctime
+ grep DENIED
+ true
+ echo '# seccomp denials (kills) '
# seccomp denials (kills) 
+ dmesg --ctime
+ grep type=1326
+ true
+ echo '# snap interfaces'
# snap interfaces
+ snap interfaces
Slot                      Plug
:account-control          -
:alsa                     -
:autopilot-introspection  -
:bluetooth-control        -
:broadcom-asic-control    -
:browser-support          -
:camera                   -
:classic-support          -
:core-support             core:core-support-plug
:dcdbas-control           -
:docker-support           -
:firewall-control         -
:framebuffer              -
:fuse-support             -
:gpg-keys                 -
:gpg-public-keys          -
:gpio-memory-control      -
:greengrass-support       -
:hardware-observe         -
:hardware-random-control  -
:hardware-random-observe  -
:home                     -
:io-ports-control         -
:joystick                 -
:kernel-module-control    -
:kubernetes-support       -
:kvm                      -
:log-observe              -
:lxd-support              -
:mount-observe            -
:netlink-audit            -
:netlink-connector        -
:network                  -
:network-bind             -
:network-control          -
:network-observe          -
:network-setup-control    -
:network-setup-observe    -
:opengl                   -
:openvswitch-support      -
:physical-memory-control  -
:physical-memory-observe  -
:ppp                      -
:process-control          -
:raw-usb                  -
:removable-media          -
:shutdown                 -
:snapd-control            -
:ssh-keys                 -
:ssh-public-keys          -
:system-observe           -
:system-trace             -
:time-control             -
:timeserver-control       -
:timezone-control         -
:tpm                      -
:uhid                     -
-----
.
2017-12-27 08:29:48 Restoring external:ubuntu-core-16-arm-64:tests/main/interfaces-process-control...
2017-12-27 08:29:48 Preparing external:ubuntu-core-16-arm-64:tests/main/snap-info...
2017-12-27 08:31:15 Error preparing external:ubuntu-core-16-arm-64:tests/main/snap-info : 
-----
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare-restore.sh --prepare-project-each
+ set -e
+ set -o pipefail
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/quiet.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/boot.sh
++ GRUB_EDITENV=grub-editenv
++ case "$SPREAD_SYSTEM" in
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/dirs.sh
++ export SNAP_MOUNT_DIR=/snap
++ SNAP_MOUNT_DIR=/snap
++ export LIBEXECDIR=/usr/lib
++ LIBEXECDIR=/usr/lib
++ case "$SPREAD_SYSTEM" in
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/quiet.sh
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/random.sh
+ case "$1" in
+ prepare_project_each
+ case "$SPREAD_SYSTEM" in
+ journalctl --rotate
+ sleep .1
+ journalctl --vacuum-time=1ms
Deleted archived journal /run/log/journal/ca6e64f3ce124855b482aff606f31054/system@1fd5442ac6564f2b98b58bee63aa3dce-00000000000022f9-0005614e2e73dd9f.journal (1012.0K).
Vacuuming done, freed 1012.0K of archived journals on disk.
+ dmesg -c
+ fixup_dev_random
+ mv /dev/random /dev/random.orig
+ mknod /dev/random c 1 9
+ kill_gpg_agent
+ pkill -9 -e gpg-agent
+ true
+ /home/gopath/src/github.com/snapcore/snapd/tests/lib/reset.sh --reuse-core
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/dirs.sh
++ export SNAP_MOUNT_DIR=/snap
++ SNAP_MOUNT_DIR=/snap
++ export LIBEXECDIR=/usr/lib
++ LIBEXECDIR=/usr/lib
++ case "$SPREAD_SYSTEM" in
+ [[ ubuntu-core-16-arm-64 == ubuntu-core-16-* ]]
+ reset_all_snap --reuse-core
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/names.sh
+++ snap list
+++ sed -n 's/^\(pc\|pi[23]\|dragonboard\|cm3\) .*/\1/p'
++ gadget_name=dragonboard
++ kernel_name=dragonboard-kernel
++ '[' dragonboard-kernel = pi3-kernel ']'
++ '[' dragonboard-kernel = cm3-kernel ']'
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=README
+ case "$snap" in
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=bin
+ case "$snap" in
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=core
+ case "$snap" in
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=dragonboard
+ case "$snap" in
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=dragonboard-kernel
+ case "$snap" in
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=manifest.yaml
+ case "$snap" in
+ snap remove manifest.yaml
snap "manifest.yaml" is not installed
+ for snap in '"$SNAP_MOUNT_DIR"/*'
+ snap=snapcraft.yaml
+ case "$snap" in
+ snap remove snapcraft.yaml
snap "snapcraft.yaml" is not installed
+ systemctl stop snapd.service snapd.socket
+ rm -rf /var/lib/snapd/apparmor /var/lib/snapd/assertions /var/lib/snapd/auto-import /var/lib/snapd/cache /var/lib/snapd/cookie /var/lib/snapd/desktop /var/lib/snapd/device /var/lib/snapd/environment /var/lib/snapd/firstboot /var/lib/snapd/hostfs /var/lib/snapd/lib /var/lib/snapd/mount /var/lib/snapd/seccomp /var/lib/snapd/seed /var/lib/snapd/snaps /var/lib/snapd/state.json /var/lib/snapd/state.json.bak /var/lib/snapd/void
+ tar -C/ -xf /home/gopath/src/github.com/snapcore/snapd/snapd-state.tar.gz
+ rm -rf /root/.snap
+ '[' --reuse-core '!=' --keep-stopped ']'
+ systemctl start snapd.service snapd.socket
+ '[' production = staging ']'
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/prepare.sh
++ set -eux
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/dirs.sh
+++ export SNAP_MOUNT_DIR=/snap
+++ SNAP_MOUNT_DIR=/snap
+++ export LIBEXECDIR=/usr/lib
+++ LIBEXECDIR=/usr/lib
+++ case "$SPREAD_SYSTEM" in
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
+++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/quiet.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/boot.sh
+++ GRUB_EDITENV=grub-editenv
+++ case "$SPREAD_SYSTEM" in
+ [[ ubuntu-core-16-arm-64 != ubuntu-core-16-* ]]
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/quiet.sh
+ distro_install_package python3-yaml
+ APT_FLAGS=
+ DNF_FLAGS=
+ ZYPPER_FLAGS=
+ '[' -n python3-yaml ']'
+ case "$1" in
+ break
+ case "$SPREAD_SYSTEM" in
+ [[ python3-yaml =~ libudev-dev ]]
+ case "$SPREAD_SYSTEM" in
+ for pkg in '"$@"'
++ distro_name_package python3-yaml
++ case "$SPREAD_SYSTEM" in
++ debian_name_package python3-yaml
++ case "$1" in
++ echo python3-yaml
+ package_name=python3-yaml
+ '[' -z python3-yaml ']'
+ case "$SPREAD_SYSTEM" in
+ quiet apt-get install -y python3-yaml
mktemp: failed to create file via template ‘/tmp/tmp.XXXXXXXXXX’: Read-only file system
-----
.
2017-12-27 08:31:16 Debug output for external:ubuntu-core-16-arm-64:tests/main/snap-info : 
-----
+ '[' 1 = 1 ']'
+ echo '# journal messages for snapd'
# journal messages for snapd
+ journalctl -u snapd
-- Logs begin at Wed 2017-12-27 08:30:17 UTC, end at Wed 2017-12-27 08:31:44 UTC. --
Dec 27 08:30:17 localhost.localdomain snapd[29980]: 2017/12/27 08:30:17.731622 logger.go:76: DEBUG: < "HTTP/1.1 200 OK\r\nContent-Length: 263\r\nAge: 1097\r\nCache-Control: public, max-age=3600\r\nContent-Type: application/hal+json\r\nDate: Wed, 27 Dec 2017 08:12:00 GMT\r\nServer: gunicorn/19.7.1\r\nVary: X-Ubuntu-Series\r\nVia: 1.1 juju-7794b8-prod-ols-snap-store-indep-398 (squid/3.5.12)\r\nX-Cache: HIT from juju-7794b8-prod-ols-snap-store-indep-398\r\nX-Cache-Lookup: HIT from juju-7794b8-prod-ols-snap-store-indep-398:3128\r\nX-Request-Id: 6ad4e717-05c9-4e46-8510-d45bf4aba686\r\nX-Vcs-Revision: efa4de8\r\n\r\n{\"_embedded\": {\"clickindex:sections\": [{\"name\": \"ops\"}, {\"name\": \"database\"}, {\"name\": \"internet-of-things\"}, {\"name\": \"featured\"}, {\"name\": \"messaging\"}, {\"name\": \"media\"}, {\"name\": \"editors\"}, {\"name\": \"devops\"}, {\"name\": \"cryptocurrency\"}, {\"name\": \"games\"}]}}"
Dec 27 08:30:17 localhost.localdomain snapd[29980]: 2017/12/27 08:30:17.732286 retry.go:52: DEBUG: The retry loop for https://api.snapcraft.io/api/v1/snaps/sections finished after 1 retries, elapsed time=1.325538s, status: 200
Dec 27 08:30:17 localhost.localdomain snapd[29980]: 2017/12/27 08:30:17.931121 daemon.go:233: DEBUG: pid=30051;uid=0;@ GET /v2/snaps 11.677ms 200
Dec 27 08:30:18 localhost.localdomain snapd[29980]: 2017/12/27 08:30:18.032101 daemon.go:233: DEBUG: pid=30058;uid=0;@ POST /v2/snaps/manifest.yaml 1.771ms 400
Dec 27 08:30:18 localhost.localdomain snapd[29980]: 2017/12/27 08:30:18.124582 daemon.go:233: DEBUG: pid=30064;uid=0;@ POST /v2/snaps/snapcraft.yaml 1.19ms 400
Dec 27 08:30:18 localhost.localdomain systemd[1]: Stopping Snappy daemon...
Dec 27 08:30:18 localhost.localdomain snapd[29980]: 2017/12/27 08:30:18.153077 main.go:78: Exiting on terminated signal.
Dec 27 08:30:24 localhost.localdomain snapd[29980]: 2017/12/27 08:30:24.483199 retry.go:40: DEBUG: Retrying https://api.snapcraft.io/api/v1/snaps/names?confinement=strict, attempt 1, elapsed time=85µs
Dec 27 08:30:24 localhost.localdomain snapd[29980]: 2017/12/27 08:30:24.492010 logger.go:69: DEBUG: > "GET /api/v1/snaps/names?confinement=strict HTTP/1.1\r\nHost: api.snapcraft.io\r\nUser-Agent: snapd/2.30+git476.f91a849~ubuntu16.04.1 (series 16; testing) ubuntu-core/16 (arm64) linux/4.4.0-1082-snapdragon\r\nAccept: application/hal+json\r\nX-Ubuntu-Architecture: arm64\r\nX-Ubuntu-Classic: false\r\nX-Ubuntu-No-Cdn: false\r\nX-Ubuntu-Series: 16\r\nX-Ubuntu-Wire-Protocol: 1\r\nAccept-Encoding: gzip\r\n\r\n"
Dec 27 08:30:25 localhost.localdomain snapd[29980]: 2017/12/27 08:30:25.873253 logger.go:76: DEBUG: < "HTTP/1.1 200 OK\r\nContent-Length: 37861\r\nAge: 2049\r\nCache-Control: public, max-age=3600\r\nContent-Type: application/hal+json\r\nDate: Wed, 27 Dec 2017 07:56:18 GMT\r\nServer: gunicorn/19.7.1\r\nVary: X-Ubuntu-Store, X-Ubuntu-Series, X-Ubuntu-Architecture\r\nVia: 1.1 juju-7794b8-prod-ols-snap-store-indep-397 (squid/3.5.23)\r\nX-Cache: HIT from juju-7794b8-prod-ols-snap-store-indep-397\r\nX-Cache-Lookup: HIT from juju-7794b8-prod-ols-snap-store-indep-397:3128\r\nX-Request-Id: 79d12271-20d0-48d3-befc-9afc41a845bb\r\nX-Vcs-Revision: efa4de8\r\n\r\n"
Dec 27 08:30:26 localhost.localdomain snapd[29980]: 2017/12/27 08:30:26.167306 retry.go:52: DEBUG: The retry loop for https://api.snapcraft.io/api/v1/snaps/names?confinement=strict finished after 1 retries, elapsed time=1.684264s, status: 200
Dec 27 08:30:26 localhost.localdomain snapd[29980]: 2017/12/27 08:30:26.438336 taskrunner.go:370: DEBUG: Running task 109 on Do: Generate device key
Dec 27 08:30:26 localhost.localdomain systemd[1]: Stopped Snappy daemon.
Dec 27 08:31:42 localhost.localdomain systemd[1]: Starting Snappy daemon...
Dec 27 08:31:44 localhost.localdomain snapd[30080]: AppArmor status: apparmor is enabled and all features are available
Dec 27 08:31:44 localhost.localdomain snapd[30080]: 2017/12/27 08:31:44.488366 daemon.go:306: started snapd/2.30+git476.f91a849~ubuntu16.04.1 (series 16; testing) ubuntu-core/16 (arm64) linux/4.4.0-1082-snapdragon.
Dec 27 08:31:44 localhost.localdomain snapd[30080]: 2017/12/27 08:31:44.489095 main.go:72: DEBUG: activation done in 310ms
Dec 27 08:31:44 localhost.localdomain systemd[1]: Started Snappy daemon.
Dec 27 08:31:44 localhost.localdomain snapd[30080]: 2017/12/27 08:31:44.544864 catalogrefresh.go:69: DEBUG: Catalog refresh starting now; next scheduled for 2017-12-28 08:31:44.544778 +0000 UTC.
Dec 27 08:31:44 localhost.localdomain snapd[30080]: 2017/12/27 08:31:44.545406 retry.go:40: DEBUG: Retrying https://api.snapcraft.io/api/v1/snaps/sections, attempt 1, elapsed time=45µs
Dec 27 08:31:44 localhost.localdomain snapd[30080]: 2017/12/27 08:31:44.548182 logger.go:69: DEBUG: > "GET /api/v1/snaps/sections HTTP/1.1\r\nHost: api.snapcraft.io\r\nUser-Agent: snapd/2.30+git476.f91a849~ubuntu16.04.1 (series 16; testing) ubuntu-core/16 (arm64) linux/4.4.0-1082-snapdragon\r\nAccept: application/hal+json\r\nX-Ubuntu-Architecture: arm64\r\nX-Ubuntu-Classic: false\r\nX-Ubuntu-No-Cdn: false\r\nX-Ubuntu-Series: 16\r\nX-Ubuntu-Wire-Protocol: 1\r\nAccept-Encoding: gzip\r\n\r\n"
+ echo '# apparmor denials '
# apparmor denials 
+ dmesg --ctime
+ grep DENIED
+ true
+ echo '# seccomp denials (kills) '
# seccomp denials (kills) 
+ dmesg --ctime
+ grep type=1326
+ true
+ echo '# snap interfaces'
# snap interfaces
+ snap interfaces
Slot                      Plug
:account-control          -
:alsa                     -
:autopilot-introspection  -
:bluetooth-control        -
:broadcom-asic-control    -
:browser-support          -
:camera                   -
:classic-support          -
:core-support             core:core-support-plug
:dcdbas-control           -
:docker-support           -
:firewall-control         -
:framebuffer              -
:fuse-support             -
:gpg-keys                 -
:gpg-public-keys          -
:gpio-memory-control      -
:greengrass-support       -
:hardware-observe         -
:hardware-random-control  -
:hardware-random-observe  -
:home                     -
:io-ports-control         -
:joystick                 -
:kernel-module-control    -
:kubernetes-support       -
:kvm                      -
:log-observe              -
:lxd-support              -
:mount-observe            -
:netlink-audit            -
:netlink-connector        -
:network                  -
:network-bind             -
:network-control          -
:network-observe          -
:network-setup-control    -
:network-setup-observe    -
:opengl                   -
:openvswitch-support      -
:physical-memory-control  -
:physical-memory-observe  -
:ppp                      -
:process-control          -
:raw-usb                  -
:removable-media          -
:shutdown                 -
:snapd-control            -
:ssh-keys                 -
:ssh-public-keys          -
:system-observe           -
:system-trace             -
:time-control             -
:timeserver-control       -
:timezone-control         -
:tpm                      -
:uhid                     -
-----
.
2017-12-27 08:31:16 Restoring external:ubuntu-core-16-arm-64:tests/main/snap-info...
2017-12-27 08:31:16 Error restoring external:ubuntu-core-16-arm-64:tests/main/snap-info : 
-----
+ rm -f basic_1.0_all.snap
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/pkgdb.sh
++ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/quiet.sh
+ distro_purge_package python3-yaml
+ for pkg in '"$@"'
++ distro_name_package python3-yaml
++ case "$SPREAD_SYSTEM" in
++ debian_name_package python3-yaml
++ case "$1" in
++ echo python3-yaml
+ package_name=python3-yaml
+ '[' -z python3-yaml ']'
+ case "$SPREAD_SYSTEM" in
+ quiet apt-get remove -y --purge -y python3-yaml
mktemp: failed to create file via template ‘/tmp/tmp.XXXXXXXXXX’: Read-only file system
-----
.
2017-12-27 08:31:16 Restoring external:ubuntu-core-16-arm-64:tests/main/...
2017-12-27 08:35:04 Restoring project on external:ubuntu-core-16-arm-64...

2017-12-27 08:35:10 Discarding external:ubuntu-core-16-arm-64...
2017-12-27 08:35:10 Successful tasks: 54
2017-12-27 08:35:10 Aborted tasks: 107
2017-12-27 08:35:10 Failed tasks: 1
    - external:ubuntu-core-16-arm-64:tests/main/snap-remove-not-mounted
2017-12-27 08:35:10 Failed task prepare: 11
    - external:ubuntu-core-16-arm-64:tests/main/help:abort
    - external:ubuntu-core-16-arm-64:tests/main/install-store-laaaarge
    - external:ubuntu-core-16-arm-64:tests/main/interfaces-firewall-control
    - external:ubuntu-core-16-arm-64:tests/main/interfaces-process-control
    - external:ubuntu-core-16-arm-64:tests/main/refresh:classic_remote
    - external:ubuntu-core-16-arm-64:tests/main/security-apparmor
    - external:ubuntu-core-16-arm-64:tests/main/security-device-cgroups-strict
    - external:ubuntu-core-16-arm-64:tests/main/snap-info
    - external:ubuntu-core-16-arm-64:tests/main/snapctl-services
    - external:ubuntu-core-16-arm-64:tests/main/ubuntu-core-fan
    - external:ubuntu-core-16-arm-64:tests/main/ubuntu-core-os-release
2017-12-27 08:35:10 Failed task restore: 1
    - external:ubuntu-core-16-arm-64:tests/main/snap-info
error: unsuccessful run
2017-12-27 08:35:10,529 dragonboard_004 WARNING: Tests failed, rc=1
2017-12-27 08:35:10,530 dragonboard_004 INFO: END testrun
complete
