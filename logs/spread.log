Running tests on a test flinger device
Loading environment variables
Using environment file: tf_snapd_cm3_refresh
Deleting test flinger data
Creating job for snapd using a device
Running testflinger client
Submitting job to testflinger
JOB_ID: cd0257c3-996f-494c-afb5-9901cce299d2
Print job: /var/snap/testflinger-cli/current/job.yaml 
job_queue: cm3
global_timeout: 36000
provision_data:
    url: http://cdimage.ubuntu.com/ubuntu-core/16/stable/current/ubuntu-core-16-cm3.img.xz
test_data:
    test_cmds: |
        #!/bin/bash
        sudo apt update || ps aux | grep apt
        sudo apt install -y git curl sshpass
        git clone https://github.com/sergiocazzolato/snappy-qa-jobs.git
        (cd snappy-qa-jobs && git checkout master)
        git clone https://git.launchpad.net/snapd-vendor snapd
        (cd snapd && git checkout master)
        . snapd/tests/lib/external/prepare-ssh.sh "{device_ip}" "22" "ubuntu"
        . snappy-qa-jobs/scripts/utils/register_device.sh "{device_ip}" "22" "test" "ubuntu" "sergiocazzolato@yahoo.com.ar"
        . snappy-qa-jobs/scripts/utils/refresh_core.sh "{device_ip}" "22" "test" "ubuntu" "stable" "edge"
        . snappy-qa-jobs/scripts/utils/run_setup.sh "{device_ip}" "22" "test" "ubuntu" ""
        . snappy-qa-jobs/scripts/utils/get_spread.sh
        . snappy-qa-jobs/scripts/utils/run_spread.sh "{device_ip}" "22" "snapd" "external:ubuntu-core-16-arm-32:tests/" "" "tests/main/auto-refresh,tests/main/interfaces-content" "-v"
Showing job data
This job is currently waiting on a node to become available. You will see no further output until the job starts running.
***********************************

* Starting setup phase on cm3-002 *

***********************************

Cleaning up container if it exists...
Error response from daemon: No such container: cm3002

***************************************

* Starting provision phase on cm3-002 *

***************************************
Install python-logstash if you want to use logstash logging
2018-05-24 10:11:20,317 cm3-001 INFO: BEGIN provision
2018-05-24 10:11:20,317 cm3-001 INFO: Provisioning device
2018-05-24 10:11:27,309 cm3-001 INFO: Running snmpset -c private -v1 10.101.48.8 .1.3.6.1.4.1.318.1.1.12.3.3.1.1.4.2 i 2
iso.3.6.1.4.1.318.1.1.12.3.3.1.1.4.2 = INTEGER: 2
2018-05-24 10:11:27,428 cm3-001 INFO: Running sleep 10
2018-05-24 10:11:37,447 cm3-001 INFO: Running snmpset -c private -v1 10.101.48.8 .1.3.6.1.4.1.318.1.1.12.3.3.1.1.4.2 i 1
iso.3.6.1.4.1.318.1.1.12.3.3.1.1.4.2 = INTEGER: 1
2018-05-24 10:11:37,565 cm3-001 INFO: Flashing image
2018-05-24 10:16:18,910 cm3-001 INFO: b"Warning: Permanently added '10.101.50.182' (ECDSA) to the list of known hosts.\r\ntesting...\n+ echo testing...\n+ /snap/cm3-installer/6/bin/rpiboot -d /snap/cm3-installer/6/msd\nWaiting for BCM2835/6/7\nSending bootcode.bin\nSuccessful read 4 bytes \nWaiting for BCM2835/6/7\nSecond stage boot server\nFile read: start.elf\nSecond stage boot server done\nstarting image download...\n+ echo 'starting image download...'\n+ curl -L http://cdimage.ubuntu.com/ubuntu-core/16/stable/current/ubuntu-core-16-cm3.img.xz\n+ unxz -c\n+ dd of=/dev/sda bs=4M oflag=sync\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n\r  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\r  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0\r  0  334M    0  101k    0     0  65668      0  1:28:57  0:00:01  1:28:56 65662\r  0  334M    0  626k    0     0   252k      0  0:22:35  0:00:02  0:22:33  252k\r  0  334M    0 2709k    0     0   797k      0  0:07:09  0:00:03  0:07:06  797k\r  1  334M    1 4403k    0     0  1000k      0  0:05:42  0:00:04  0:05:38 1000k\r  1  334M    1 6483k    0     0  1201k      0  0:04:44  0:00:05  0:04:39 1311k\r  2  334M    2 8390k    0     0  1311k      0  0:04:20  0:00:06  0:04:14 1721k\r  2  334M    2 9961k    0     0  1346k      0  0:04:14  0:00:07  0:04:07 1898k\r  3  334M    3 11.1M    0     0  1363k      0  0:04:11  0:00:08  0:04:03 1748k\r  3  334M    3 12.4M    0     0  1359k      0  0:04:11  0:00:09  0:04:02 1674k\r  4  334M    4 13.8M    0     0  1361k      0  0:04:11  0:00:10  0:04:01 1535k\r  4  334M    4 15.1M    0     0  1359k      0  0:04:11  0:00:11  0:04:00 1421k\r  4  334M    4 15.4M    0     0  1193k      0  0:04:46  0:00:13  0:04:33 1002k\r  4  334M    4 15.5M    0     0   628k      0  0:09:04  0:00:25  0:08:39  263k\r  4  334M    4 15.5M    0     0   494k      0  0:11:31  0:00:32  0:10:59  137k\r  5  334M    5 16.9M    0     0   534k      0  0:10:40  0:00:32  0:10:08  143k\r  5  334M    5 18.7M    0     0   573k      0  0:09:56  0:00:33  0:09:23  167k\r  5  334M    5 19.9M    0     0   594k      0  0:09:36  0:00:34  0:09:02  216k\r  6  334M    6 21.3M    0     0   617k      0  0:09:14  0:00:35  0:08:39  588k\r  6  334M    6 22.8M    0     0   643k      0  0:08:52  0:00:36  0:08:16 1760k\r  7  334M    7 24.6M    0     0   674k      0  0:08:27  0:00:37  0:07:50 1578k\r  7  334M    7 26.5M    0     0   707k      0  0:08:03  0:00:38  0:07:25 1619k\r  8  334M    8 27.9M    0     0   725k      0  0:07:51  0:00:39  0:07:12 1635k\r  8  334M    8 29.4M    0     0   743k      0  0:07:40  0:00:40  0:07:00 1613k\r  9  334M    9 30.9M    0     0   766k      0  0:07:26  0:00:41  0:06:45 1663k\r  9  334M    9 32.3M    0     0   782k      0  0:07:17  0:00:42  0:06:35 1589k\r 10  334M   10 33.8M    0     0   797k      0  0:07:09  0:00:43  0:06:26 1489k\r 10  334M   10 35.0M    0     0   808k      0  0:07:03  0:00:44  0:06:19 1460k\r 10  334M   10 36.1M    0     0   816k      0  0:06:59  0:00:45  0:06:14 1425k\r 11  334M   11 37.4M    0     0   825k      0  0:06:54  0:00:46  0:06:08 1318k\r 11  334M   11 38.7M    0     0   836k      0  0:06:49  0:00:47  0:06:02 1299k\r 11  334M   11 39.9M    0     0   845k      0  0:06:44  0:00:48  0:05:56 1259k\r 12  334M   12 41.2M    0     0   854k      0  0:06:40  0:00:49  0:05:51 1263k\r 12  334M   12 42.4M    0     0   863k      0  0:06:36  0:00:50  0:05:46 1290k\r 13  334M   13 43.8M    0     0   872k      0  0:06:32  0:00:51  0:05:41 1308k\r 13  334M   13 45.1M    0     0   882k      0  0:06:27  0:00:52  0:05:35 1321k\r 13  334M   13 46.5M    0     0   893k      0  0:06:23  0:00:53  0:05:30 1353k\r 14  334M   14 48.1M    0     0   906k      0  0:06:17  0:00:54  0:05:23 1414k\r 14  334M   14 49.8M    0     0   922k      0  0:06:11  0:00:55  0:05:16 1513k\r 15  334M   15 51.8M    0     0   941k      0  0:06:03  0:00:56  0:05:07 1647k\r 16  334M   16 54.0M    0     0   963k      0  0:05:55  0:00:57  0:04:58 1811k\r 16  334M   16 55.7M    0     0   977k      0  0:05:50  0:00:58  0:04:52 1881k\r 17  334M   17 57.7M    0     0   996k      0  0:05:43  0:00:59  0:04:44 1977k\r 17  334M   17 59.9M    0     0  1016k      0  0:05:36  0:01:00  0:04:36 2063k\r 18  334M   18 62.1M    0     0  1037k      0  0:05:30  0:01:01  0:04:29 2114k\r 19  334M   19 64.5M    0     0  1058k      0  0:05:23  0:01:02  0:04:21 2150k\r 20  334M   20 66.9M    0     0  1081k      0  0:05:16  0:01:03  0:04:13 2291k\r 20  334M   20 69.0M    0     0  1097k      0  0:05:11  0:01:04  0:04:07 2296k\r 21  334M   21 70.5M    0     0  1105k      0  0:05:09  0:01:05  0:04:04 2178k\r 21  334M   21 72.5M    0     0  1119k      0  0:05:05  0:01:06  0:03:59 2132k\r 22  334M   22 74.8M    0     0  1136k      0  0:05:01  0:01:07  0:03:54 2104k\r 23  334M   23 77.0M    0     0  1153k      0  0:04:56  0:01:08  0:03:48 2074k\r 23  334M   23 79.4M    0     0  1172k      0  0:04:52  0:01:09  0:03:43 2136k\r 24  334M   24 81.8M    0     0  1190k      0  0:04:47  0:01:10  0:03:37 2305k\r 25  334M   25 84.2M    0     0  1208k      0  0:04:43  0:01:11  0:03:32 2384k\r 25  334M   25 86.6M    0     0  1224k      0  0:04:39  0:01:12  0:03:27 2417k\r 26  334M   26 88.9M    0     0  1240k      0  0:04:35  0:01:13  0:03:22 2422k\r 27  334M   27 91.2M    0     0  1255k      0  0:04:32  0:01:14  0:03:18 2418k\r 28  334M   28 93.6M    0     0  1271k      0  0:04:29  0:01:15  0:03:14 2416k\r 28  334M   28 96.0M    0     0  1287k      0  0:04:25  0:01:16  0:03:09 2415k\r 29  334M   29 98.4M    0     0  1302k      0  0:04:22  0:01:17  0:03:05 2429k\r 30  334M   30  100M    0     0  1310k      0  0:04:21  0:01:18  0:03:03 2328k\r 30  334M   30  102M    0     0  1327k      0  0:04:17  0:01:19  0:02:58 2393k\r 31  334M   31  104M    0     0  1336k      0  0:04:16  0:01:20  0:02:56 2307k\r 31  334M   31  106M    0     0  1343k      0  0:04:14  0:01:21  0:02:53 2206k\r 32  334M   32  108M    0     0  1351k      0  0:04:13  0:01:22  0:02:51 2108k\r 33  334M   33  110M    0     0  1359k      0  0:04:11  0:01:23  0:02:48 2130k\r 33  334M   33  112M    0     0  1367k      0  0:04:10  0:01:24  0:02:46 2005k\r 34  334M   34  114M    0     0  1372k      0  0:04:09  0:01:25  0:02:44 1952k\r 34  334M   34  116M    0     0  1375k      0  0:04:08  0:01:26  0:02:42 1897k\r 35  334M   35  117M    0     0  1376k      0  0:04:08  0:01:27  0:02:41 1768k\r 35  334M   35  119M    0     0  1382k      0  0:04:07  0:01:28  0:02:39 1764k\r 36  334M   36  120M    0     0  1382k      0  0:04:07  0:01:29  0:02:38 1623k\r 36  334M   36  121M    0     0  1378k      0  0:04:08  0:01:30  0:02:38 1489k\r 36  334M   36  122M    0     0  1376k      0  0:04:08  0:01:31  0:02:37 1392k\r 37  334M   37  124M    0     0  1375k      0  0:04:08  0:01:32  0:02:36 1353k\r 37  334M   37  125M    0     0  1374k      0  0:04:09  0:01:33  0:02:36 1235k\r 37  334M   37  126M    0     0  1372k      0  0:04:09  0:01:34  0:02:35 1193k\r 38  334M   38  127M    0     0  1371k      0  0:04:09  0:01:35  0:02:34 1236k\r 38  334M   38  129M    0     0  1370k      0  0:04:09  0:01:36  0:02:33 1258k\r 38  334M   38  130M    0     0  1369k      0  0:04:09  0:01:37  0:02:32 1263k\r 39  334M   39  131M    0     0  1369k      0  0:04:09  0:01:38  0:02:31 1277k\r 39  334M   39  133M    0     0  1370k      0  0:04:09  0:01:39  0:02:30 1340k\r 40  334M   40  134M    0     0  1373k      0  0:04:09  0:01:40  0:02:29 1417k\r 40  334M   40  136M    0     0  1377k      0  0:04:08  0:01:41  0:02:27 1518k\r 41  334M   41  138M    0     0  1383k      0  0:04:07  0:01:42  0:02:25 1652k\r 41  334M   41  140M    0     0  1390k      0  0:04:06  0:01:43  0:02:23 1796k\r 42  334M   42  142M    0     0  1395k      0  0:04:05  0:01:44  0:02:21 1901k\r 43  334M   43  144M    0     0  1401k      0  0:04:04  0:01:45  0:02:19 1963k\r 43  334M   43  146M    0     0  1407k      0  0:04:03  0:01:46  0:02:17 2010k\r 44  334M   44  148M    0     0  1412k      0  0:04:02  0:01:47  0:02:15 2008k\r 44  334M   44  150M    0     0  1418k      0  0:04:01  0:01:48  0:02:13 1997k\r 45  334M   45  151M    0     0  1422k      0  0:04:00  0:01:49  0:02:11 1979k\r 45  334M   45  153M    0     0  1426k      0  0:04:00  0:01:50  0:02:10 1943k\r 46  334M   46  155M    0     0  1425k      0  0:04:00  0:01:51  0:02:09 1804k\r 46  334M   46  156M    0     0  1427k      0  0:03:59  0:01:52  0:02:07 1747k\r 47  334M   47  157M    0     0  1426k      0  0:03:59  0:01:53  0:02:06 1607k\r 47  334M   47  159M    0     0  1426k      0  0:04:00  0:01:54  0:02:06 1502k\r 48  334M   48  160M    0     0  1425k      0  0:04:00  0:01:55  0:02:05 1405k\r 48  334M   48  161M    0     0  1424k      0  0:04:00  0:01:56  0:02:04 1410k\r 48  334M   48  163M    0     0  1424k      0  0:04:00  0:01:57  0:02:03 1367k\r 49  334M   49  164M    0     0  1424k      0  0:04:00  0:01:58  0:02:02 1388k\r 49  334M   49  166M    0     0  1425k      0  0:04:00  0:01:59  0:02:01 1402k\r 50  334M   50  167M    0     0  1425k      0  0:04:00  0:02:00  0:02:00 1432k\r 50  334M   50  169M    0     0  1426k      0  0:03:59  0:02:01  0:01:58 1473k\r 51  334M   51  170M    0     0  1429k      0  0:03:59  0:02:02  0:01:57 1529k\r 51  334M   51  172M    0     0  1433k      0  0:03:58  0:02:03  0:01:55 1631k\r 52  334M   52  174M    0     0  1438k      0  0:03:58  0:02:04  0:01:54 1751k\r 52  334M   52  176M    0     0  1442k      0  0:03:57  0:02:05  0:01:52 1856k\r 53  334M   53  178M    0     0  1446k      0  0:03:56  0:02:06  0:01:50 1932k\r 54  334M   54  180M    0     0  1451k      0  0:03:55  0:02:07  0:01:48 1991k\r 54  334M   54  182M    0     0  1455k      0  0:03:55  0:02:08  0:01:47 2008k\r 55  334M   55  184M    0     0  1459k      0  0:03:54  0:02:09  0:01:45 2000k\r 55  334M   55  186M    0     0  1463k      0  0:03:53  0:02:10  0:01:43 1994k\r 56  334M   56  188M    0     0  1468k      0  0:03:53  0:02:11  0:01:42 2000k\r 56  334M   56  190M    0     0  1471k      0  0:03:52  0:02:12  0:01:40 1996k\r 57  334M   57  192M    0     0  1476k      0  0:03:51  0:02:13  0:01:38 2005k\r 58  334M   58  194M    0     0  1480k      0  0:03:51  0:02:14  0:01:37 2005k\r 58  334M   58  196M    0     0  1484k      0  0:03:50  0:02:15  0:01:35 2023k\r 59  334M   59  198M    0     0  1488k      0  0:03:50  0:02:16  0:01:34 2016k\r 59  334M   59  200M    0     0  1491k      0  0:03:49  0:02:17  0:01:32 2016k\r 60  334M   60  202M    0     0  1495k      0  0:03:48  0:02:18  0:01:30 2014k\r 61  334M   61  204M    0     0  1499k      0  0:03:48  0:02:19  0:01:29 2010k\r 61  334M   61  206M    0     0  1502k      0  0:03:47  0:02:20  0:01:27 1989k\r 62  334M   62  207M    0     0  1505k      0  0:03:47  0:02:21  0:01:26 1983k\r 62  334M   62  209M    0     0  1508k      0  0:03:46  0:02:22  0:01:24 1985k\r 63  334M   63  211M    0     0  1512k      0  0:03:46  0:02:23  0:01:23 1987k\r 63  334M   63  213M    0     0  1515k      0  0:03:45  0:02:24  0:01:21 1983k\r 64  334M   64  215M    0     0  1519k      0  0:03:45  0:02:25  0:01:20 1990k\r 65  334M   65  217M    0     0  1522k      0  0:03:44  0:02:26  0:01:18 2010k\r 65  334M   65  219M    0     0  1526k      0  0:03:44  0:02:27  0:01:17 2018k\r 66  334M   66  221M    0     0  1529k      0  0:03:43  0:02:28  0:01:15 2014k\r 66  334M   66  223M    0     0  1532k      0  0:03:43  0:02:29  0:01:14 2022k\r 67  334M   67  225M    0     0  1536k      0  0:03:42  0:02:30  0:01:12 2038k\r 68  334M   68  227M    0     0  1539k      0  0:03:42  0:02:31  0:01:11 2025k\r 68  334M   68  229M    0     0  1539k      0  0:03:42  0:02:32  0:01:10 1924k\r 69  334M   69  231M    0     0  1543k      0  0:03:41  0:02:33  0:01:08 1961k\r 69  334M   69  233M    0     0  1545k      0  0:03:41  0:02:34  0:01:07 1922k\r 70  334M   70  234M    0     0  1548k      0  0:03:41  0:02:35  0:01:06 1893k\r 70  334M   70  236M    0     0  1551k      0  0:03:40  0:02:36  0:01:04 1909k\r 71  334M   71  238M    0     0  1553k      0  0:03:40  0:02:37  0:01:03 1992k\r 72  334M   72  240M    0     0  1556k      0  0:03:39  0:02:38  0:01:01 1962k\r 72  334M   72  242M    0     0  1560k      0  0:03:39  0:02:39  0:01:00 2009k\r 73  334M   73  244M    0     0  1562k      0  0:03:39  0:02:40  0:00:59 2022k\r 73  334M   73  246M    0     0  1562k      0  0:03:39  0:02:41  0:00:58 1896k\r 74  334M   74  248M    0     0  1565k      0  0:03:38  0:02:42  0:00:56 1946k\r 74  334M   74  249M    0     0  1566k      0  0:03:38  0:02:43  0:00:55 1875k\r 75  334M   75  251M    0     0  1567k      0  0:03:38  0:02:44  0:00:54 1818k\r 75  334M   75  253M    0     0  1569k      0  0:03:38  0:02:45  0:00:53 1775k\r 76  334M   76  255M    0     0  1570k      0  0:03:37  0:02:46  0:00:51 1853k\r 76  334M   76  257M    0     0  1572k      0  0:03:37  0:02:47  0:00:50 1790k\r 77  334M   77  258M    0     0  1574k      0  0:03:37  0:02:48  0:00:49 1832k\r 78  334M   78  260M    0     0  1576k      0  0:03:37  0:02:49  0:00:48 1851k\r 78  334M   78  262M    0     0  1577k      0  0:03:36  0:02:50  0:00:46 1860k\r 78  334M   78  263M    0     0  1555k      0  0:03:40  0:02:53  0:00:47 1193k\r 78  334M   78  263M    0     0  1552k      0  0:03:40  0:02:53  0:00:47 1014k\r 79  334M   79  266M    0     0  1566k      0  0:03:38  0:02:54  0:00:44 1335k\r 80  334M   80  269M    0     0  1576k      0  0:03:37  0:02:55  0:00:42 1574k\r 81  334M   81  272M    0     0  1581k      0  0:03:36  0:02:56  0:00:40 1676k\r 82  334M   82  274M    0     0  1586k      0  0:03:35  0:02:57  0:00:38 2878k\r 82  334M   82  277M    0     0  1591k      0  0:03:35  0:02:58  0:00:37 3056k\r 83  334M   83  279M    0     0  1597k      0  0:03:34  0:02:59  0:00:35 2674k\r 84  334M   84  282M    0     0  1602k      0  0:03:33  0:03:00  0:00:33 2528k\r 85  334M   85  284M    0     0  1605k      0  0:03:33  0:03:01  0:00:32 2478k\r 85  334M   85  286M    0     0  1608k      0  0:03:32  0:03:02  0:00:30 2398k\r 86  334M   86  288M    0     0  1612k      0  0:03:32  0:03:03  0:00:29 2358k\r 87  334M   87  291M    0     0  1617k      0  0:03:31  0:03:04  0:00:27 2337k\r 87  334M   87  293M    0     0  1622k      0  0:03:31  0:03:05  0:00:26 2328k\r 88  334M   88  296M    0     0  1627k      0  0:03:30  0:03:06  0:00:24 2411k\r 89  334M   89  298M    0     0  1632k      0  0:03:29  0:03:07  0:00:22 2508k\r 90  334M   90  301M    0     0  1638k      0  0:03:28  0:03:08  0:00:20 2570k\r 90  334M   90  303M    0     0  1643k      0  0:03:28  0:03:09  0:00:19 2607k\r 91  334M   91  306M    0     0  1648k      0  0:03:27  0:03:10  0:00:17 2621k\r 92  334M   92  308M    0     0  1650k      0  0:03:27  0:03:11  0:00:16 2481k\r 92  334M   92  310M    0     0  1653k      0  0:03:27  0:03:12  0:00:15 2440k\r 93  334M   93  311M    0     0  1650k      0  0:03:27  0:03:13  0:00:14 2120k\r 93  334M   93  313M    0     0  1649k      0  0:03:27  0:03:14  0:00:13 1887k\r 94  334M   94  314M    0     0  1647k      0  0:03:27  0:03:15  0:00:12 1597k\r 94  334M   94  315M    0     0  1644k      0  0:03:28  0:03:16  0:00:12 1409k\r 94  334M   94  316M    0     0  1640k      0  0:03:28  0:03:17  0:00:11 1131k\r 94  334M   94  316M    0     0  1634k      0  0:03:29  0:03:18  0:00:11 1032k\r 94  334M   94  317M    0     0  1629k      0  0:03:30  0:03:19  0:00:11  848k\r 95  334M   95  317M    0     0  1624k      0  0:03:30  0:03:20  0:00:10  726k\r 95  334M   95  318M    0     0  1618k      0  0:03:31  0:03:21  0:00:10  622k\r 95  334M   95  318M    0     0  1613k      0  0:03:32  0:03:22  0:00:10  560k\r 95  334M   95  319M    0     0  1608k      0  0:03:32  0:03:23  0:00:09  549k\r 95  334M   95  319M    0     0  1602k      0  0:03:33  0:03:24  0:00:09  542k\r 95  334M   95  320M    0     0  1597k      0  0:03:34  0:03:25  0:00:09  522k\r 95  334M   95  320M    0     0  1591k      0  0:03:35  0:03:26  0:00:09  475k\r 96  334M   96  321M    0     0  1585k      0  0:03:35  0:03:27  0:00:08  459k\r 96  334M   96  321M    0     0  1578k      0  0:03:36  0:03:28  0:00:08  411k\r 96  334M   96  321M    0     0  1573k      0  0:03:37  0:03:29  0:00:08  391k\r 96  334M   96  322M    0     0  1568k      0  0:03:38  0:03:30  0:00:08  370k\r 96  334M   96  322M    0     0  1562k      0  0:03:39  0:03:31  0:00:08  381k\r 96  334M   96  322M    0     0  1557k      0  0:03:39  0:03:32  0:00:07  364k\r 96  334M   96  323M    0     0  1551k      0  0:03:40  0:03:33  0:00:07  385k\r 96  334M   96  323M    0     0  1546k      0  0:03:41  0:03:34  0:00:07  383k\r 96  334M   96  324M    0     0  1541k      0  0:03:42  0:03:35  0:00:07  396k\r 97  334M   97  324M    0     0  1533k      0  0:03:43  0:03:36  0:00:07  355k\r 97  334M   97  324M    0     0  1529k      0  0:03:43  0:03:37  0:00:06  354k\r 97  334M   97  325M    0     0  1523k      0  0:03:44  0:03:38  0:00:06  336k\r 97  334M   97  325M    0     0  1518k      0  0:03:45  0:03:39  0:00:06  316k\r 97  334M   97  325M    0     0  1511k      0  0:03:46  0:03:40  0:00:06  277k\r 97  334M   97  325M    0     0  1506k      0  0:03:47  0:03:41  0:00:06  295k\r 97  334M   97  326M    0     0  1501k      0  0:03:47  0:03:42  0:00:05  279k\r 97  334M   97  326M    0     0  1495k      0  0:03:48  0:03:43  0:00:05  278k\r 97  334M   97  326M    0     0  1490k      0  0:03:49  0:03:44  0:00:05  275k\r 97  334M   97  326M    0     0  1485k      0  0:03:50  0:03:45  0:00:05  289k\r 97  334M   97  327M    0     0  1479k      0  0:03:51  0:03:46  0:00:05  292k\r 97  334M   97  327M    0     0  1475k      0  0:03:52  0:03:47  0:00:05  304k\r 98  334M   98  327M    0     0  1470k      0  0:03:52  0:03:48  0:00:04  328k\r 98  334M   98  328M    0     0  1466k      0  0:03:53  0:03:49  0:00:04  376k\r 98  334M   98  329M    0     0  1463k      0  0:03:53  0:03:50  0:00:03  462k\r 98  334M   98  330M    0     0  1460k      0  0:03:54  0:03:51  0:00:03  593k\r 99  334M   99  331M    0     0  1460k      0  0:03:54  0:03:52  0:00:02  781k\r 99  334M   99  333M    0     0  1461k      0  0:03:54  0:03:53  0:00:01 1045k\r100  334M  100  334M    0     0  1462k      0  0:03:54  0:03:54 --:--:-- 1292k\n0+43943 records in\n0+43943 records out\n645262336 bytes (645 MB, 615 MiB) copied, 263.159 s, 2.5 MB/s\n+ sync\n+ partprobe /dev/sda\n+ mount /dev/sda2 /mnt\n+ cp -a /snap/cm3-installer/6/extrausers /mnt/system-data/var/lib/\n+ mkdir -p /mnt/user-data/ubuntu\n+ chown -R 1000.1000 /mnt/user-data/ubuntu\n+ mkdir -p /mnt/system-data/etc/sudoers.d\n+ echo 'ubuntu ALL=(ALL) NOPASSWD:ALL'\n+ umount /mnt\n"
2018-05-24 10:16:26,675 cm3-001 INFO: b"Warning: Permanently added '10.101.50.182' (ECDSA) to the list of known hosts.\r\n"
2018-05-24 10:16:38,021 cm3-001 INFO: Running snmpset -c private -v1 10.101.48.8 .1.3.6.1.4.1.318.1.1.12.3.3.1.1.4.2 i 2
iso.3.6.1.4.1.318.1.1.12.3.3.1.1.4.2 = INTEGER: 2
2018-05-24 10:16:38,140 cm3-001 INFO: Running sleep 10
2018-05-24 10:16:48,159 cm3-001 INFO: Running snmpset -c private -v1 10.101.48.8 .1.3.6.1.4.1.318.1.1.12.3.3.1.1.4.2 i 1
iso.3.6.1.4.1.318.1.1.12.3.3.1.1.4.2 = INTEGER: 1
2018-05-24 10:16:48,277 cm3-001 INFO: Checking if test image booted.
2018-05-24 10:17:30,710 cm3-001 INFO: END provision

**********************************

* Starting test phase on cm3-002 *

**********************************
Install python-logstash if you want to use logstash logging
2018-05-24 10:17:34,792 cm3-001 INFO: BEGIN testrun

WARNING: apt does not have a stable CLI interface. Use with caution in scripts.

Hit:1 http://archive.ubuntu.com/ubuntu xenial InRelease
Get:2 http://security.ubuntu.com/ubuntu xenial-security InRelease [107 kB]
Get:3 http://archive.ubuntu.com/ubuntu xenial-updates InRelease [109 kB]
Get:4 http://security.ubuntu.com/ubuntu xenial-security/universe Sources [80.9 kB]
Get:5 http://archive.ubuntu.com/ubuntu xenial-backports InRelease [107 kB]
Get:6 http://security.ubuntu.com/ubuntu xenial-security/main amd64 Packages [637 kB]
Get:7 http://archive.ubuntu.com/ubuntu xenial-updates/universe Sources [255 kB]
Get:8 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 Packages [1012 kB]
Get:9 http://security.ubuntu.com/ubuntu xenial-security/universe amd64 Packages [444 kB]
Get:10 http://security.ubuntu.com/ubuntu xenial-security/multiverse amd64 Packages [3759 B]
Get:11 http://archive.ubuntu.com/ubuntu xenial-updates/universe amd64 Packages [813 kB]
Get:12 http://archive.ubuntu.com/ubuntu xenial-updates/multiverse amd64 Packages [18.8 kB]
Fetched 3587 kB in 3s (979 kB/s)
Reading package lists...
Building dependency tree...
Reading state information...
3 packages can be upgraded. Run 'apt list --upgradable' to see them.

WARNING: apt does not have a stable CLI interface. Use with caution in scripts.

Reading package lists...
Building dependency tree...
Reading state information...
The following additional packages will be installed:
  git-man ifupdown iproute2 isc-dhcp-client isc-dhcp-common less
  libasn1-8-heimdal libatm1 libcurl3-gnutls libdns-export162 liberror-perl
  libgdbm3 libgmp10 libgnutls30 libgssapi3-heimdal libhcrypto4-heimdal
  libheimbase1-heimdal libheimntlm0-heimdal libhogweed4 libhx509-5-heimdal
  libisc-export160 libkrb5-26-heimdal libldap-2.4-2 libmnl0 libnettle6
  libp11-kit0 libperl5.22 libpopt0 libroken18-heimdal librtmp1 libsasl2-2
  libsasl2-modules libsasl2-modules-db libtasn1-6 libwind0-heimdal
  libxtables11 netbase patch perl perl-modules-5.22 rename rsync
Suggested packages:
  gettext-base git-daemon-run | git-daemon-sysvinit git-doc git-el git-email
  git-gui gitk gitweb git-arch git-cvs git-mediawiki git-svn ppp rdnssd
  iproute2-doc resolvconf avahi-autoipd isc-dhcp-client-ddns apparmor
  gnutls-bin libsasl2-modules-otp libsasl2-modules-ldap libsasl2-modules-sql
  libsasl2-modules-gssapi-mit | libsasl2-modules-gssapi-heimdal ed
  diffutils-doc perl-doc libterm-readline-gnu-perl
  | libterm-readline-perl-perl make openssh-server
The following NEW packages will be installed:
  curl git git-man ifupdown iproute2 isc-dhcp-client isc-dhcp-common less
  libasn1-8-heimdal libatm1 libcurl3-gnutls libdns-export162 liberror-perl
  libgdbm3 libgmp10 libgnutls30 libgssapi3-heimdal libhcrypto4-heimdal
  libheimbase1-heimdal libheimntlm0-heimdal libhogweed4 libhx509-5-heimdal
  libisc-export160 libkrb5-26-heimdal libldap-2.4-2 libmnl0 libnettle6
  libp11-kit0 libperl5.22 libpopt0 libroken18-heimdal librtmp1 libsasl2-2
  libsasl2-modules libsasl2-modules-db libtasn1-6 libwind0-heimdal
  libxtables11 netbase patch perl perl-modules-5.22 rename rsync sshpass
0 upgraded, 45 newly installed, 0 to remove and 3 not upgraded.
Need to get 15.1 MB of archives.
After this operation, 79.7 MB of additional disk space will be used.
Get:1 http://archive.ubuntu.com/ubuntu xenial/main amd64 libatm1 amd64 1:2.5.1-1.5 [24.2 kB]
Get:2 http://archive.ubuntu.com/ubuntu xenial/main amd64 libmnl0 amd64 1.0.3-5 [12.0 kB]
Get:3 http://archive.ubuntu.com/ubuntu xenial/main amd64 libpopt0 amd64 1.16-10 [26.0 kB]
Get:4 http://archive.ubuntu.com/ubuntu xenial/main amd64 libgdbm3 amd64 1.8.3-13.1 [16.9 kB]
Get:5 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 perl-modules-5.22 all 5.22.1-9ubuntu0.3 [2646 kB]
Get:6 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 libperl5.22 amd64 5.22.1-9ubuntu0.3 [3402 kB]
Get:7 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 perl amd64 5.22.1-9ubuntu0.3 [237 kB]
Get:8 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 iproute2 amd64 4.3.0-1ubuntu3.16.04.3 [522 kB]
Get:9 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 ifupdown amd64 0.8.10ubuntu1.4 [54.9 kB]
Get:10 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 libisc-export160 amd64 1:9.10.3.dfsg.P4-8ubuntu1.10 [153 kB]
Get:11 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 libdns-export162 amd64 1:9.10.3.dfsg.P4-8ubuntu1.10 [666 kB]
Get:12 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 isc-dhcp-client amd64 4.3.3-5ubuntu12.10 [224 kB]
Get:13 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 isc-dhcp-common amd64 4.3.3-5ubuntu12.10 [105 kB]
Get:14 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 less amd64 481-2.1ubuntu0.2 [110 kB]
Get:15 http://archive.ubuntu.com/ubuntu xenial/main amd64 libgmp10 amd64 2:6.1.0+dfsg-2 [240 kB]
Get:16 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 libnettle6 amd64 3.2-1ubuntu0.16.04.1 [93.5 kB]
Get:17 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 libhogweed4 amd64 3.2-1ubuntu0.16.04.1 [136 kB]
Get:18 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 libp11-kit0 amd64 0.23.2-5~ubuntu16.04.1 [105 kB]
Get:19 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 libtasn1-6 amd64 4.7-3ubuntu0.16.04.3 [43.5 kB]
Get:20 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 libgnutls30 amd64 3.4.10-4ubuntu1.4 [548 kB]
Get:21 http://archive.ubuntu.com/ubuntu xenial/main amd64 libxtables11 amd64 1.6.0-2ubuntu3 [27.2 kB]
Get:22 http://archive.ubuntu.com/ubuntu xenial/main amd64 netbase all 5.3 [12.9 kB]
Get:23 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 libroken18-heimdal amd64 1.7~git20150920+dfsg-4ubuntu1.16.04.1 [41.4 kB]
Get:24 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 libasn1-8-heimdal amd64 1.7~git20150920+dfsg-4ubuntu1.16.04.1 [174 kB]
Get:25 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 libhcrypto4-heimdal amd64 1.7~git20150920+dfsg-4ubuntu1.16.04.1 [85.0 kB]
Get:26 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 libheimbase1-heimdal amd64 1.7~git20150920+dfsg-4ubuntu1.16.04.1 [29.3 kB]
Get:27 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 libwind0-heimdal amd64 1.7~git20150920+dfsg-4ubuntu1.16.04.1 [47.8 kB]
Get:28 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 libhx509-5-heimdal amd64 1.7~git20150920+dfsg-4ubuntu1.16.04.1 [107 kB]
Get:29 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 libkrb5-26-heimdal amd64 1.7~git20150920+dfsg-4ubuntu1.16.04.1 [202 kB]
Get:30 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 libheimntlm0-heimdal amd64 1.7~git20150920+dfsg-4ubuntu1.16.04.1 [15.1 kB]
Get:31 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 libgssapi3-heimdal amd64 1.7~git20150920+dfsg-4ubuntu1.16.04.1 [96.1 kB]
Get:32 http://archive.ubuntu.com/ubuntu xenial/main amd64 libsasl2-modules-db amd64 2.1.26.dfsg1-14build1 [14.5 kB]
Get:33 http://archive.ubuntu.com/ubuntu xenial/main amd64 libsasl2-2 amd64 2.1.26.dfsg1-14build1 [48.7 kB]
Get:34 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 libldap-2.4-2 amd64 2.4.42+dfsg-2ubuntu3.2 [160 kB]
Get:35 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 librtmp1 amd64 2.4+20151223.gitfa8646d-1ubuntu0.1 [54.4 kB]
Get:36 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 libcurl3-gnutls amd64 7.47.0-1ubuntu2.8 [185 kB]
Get:37 http://archive.ubuntu.com/ubuntu xenial/main amd64 libsasl2-modules amd64 2.1.26.dfsg1-14build1 [47.5 kB]
Get:38 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 rsync amd64 3.1.1-3ubuntu1.2 [329 kB]
Get:39 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 curl amd64 7.47.0-1ubuntu2.8 [139 kB]
Get:40 http://archive.ubuntu.com/ubuntu xenial/main amd64 liberror-perl all 0.17-1.2 [19.6 kB]
Get:41 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 git-man all 1:2.7.4-0ubuntu1.3 [736 kB]
Get:42 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 git amd64 1:2.7.4-0ubuntu1.3 [3102 kB]
Get:43 http://archive.ubuntu.com/ubuntu xenial-updates/main amd64 patch amd64 2.7.5-1ubuntu0.16.04.1 [90.5 kB]
Get:44 http://archive.ubuntu.com/ubuntu xenial/main amd64 rename all 0.20-4 [12.0 kB]
Get:45 http://archive.ubuntu.com/ubuntu xenial/universe amd64 sshpass amd64 1.05-1 [10.5 kB]
debconf: delaying package configuration, since apt-utils is not installed
Fetched 15.1 MB in 7s (2119 kB/s)
Selecting previously unselected package libatm1:amd64.
(Reading database ... (Reading database ... 5%(Reading database ... 10%(Reading database ... 15%(Reading database ... 20%(Reading database ... 25%(Reading database ... 30%(Reading database ... 35%(Reading database ... 40%(Reading database ... 45%(Reading database ... 50%(Reading database ... 55%(Reading database ... 60%(Reading database ... 65%(Reading database ... 70%(Reading database ... 75%(Reading database ... 80%(Reading database ... 85%(Reading database ... 90%(Reading database ... 95%(Reading database ... 100%(Reading database ... 9573 files and directories currently installed.)
Preparing to unpack .../libatm1_1%3a2.5.1-1.5_amd64.deb ...
Unpacking libatm1:amd64 (1:2.5.1-1.5) ...
Selecting previously unselected package libmnl0:amd64.
Preparing to unpack .../libmnl0_1.0.3-5_amd64.deb ...
Unpacking libmnl0:amd64 (1.0.3-5) ...
Selecting previously unselected package libpopt0:amd64.
Preparing to unpack .../libpopt0_1.16-10_amd64.deb ...
Unpacking libpopt0:amd64 (1.16-10) ...
Selecting previously unselected package libgdbm3:amd64.
Preparing to unpack .../libgdbm3_1.8.3-13.1_amd64.deb ...
Unpacking libgdbm3:amd64 (1.8.3-13.1) ...
Selecting previously unselected package perl-modules-5.22.
Preparing to unpack .../perl-modules-5.22_5.22.1-9ubuntu0.3_all.deb ...
Unpacking perl-modules-5.22 (5.22.1-9ubuntu0.3) ...
Selecting previously unselected package libperl5.22:amd64.
Preparing to unpack .../libperl5.22_5.22.1-9ubuntu0.3_amd64.deb ...
Unpacking libperl5.22:amd64 (5.22.1-9ubuntu0.3) ...
Selecting previously unselected package perl.
Preparing to unpack .../perl_5.22.1-9ubuntu0.3_amd64.deb ...
Unpacking perl (5.22.1-9ubuntu0.3) ...
Selecting previously unselected package iproute2.
Preparing to unpack .../iproute2_4.3.0-1ubuntu3.16.04.3_amd64.deb ...
Unpacking iproute2 (4.3.0-1ubuntu3.16.04.3) ...
Selecting previously unselected package ifupdown.
Preparing to unpack .../ifupdown_0.8.10ubuntu1.4_amd64.deb ...
Unpacking ifupdown (0.8.10ubuntu1.4) ...
Selecting previously unselected package libisc-export160.
Preparing to unpack .../libisc-export160_1%3a9.10.3.dfsg.P4-8ubuntu1.10_amd64.deb ...
Unpacking libisc-export160 (1:9.10.3.dfsg.P4-8ubuntu1.10) ...
Selecting previously unselected package libdns-export162.
Preparing to unpack .../libdns-export162_1%3a9.10.3.dfsg.P4-8ubuntu1.10_amd64.deb ...
Unpacking libdns-export162 (1:9.10.3.dfsg.P4-8ubuntu1.10) ...
Selecting previously unselected package isc-dhcp-client.
Preparing to unpack .../isc-dhcp-client_4.3.3-5ubuntu12.10_amd64.deb ...
Unpacking isc-dhcp-client (4.3.3-5ubuntu12.10) ...
Selecting previously unselected package isc-dhcp-common.
Preparing to unpack .../isc-dhcp-common_4.3.3-5ubuntu12.10_amd64.deb ...
Unpacking isc-dhcp-common (4.3.3-5ubuntu12.10) ...
Selecting previously unselected package less.
Preparing to unpack .../less_481-2.1ubuntu0.2_amd64.deb ...
Unpacking less (481-2.1ubuntu0.2) ...
Selecting previously unselected package libgmp10:amd64.
Preparing to unpack .../libgmp10_2%3a6.1.0+dfsg-2_amd64.deb ...
Unpacking libgmp10:amd64 (2:6.1.0+dfsg-2) ...
Selecting previously unselected package libnettle6:amd64.
Preparing to unpack .../libnettle6_3.2-1ubuntu0.16.04.1_amd64.deb ...
Unpacking libnettle6:amd64 (3.2-1ubuntu0.16.04.1) ...
Selecting previously unselected package libhogweed4:amd64.
Preparing to unpack .../libhogweed4_3.2-1ubuntu0.16.04.1_amd64.deb ...
Unpacking libhogweed4:amd64 (3.2-1ubuntu0.16.04.1) ...
Selecting previously unselected package libp11-kit0:amd64.
Preparing to unpack .../libp11-kit0_0.23.2-5~ubuntu16.04.1_amd64.deb ...
Unpacking libp11-kit0:amd64 (0.23.2-5~ubuntu16.04.1) ...
Selecting previously unselected package libtasn1-6:amd64.
Preparing to unpack .../libtasn1-6_4.7-3ubuntu0.16.04.3_amd64.deb ...
Unpacking libtasn1-6:amd64 (4.7-3ubuntu0.16.04.3) ...
Selecting previously unselected package libgnutls30:amd64.
Preparing to unpack .../libgnutls30_3.4.10-4ubuntu1.4_amd64.deb ...
Unpacking libgnutls30:amd64 (3.4.10-4ubuntu1.4) ...
Selecting previously unselected package libxtables11:amd64.
Preparing to unpack .../libxtables11_1.6.0-2ubuntu3_amd64.deb ...
Unpacking libxtables11:amd64 (1.6.0-2ubuntu3) ...
Selecting previously unselected package netbase.
Preparing to unpack .../archives/netbase_5.3_all.deb ...
Unpacking netbase (5.3) ...
Selecting previously unselected package libroken18-heimdal:amd64.
Preparing to unpack .../libroken18-heimdal_1.7~git20150920+dfsg-4ubuntu1.16.04.1_amd64.deb ...
Unpacking libroken18-heimdal:amd64 (1.7~git20150920+dfsg-4ubuntu1.16.04.1) ...
Selecting previously unselected package libasn1-8-heimdal:amd64.
Preparing to unpack .../libasn1-8-heimdal_1.7~git20150920+dfsg-4ubuntu1.16.04.1_amd64.deb ...
Unpacking libasn1-8-heimdal:amd64 (1.7~git20150920+dfsg-4ubuntu1.16.04.1) ...
Selecting previously unselected package libhcrypto4-heimdal:amd64.
Preparing to unpack .../libhcrypto4-heimdal_1.7~git20150920+dfsg-4ubuntu1.16.04.1_amd64.deb ...
Unpacking libhcrypto4-heimdal:amd64 (1.7~git20150920+dfsg-4ubuntu1.16.04.1) ...
Selecting previously unselected package libheimbase1-heimdal:amd64.
Preparing to unpack .../libheimbase1-heimdal_1.7~git20150920+dfsg-4ubuntu1.16.04.1_amd64.deb ...
Unpacking libheimbase1-heimdal:amd64 (1.7~git20150920+dfsg-4ubuntu1.16.04.1) ...
Selecting previously unselected package libwind0-heimdal:amd64.
Preparing to unpack .../libwind0-heimdal_1.7~git20150920+dfsg-4ubuntu1.16.04.1_amd64.deb ...
Unpacking libwind0-heimdal:amd64 (1.7~git20150920+dfsg-4ubuntu1.16.04.1) ...
Selecting previously unselected package libhx509-5-heimdal:amd64.
Preparing to unpack .../libhx509-5-heimdal_1.7~git20150920+dfsg-4ubuntu1.16.04.1_amd64.deb ...
Unpacking libhx509-5-heimdal:amd64 (1.7~git20150920+dfsg-4ubuntu1.16.04.1) ...
Selecting previously unselected package libkrb5-26-heimdal:amd64.
Preparing to unpack .../libkrb5-26-heimdal_1.7~git20150920+dfsg-4ubuntu1.16.04.1_amd64.deb ...
Unpacking libkrb5-26-heimdal:amd64 (1.7~git20150920+dfsg-4ubuntu1.16.04.1) ...
Selecting previously unselected package libheimntlm0-heimdal:amd64.
Preparing to unpack .../libheimntlm0-heimdal_1.7~git20150920+dfsg-4ubuntu1.16.04.1_amd64.deb ...
Unpacking libheimntlm0-heimdal:amd64 (1.7~git20150920+dfsg-4ubuntu1.16.04.1) ...
Selecting previously unselected package libgssapi3-heimdal:amd64.
Preparing to unpack .../libgssapi3-heimdal_1.7~git20150920+dfsg-4ubuntu1.16.04.1_amd64.deb ...
Unpacking libgssapi3-heimdal:amd64 (1.7~git20150920+dfsg-4ubuntu1.16.04.1) ...
Selecting previously unselected package libsasl2-modules-db:amd64.
Preparing to unpack .../libsasl2-modules-db_2.1.26.dfsg1-14build1_amd64.deb ...
Unpacking libsasl2-modules-db:amd64 (2.1.26.dfsg1-14build1) ...
Selecting previously unselected package libsasl2-2:amd64.
Preparing to unpack .../libsasl2-2_2.1.26.dfsg1-14build1_amd64.deb ...
Unpacking libsasl2-2:amd64 (2.1.26.dfsg1-14build1) ...
Selecting previously unselected package libldap-2.4-2:amd64.
Preparing to unpack .../libldap-2.4-2_2.4.42+dfsg-2ubuntu3.2_amd64.deb ...
Unpacking libldap-2.4-2:amd64 (2.4.42+dfsg-2ubuntu3.2) ...
Selecting previously unselected package librtmp1:amd64.
Preparing to unpack .../librtmp1_2.4+20151223.gitfa8646d-1ubuntu0.1_amd64.deb ...
Unpacking librtmp1:amd64 (2.4+20151223.gitfa8646d-1ubuntu0.1) ...
Selecting previously unselected package libcurl3-gnutls:amd64.
Preparing to unpack .../libcurl3-gnutls_7.47.0-1ubuntu2.8_amd64.deb ...
Unpacking libcurl3-gnutls:amd64 (7.47.0-1ubuntu2.8) ...
Selecting previously unselected package libsasl2-modules:amd64.
Preparing to unpack .../libsasl2-modules_2.1.26.dfsg1-14build1_amd64.deb ...
Unpacking libsasl2-modules:amd64 (2.1.26.dfsg1-14build1) ...
Selecting previously unselected package rsync.
Preparing to unpack .../rsync_3.1.1-3ubuntu1.2_amd64.deb ...
Unpacking rsync (3.1.1-3ubuntu1.2) ...
Selecting previously unselected package curl.
Preparing to unpack .../curl_7.47.0-1ubuntu2.8_amd64.deb ...
Unpacking curl (7.47.0-1ubuntu2.8) ...
Selecting previously unselected package liberror-perl.
Preparing to unpack .../liberror-perl_0.17-1.2_all.deb ...
Unpacking liberror-perl (0.17-1.2) ...
Selecting previously unselected package git-man.
Preparing to unpack .../git-man_1%3a2.7.4-0ubuntu1.3_all.deb ...
Unpacking git-man (1:2.7.4-0ubuntu1.3) ...
Selecting previously unselected package git.
Preparing to unpack .../git_1%3a2.7.4-0ubuntu1.3_amd64.deb ...
Unpacking git (1:2.7.4-0ubuntu1.3) ...
Selecting previously unselected package patch.
Preparing to unpack .../patch_2.7.5-1ubuntu0.16.04.1_amd64.deb ...
Unpacking patch (2.7.5-1ubuntu0.16.04.1) ...
Selecting previously unselected package rename.
Preparing to unpack .../archives/rename_0.20-4_all.deb ...
Unpacking rename (0.20-4) ...
Selecting previously unselected package sshpass.
Preparing to unpack .../sshpass_1.05-1_amd64.deb ...
Unpacking sshpass (1.05-1) ...
Processing triggers for systemd (229-4ubuntu21.2) ...
Processing triggers for libc-bin (2.23-0ubuntu10) ...
Processing triggers for mime-support (3.59ubuntu1) ...
Setting up libatm1:amd64 (1:2.5.1-1.5) ...
Setting up libmnl0:amd64 (1.0.3-5) ...
Setting up libpopt0:amd64 (1.16-10) ...
Setting up libgdbm3:amd64 (1.8.3-13.1) ...
Setting up perl-modules-5.22 (5.22.1-9ubuntu0.3) ...
Setting up libperl5.22:amd64 (5.22.1-9ubuntu0.3) ...
Setting up perl (5.22.1-9ubuntu0.3) ...
update-alternatives: using /usr/bin/prename to provide /usr/bin/rename (rename) in auto mode
Setting up iproute2 (4.3.0-1ubuntu3.16.04.3) ...
Setting up ifupdown (0.8.10ubuntu1.4) ...
Creating /etc/network/interfaces.
Setting up libisc-export160 (1:9.10.3.dfsg.P4-8ubuntu1.10) ...
Setting up libdns-export162 (1:9.10.3.dfsg.P4-8ubuntu1.10) ...
Setting up isc-dhcp-client (4.3.3-5ubuntu12.10) ...
Setting up isc-dhcp-common (4.3.3-5ubuntu12.10) ...
Setting up less (481-2.1ubuntu0.2) ...
debconf: unable to initialize frontend: Dialog
debconf: (No usable dialog-like program is installed, so the dialog based frontend cannot be used. at /usr/share/perl5/Debconf/FrontEnd/Dialog.pm line 76.)
debconf: falling back to frontend: Readline
Setting up libgmp10:amd64 (2:6.1.0+dfsg-2) ...
Setting up libnettle6:amd64 (3.2-1ubuntu0.16.04.1) ...
Setting up libhogweed4:amd64 (3.2-1ubuntu0.16.04.1) ...
Setting up libp11-kit0:amd64 (0.23.2-5~ubuntu16.04.1) ...
Setting up libtasn1-6:amd64 (4.7-3ubuntu0.16.04.3) ...
Setting up libgnutls30:amd64 (3.4.10-4ubuntu1.4) ...
Setting up libxtables11:amd64 (1.6.0-2ubuntu3) ...
Setting up netbase (5.3) ...
Setting up libroken18-heimdal:amd64 (1.7~git20150920+dfsg-4ubuntu1.16.04.1) ...
Setting up libasn1-8-heimdal:amd64 (1.7~git20150920+dfsg-4ubuntu1.16.04.1) ...
Setting up libhcrypto4-heimdal:amd64 (1.7~git20150920+dfsg-4ubuntu1.16.04.1) ...
Setting up libheimbase1-heimdal:amd64 (1.7~git20150920+dfsg-4ubuntu1.16.04.1) ...
Setting up libwind0-heimdal:amd64 (1.7~git20150920+dfsg-4ubuntu1.16.04.1) ...
Setting up libhx509-5-heimdal:amd64 (1.7~git20150920+dfsg-4ubuntu1.16.04.1) ...
Setting up libkrb5-26-heimdal:amd64 (1.7~git20150920+dfsg-4ubuntu1.16.04.1) ...
Setting up libheimntlm0-heimdal:amd64 (1.7~git20150920+dfsg-4ubuntu1.16.04.1) ...
Setting up libgssapi3-heimdal:amd64 (1.7~git20150920+dfsg-4ubuntu1.16.04.1) ...
Setting up libsasl2-modules-db:amd64 (2.1.26.dfsg1-14build1) ...
Setting up libsasl2-2:amd64 (2.1.26.dfsg1-14build1) ...
Setting up libldap-2.4-2:amd64 (2.4.42+dfsg-2ubuntu3.2) ...
Setting up librtmp1:amd64 (2.4+20151223.gitfa8646d-1ubuntu0.1) ...
Setting up libcurl3-gnutls:amd64 (7.47.0-1ubuntu2.8) ...
Setting up libsasl2-modules:amd64 (2.1.26.dfsg1-14build1) ...
Setting up rsync (3.1.1-3ubuntu1.2) ...
invoke-rc.d: could not determine current runlevel
invoke-rc.d: policy-rc.d denied execution of restart.
Setting up curl (7.47.0-1ubuntu2.8) ...
Setting up liberror-perl (0.17-1.2) ...
Setting up git-man (1:2.7.4-0ubuntu1.3) ...
Setting up git (1:2.7.4-0ubuntu1.3) ...
Setting up patch (2.7.5-1ubuntu0.16.04.1) ...
Setting up rename (0.20-4) ...
update-alternatives: using /usr/bin/file-rename to provide /usr/bin/rename (rename) in auto mode
Setting up sshpass (1.05-1) ...
Processing triggers for libc-bin (2.23-0ubuntu10) ...
Processing triggers for systemd (229-4ubuntu21.2) ...
Cloning into 'snappy-qa-jobs'...
Already on 'master'
Your branch is up-to-date with 'origin/master'.
Cloning into 'snapd'...
Already on 'master'
Your branch is up-to-date with 'origin/master'.
++ INSTANCE_IP=10.101.50.183
++ INSTANCE_PORT=22
++ USER=ubuntu
++ execute_remote 'sudo adduser --extrausers --quiet --disabled-password --gecos '\'''\'' test'
++ ssh -q -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no -p 22 ubuntu@10.101.50.183 'sudo adduser --extrausers --quiet --disabled-password --gecos '\'''\'' test'
ENTER EXTRAUSERS_GROUP_FILEEXIT EXTRAUSERS_GROUP_FILEENTER EXTRAUSERS_SHADOWGROUP_FILEEXIT EXTRAUSERS_SHADOWGROUP_FILE++ execute_remote 'echo test:ubuntu | sudo chpasswd'
++ ssh -q -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no -p 22 ubuntu@10.101.50.183 'echo test:ubuntu | sudo chpasswd'
++ execute_remote 'echo '\''test ALL=(ALL) NOPASSWD:ALL'\'' | sudo tee /etc/sudoers.d/create-user-test'
++ ssh -q -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no -p 22 ubuntu@10.101.50.183 'echo '\''test ALL=(ALL) NOPASSWD:ALL'\'' | sudo tee /etc/sudoers.d/create-user-test'
test ALL=(ALL) NOPASSWD:ALL
+ . snappy-qa-jobs/scripts/utils/register_device.sh 10.101.50.183 22 test ubuntu sergiocazzolato@yahoo.com.ar
++ echo 'Register device'
Register device
++ '[' 5 -ne 5 ']'
++ DEVICE_IP=10.101.50.183
++ DEVICE_PORT=22
++ USER=test
++ PASS=ubuntu
++ EMAIL=sergiocazzolato@yahoo.com.ar
++ SCRIPT='sudo snap create-user sergiocazzolato@yahoo.com.ar ||         ( sudo snap install jq;         sudo cp /var/lib/snapd/state.json /var/lib/snapd/state.json.bak;         sudo cat /var/lib/snapd/state.json.bak | jq -r '\''.data.auth.users=[]'\'' | sudo tee /var/lib/snapd/state.json > /dev/null;         sudo systemctl stop snapd.service snapd.socket;         sudo systemctl start snapd.service snapd.socket;         sudo snap create-user sergiocazzolato@yahoo.com.ar;         sudo snap remove jq )'
++ '[' -z sergiocazzolato@yahoo.com.ar ']'
++ '[' -z ubuntu ']'
++ echo 'Registering device (with pass): sudo snap create-user sergiocazzolato@yahoo.com.ar ||         ( sudo snap install jq;         sudo cp /var/lib/snapd/state.json /var/lib/snapd/state.json.bak;         sudo cat /var/lib/snapd/state.json.bak | jq -r '\''.data.auth.users=[]'\'' | sudo tee /var/lib/snapd/state.json > /dev/null;         sudo systemctl stop snapd.service snapd.socket;         sudo systemctl start snapd.service snapd.socket;         sudo snap create-user sergiocazzolato@yahoo.com.ar;         sudo snap remove jq )'
Registering device (with pass): sudo snap create-user sergiocazzolato@yahoo.com.ar ||         ( sudo snap install jq;         sudo cp /var/lib/snapd/state.json /var/lib/snapd/state.json.bak;         sudo cat /var/lib/snapd/state.json.bak | jq -r '.data.auth.users=[]' | sudo tee /var/lib/snapd/state.json > /dev/null;         sudo systemctl stop snapd.service snapd.socket;         sudo systemctl start snapd.service snapd.socket;         sudo snap create-user sergiocazzolato@yahoo.com.ar;         sudo snap remove jq )
++ sshpass -p ubuntu ssh -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no -p 22 test@10.101.50.183 'sudo snap create-user sergiocazzolato@yahoo.com.ar ||         ( sudo snap install jq;         sudo cp /var/lib/snapd/state.json /var/lib/snapd/state.json.bak;         sudo cat /var/lib/snapd/state.json.bak | jq -r '\''.data.auth.users=[]'\'' | sudo tee /var/lib/snapd/state.json > /dev/null;         sudo systemctl stop snapd.service snapd.socket;         sudo systemctl start snapd.service snapd.socket;         sudo snap create-user sergiocazzolato@yahoo.com.ar;         sudo snap remove jq )'
Warning: Permanently added '10.101.50.183' (ECDSA) to the list of known hosts.
created user "snappytestaccount1"
+ . snappy-qa-jobs/scripts/utils/refresh_core.sh 10.101.50.183 22 test ubuntu stable edge
++ echo 'Refresh core on device'
Refresh core on device
++ '[' 6 -ne 6 ']'
++ DEVICE_IP=10.101.50.183
++ DEVICE_PORT=22
++ USER=test
++ PASS=ubuntu
++ CHANNEL=stable
++ CORE_CHANNEL=edge
++ execute_remote 'snap changes'
++ '[' -z ubuntu ']'
++ grep -q -E 'Doing.*Auto-refresh snap "core"'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.50.183 'snap changes'
++ '[' -z edge ']'
++ '[' stable = edge ']'
++ execute_remote 'rm -f /tmp/refresh.log'
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.50.183 'rm -f /tmp/refresh.log'
++ execute_remote 'sudo snap refresh --edge core > /tmp/refresh.log  2>&1 &'
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.50.183 'sudo snap refresh --edge core > /tmp/refresh.log  2>&1 &'
++ rebooted=0
++ true
+++ execute_remote 'cat /tmp/refresh.log'
+++ '[' -z ubuntu ']'
+++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.50.183 'cat /tmp/refresh.log'
++ output=
++ case "$output" in
++ execute_remote 'tail -n 1 /tmp/refresh.log'
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.50.183 'tail -n 1 /tmp/refresh.log'
++ sleep 10
++ true
+++ execute_remote 'cat /tmp/refresh.log'
+++ '[' -z ubuntu ']'
+++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.50.183 'cat /tmp/refresh.log'
++ output=
++ case "$output" in
++ execute_remote 'tail -n 1 /tmp/refresh.log'
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.50.183 'tail -n 1 /tmp/refresh.log'
++ sleep 10
++ true
+++ execute_remote 'cat /tmp/refresh.log'
+++ '[' -z ubuntu ']'
+++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.50.183 'cat /tmp/refresh.log'
++ output=
++ case "$output" in
++ execute_remote 'tail -n 1 /tmp/refresh.log'
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.50.183 'tail -n 1 /tmp/refresh.log'
++ sleep 10
++ true
+++ execute_remote 'cat /tmp/refresh.log'
+++ '[' -z ubuntu ']'
+++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.50.183 'cat /tmp/refresh.log'
++ output=
++ case "$output" in
++ execute_remote 'tail -n 1 /tmp/refresh.log'
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.50.183 'tail -n 1 /tmp/refresh.log'
++ sleep 10
++ true
+++ execute_remote 'cat /tmp/refresh.log'
+++ '[' -z ubuntu ']'
+++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.50.183 'cat /tmp/refresh.log'
++ output=
++ case "$output" in
++ execute_remote 'tail -n 1 /tmp/refresh.log'
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.50.183 'tail -n 1 /tmp/refresh.log'
++ sleep 10
++ true
+++ execute_remote 'cat /tmp/refresh.log'
+++ '[' -z ubuntu ']'
+++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.50.183 'cat /tmp/refresh.log'
++ output=
++ case "$output" in
++ execute_remote 'tail -n 1 /tmp/refresh.log'
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.50.183 'tail -n 1 /tmp/refresh.log'
++ sleep 10
++ true
+++ execute_remote 'cat /tmp/refresh.log'
+++ '[' -z ubuntu ']'
+++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.50.183 'cat /tmp/refresh.log'
++ output=
++ case "$output" in
++ execute_remote 'tail -n 1 /tmp/refresh.log'
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.50.183 'tail -n 1 /tmp/refresh.log'
++ sleep 10
++ true
+++ execute_remote 'cat /tmp/refresh.log'
+++ '[' -z ubuntu ']'
+++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.50.183 'cat /tmp/refresh.log'
++ output=
++ case "$output" in
++ execute_remote 'tail -n 1 /tmp/refresh.log'
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.50.183 'tail -n 1 /tmp/refresh.log'
++ sleep 10
++ true
+++ execute_remote 'cat /tmp/refresh.log'
+++ '[' -z ubuntu ']'
+++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.50.183 'cat /tmp/refresh.log'
++ output='2018-05-24T10:20:56Z INFO Waiting for restart...'
++ case "$output" in
++ echo 'Already waiting for restart, forcing reboot ...'
Already waiting for restart, forcing reboot ...
++ execute_remote 'sudo reboot'
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.50.183 'sudo reboot'
Connection to 10.101.50.183 closed by remote host.
++ true
++ rebooted=1
++ break
++ '[' 1 = 1 ']'
++ wait_for_ssh 120 2
++ retries=120
++ sleep=2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.50.183 true
++ retries=119
++ '[' 119 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.50.183 true
++ retries=118
++ '[' 118 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.50.183 true
++ retries=117
++ '[' 117 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.50.183 true
++ retries=116
++ '[' 116 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.50.183 true
++ retries=115
++ '[' 115 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.50.183 true
++ retries=114
++ '[' 114 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.50.183 true
++ retries=113
++ '[' 113 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.50.183 true
++ retries=112
++ '[' 112 -le 0 ']'
++ sleep 2
++ execute_remote true
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.50.183 true
++ retry_until 'snap changes' 'Done.*Refresh "core" snap from "edge" channel' 120 2
++ command='snap changes'
++ output='Done.*Refresh "core" snap from "edge" channel'
++ retries=120
++ sleep=2
++ execute_remote 'snap changes'
++ '[' -z ubuntu ']'
++ grep -q -E 'Done.*Refresh "core" snap from "edge" channel'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.50.183 'snap changes'
++ retry_until 'snap info core' 'tracking: +edge' 10 2
++ command='snap info core'
++ output='tracking: +edge'
++ retries=10
++ sleep=2
++ execute_remote 'snap info core'
++ grep -q -E 'tracking: +edge'
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.50.183 'snap info core'
++ retry_until 'sudo snap install --devmode jq' 'jq .* installed' 20 10
++ command='sudo snap install --devmode jq'
++ output='jq .* installed'
++ retries=20
++ sleep=10
++ execute_remote 'sudo snap install --devmode jq'
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.50.183 'sudo snap install --devmode jq'
++ grep -q -E 'jq .* installed'
++ execute_remote 'sudo snap remove jq'
++ '[' -z ubuntu ']'
++ sshpass -p ubuntu ssh -p 22 -q -o ConnectTimeout=10 -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no test@10.101.50.183 'sudo snap remove jq'
jq removed
+ . snappy-qa-jobs/scripts/utils/run_setup.sh 10.101.50.183 22 test ubuntu ''
++ echo 'Running setup command'
Running setup command
++ '[' 5 -ne 5 ']'
++ DEVICE_IP=10.101.50.183
++ DEVICE_PORT=22
++ USER=test
++ PASS=ubuntu
++ SETUP=
++ '[' -z '' ']'
++ echo 'No setup command to run'
No setup command to run
+ . snappy-qa-jobs/scripts/utils/get_spread.sh
++ echo 'Getting spread'
Getting spread
+++ pwd
++ export WORKSPACE=/home/ubuntu
++ WORKSPACE=/home/ubuntu
++ export SPREAD_DIR=/home/ubuntu/spread
++ SPREAD_DIR=/home/ubuntu/spread
++ export PATH=/home/ubuntu/spread:/srv/testflinger-agent/cm3002/env/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
++ PATH=/home/ubuntu/spread:/srv/testflinger-agent/cm3002/env/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin
++ '[' -f /home/ubuntu/spread/spread ']'
++ mkdir -p /home/ubuntu/spread
++ cd /home/ubuntu/spread
++ curl -s -O https://niemeyer.s3.amazonaws.com/spread-amd64.tar.gz
++ tar xzvf spread-amd64.tar.gz
spread
++ echo 'Spread downloaded and ready to use'
Spread downloaded and ready to use
+ . snappy-qa-jobs/scripts/utils/run_spread.sh 10.101.50.183 22 snapd external:ubuntu-core-16-arm-32:tests/ '' tests/main/auto-refresh,tests/main/interfaces-content -v
++ echo 'Running spread'
Running spread
++ '[' 7 -ne 7 ']'
++ export WORKSPACE=/home/ubuntu
++ WORKSPACE=/home/ubuntu
++ DEVICE_IP=10.101.50.183
++ DEVICE_PORT=22
++ PROJECT_PATH=snapd
++ SPREAD_TESTS=external:ubuntu-core-16-arm-32:tests/
++ SPREAD_ENV=
++ SKIP_TESTS=tests/main/auto-refresh,tests/main/interfaces-content
++ SPREAD_PARAMS=-v
++ '[' -z external:ubuntu-core-16-arm-32:tests/ ']'
++ '[' '!' -z '' ']'
++ export SPREAD_EXTERNAL_ADDRESS=10.101.50.183:22
++ SPREAD_EXTERNAL_ADDRESS=10.101.50.183:22
+++ which spread
++ [[ -n /home/ubuntu/spread/spread ]]
++ echo 'Spread found'
Spread found
++ cd snapd
++ echo 'Moving to manual all the tests to skip: tests/main/auto-refresh,tests/main/interfaces-content'
Moving to manual all the tests to skip: tests/main/auto-refresh,tests/main/interfaces-content
+++ echo tests/main/auto-refresh,tests/main/interfaces-content
+++ tr , ' '
++ tests_skip='tests/main/auto-refresh tests/main/interfaces-content'
++ for test in '$tests_skip'
++ '[' -f tests/main/auto-refresh/task.yaml ']'
++ cp tests/main/auto-refresh/task.yaml tests/main/auto-refresh/task.yaml.back
++ echo 'manual: true'
++ for test in '$tests_skip'
++ '[' -f tests/main/interfaces-content/task.yaml ']'
++ cp tests/main/interfaces-content/task.yaml tests/main/interfaces-content/task.yaml.back
++ echo 'manual: true'
+++ echo -v
+++ tr , ' '
++ spread_params=-v
++ echo 'Running command: spread -v external:ubuntu-core-16-arm-32:tests/'
Running command: spread -v external:ubuntu-core-16-arm-32:tests/
++ spread -v external:ubuntu-core-16-arm-32:tests/
2018-05-24 10:21:07 Found /home/ubuntu/snapd/spread.yaml.
2018-05-24 10:21:10 Project content is packed for delivery (2.78MB).
2018-05-24 10:21:10 Sequence of jobs produced with -seed=1527157270
2018-05-24 10:21:10 If killed, discard servers with: spread -reuse-pid=898 -discard
2018-05-24 10:21:10 Allocating external:ubuntu-core-16-arm-32...
2018-05-24 10:21:10 Waiting for external:ubuntu-core-16-arm-32 to make SSH available at 10.101.50.183:22...
2018-05-24 10:21:10 Allocated external:ubuntu-core-16-arm-32.
2018-05-24 10:21:10 Connecting to external:ubuntu-core-16-arm-32...
2018-05-24 10:21:10 Connected to external:ubuntu-core-16-arm-32 at 10.101.50.183:22.
2018-05-24 10:21:10 Sending project content to external:ubuntu-core-16-arm-32...
2018-05-24 10:21:11 Preparing external:ubuntu-core-16-arm-32...
2018-05-24 10:21:12 Preparing external:ubuntu-core-16-arm-32:tests/main/...
2018-05-24 10:22:07 Preparing external:ubuntu-core-16-arm-32:tests/main/interfaces-broadcom-asic-control...
2018-05-24 10:22:51 Executing external:ubuntu-core-16-arm-32:tests/main/interfaces-broadcom-asic-control (1/191)...
2018-05-24 10:22:57 Restoring external:ubuntu-core-16-arm-32:tests/main/interfaces-broadcom-asic-control...
2018-05-24 10:22:58 Preparing external:ubuntu-core-16-arm-32:tests/main/ubuntu-core-reboot...
2018-05-24 10:23:47 Executing external:ubuntu-core-16-arm-32:tests/main/ubuntu-core-reboot (2/191)...
2018-05-24 10:23:47 Rebooting on external:ubuntu-core-16-arm-32 (external:ubuntu-core-16-arm-32:tests/main/ubuntu-core-reboot) as requested...
2018-05-24 10:24:29 Restoring external:ubuntu-core-16-arm-32:tests/main/ubuntu-core-reboot...
2018-05-24 10:24:29 Preparing external:ubuntu-core-16-arm-32:tests/main/ubuntu-core-upgrade...
2018-05-24 10:25:33 Executing external:ubuntu-core-16-arm-32:tests/main/ubuntu-core-upgrade (3/191)...
2018-05-24 10:25:53 Rebooting on external:ubuntu-core-16-arm-32 (external:ubuntu-core-16-arm-32:tests/main/ubuntu-core-upgrade) as requested...
2018-05-24 10:28:11 Rebooting on external:ubuntu-core-16-arm-32 (external:ubuntu-core-16-arm-32:tests/main/ubuntu-core-upgrade) as requested...
2018-05-24 10:30:41 Rebooting on external:ubuntu-core-16-arm-32 (external:ubuntu-core-16-arm-32:tests/main/ubuntu-core-upgrade) as requested...
2018-05-24 10:33:00 Rebooting on external:ubuntu-core-16-arm-32 (external:ubuntu-core-16-arm-32:tests/main/ubuntu-core-upgrade) as requested...
2018-05-24 10:35:12 Restoring external:ubuntu-core-16-arm-32:tests/main/ubuntu-core-upgrade...
2018-05-24 10:35:12 Preparing external:ubuntu-core-16-arm-32:tests/main/failover:rclocalcrash...
2018-05-24 10:35:55 Executing external:ubuntu-core-16-arm-32:tests/main/failover:rclocalcrash (4/191)...
2018-05-24 10:38:09 Rebooting on external:ubuntu-core-16-arm-32 (external:ubuntu-core-16-arm-32:tests/main/failover:rclocalcrash) as requested...
2018-05-24 10:40:48 Restoring external:ubuntu-core-16-arm-32:tests/main/failover:rclocalcrash...
2018-05-24 10:40:49 Preparing external:ubuntu-core-16-arm-32:tests/main/failover:emptysystemd...
2018-05-24 10:41:28 Executing external:ubuntu-core-16-arm-32:tests/main/failover:emptysystemd (5/191)...
2018-05-24 10:43:45 Rebooting on external:ubuntu-core-16-arm-32 (external:ubuntu-core-16-arm-32:tests/main/failover:emptysystemd) as requested...
2018-05-24 10:46:14 Restoring external:ubuntu-core-16-arm-32:tests/main/failover:emptysystemd...
2018-05-24 10:46:16 Preparing external:ubuntu-core-16-arm-32:tests/main/install-sideload:reexec0...
2018-05-24 10:46:56 Executing external:ubuntu-core-16-arm-32:tests/main/install-sideload:reexec0 (6/191)...
2018-05-24 10:47:52 Restoring external:ubuntu-core-16-arm-32:tests/main/install-sideload:reexec0...
2018-05-24 10:47:52 Preparing external:ubuntu-core-16-arm-32:tests/main/interfaces-ssh-public-keys...
2018-05-24 10:48:50 Executing external:ubuntu-core-16-arm-32:tests/main/interfaces-ssh-public-keys (7/191)...
2018-05-24 10:48:54 Restoring external:ubuntu-core-16-arm-32:tests/main/interfaces-ssh-public-keys...
2018-05-24 10:48:54 Preparing external:ubuntu-core-16-arm-32:tests/main/interfaces-network-observe...
2018-05-24 10:49:32 Executing external:ubuntu-core-16-arm-32:tests/main/interfaces-network-observe (8/191)...
2018-05-24 10:49:37 Restoring external:ubuntu-core-16-arm-32:tests/main/interfaces-network-observe...
2018-05-24 10:49:38 Preparing external:ubuntu-core-16-arm-32:tests/main/listing...
2018-05-24 10:50:19 Executing external:ubuntu-core-16-arm-32:tests/main/listing (9/191)...
2018-05-24 10:50:30 Restoring external:ubuntu-core-16-arm-32:tests/main/listing...
2018-05-24 10:50:31 Preparing external:ubuntu-core-16-arm-32:tests/main/cgroup-freezer...
2018-05-24 10:51:10 Executing external:ubuntu-core-16-arm-32:tests/main/cgroup-freezer (10/191)...
2018-05-24 10:51:12 Restoring external:ubuntu-core-16-arm-32:tests/main/cgroup-freezer...
2018-05-24 10:51:12 Preparing external:ubuntu-core-16-arm-32:tests/main/interfaces-content-mimic...
2018-05-24 10:51:53 Executing external:ubuntu-core-16-arm-32:tests/main/interfaces-content-mimic (11/191)...
2018-05-24 10:52:01 Restoring external:ubuntu-core-16-arm-32:tests/main/interfaces-content-mimic...
2018-05-24 10:52:02 Preparing external:ubuntu-core-16-arm-32:tests/main/interfaces-hardware-random-control...
2018-05-24 10:52:45 Executing external:ubuntu-core-16-arm-32:tests/main/interfaces-hardware-random-control (12/191)...
2018-05-24 10:52:52 Restoring external:ubuntu-core-16-arm-32:tests/main/interfaces-hardware-random-control...
2018-05-24 10:52:52 Preparing external:ubuntu-core-16-arm-32:tests/main/snap-env...
2018-05-24 10:53:34 Executing external:ubuntu-core-16-arm-32:tests/main/snap-env (13/191)...
2018-05-24 10:53:35 Restoring external:ubuntu-core-16-arm-32:tests/main/snap-env...
2018-05-24 10:53:36 Preparing external:ubuntu-core-16-arm-32:tests/main/interfaces-timezone-control...
2018-05-24 10:54:19 Executing external:ubuntu-core-16-arm-32:tests/main/interfaces-timezone-control (14/191)...
2018-05-24 10:54:25 Restoring external:ubuntu-core-16-arm-32:tests/main/interfaces-timezone-control...
2018-05-24 10:54:25 Preparing external:ubuntu-core-16-arm-32:tests/main/interfaces-locale-control...
2018-05-24 10:54:51 Executing external:ubuntu-core-16-arm-32:tests/main/interfaces-locale-control (15/191)...
2018-05-24 10:54:51 Restoring external:ubuntu-core-16-arm-32:tests/main/interfaces-locale-control...
2018-05-24 10:54:52 Preparing external:ubuntu-core-16-arm-32:tests/main/try-snap-goes-away:test_snapd_tools...
2018-05-24 10:55:19 Executing external:ubuntu-core-16-arm-32:tests/main/try-snap-goes-away:test_snapd_tools (16/191)...
2018-05-24 10:55:39 Restoring external:ubuntu-core-16-arm-32:tests/main/try-snap-goes-away:test_snapd_tools...
2018-05-24 10:55:39 Preparing external:ubuntu-core-16-arm-32:tests/main/interfaces-removable-media...
2018-05-24 10:56:14 Executing external:ubuntu-core-16-arm-32:tests/main/interfaces-removable-media (17/191)...
2018-05-24 10:56:20 Restoring external:ubuntu-core-16-arm-32:tests/main/interfaces-removable-media...
2018-05-24 10:56:21 Preparing external:ubuntu-core-16-arm-32:tests/main/snap-info...
2018-05-24 10:57:12 Executing external:ubuntu-core-16-arm-32:tests/main/snap-info (18/191)...
2018-05-24 10:57:25 Restoring external:ubuntu-core-16-arm-32:tests/main/snap-info...
2018-05-24 10:57:25 Preparing external:ubuntu-core-16-arm-32:tests/main/interfaces-framebuffer...
2018-05-24 10:58:10 Executing external:ubuntu-core-16-arm-32:tests/main/interfaces-framebuffer (19/191)...
2018-05-24 10:58:15 Restoring external:ubuntu-core-16-arm-32:tests/main/interfaces-framebuffer...
2018-05-24 10:58:16 Preparing external:ubuntu-core-16-arm-32:tests/main/systemd-service...
2018-05-24 10:58:46 Executing external:ubuntu-core-16-arm-32:tests/main/systemd-service (20/191)...
2018-05-24 10:58:57 Restoring external:ubuntu-core-16-arm-32:tests/main/systemd-service...
2018-05-24 10:58:58 Preparing external:ubuntu-core-16-arm-32:tests/main/remove-errors...
2018-05-24 10:59:25 Executing external:ubuntu-core-16-arm-32:tests/main/remove-errors (21/191)...
2018-05-24 10:59:42 Restoring external:ubuntu-core-16-arm-32:tests/main/remove-errors...
2018-05-24 10:59:42 Preparing external:ubuntu-core-16-arm-32:tests/main/install-remove-multi...
2018-05-24 11:00:09 Executing external:ubuntu-core-16-arm-32:tests/main/install-remove-multi (22/191)...
2018-05-24 11:00:45 Restoring external:ubuntu-core-16-arm-32:tests/main/install-remove-multi...
2018-05-24 11:00:46 Preparing external:ubuntu-core-16-arm-32:tests/main/snap-wait...
2018-05-24 11:01:21 Executing external:ubuntu-core-16-arm-32:tests/main/snap-wait (23/191)...
2018-05-24 11:01:26 Restoring external:ubuntu-core-16-arm-32:tests/main/snap-wait...
2018-05-24 11:01:26 Preparing external:ubuntu-core-16-arm-32:tests/main/searching...
2018-05-24 11:01:53 Executing external:ubuntu-core-16-arm-32:tests/main/searching (24/191)...
2018-05-24 11:02:00 Restoring external:ubuntu-core-16-arm-32:tests/main/searching...
2018-05-24 11:02:00 Preparing external:ubuntu-core-16-arm-32:tests/main/install-closed-channel...
2018-05-24 11:02:23 Executing external:ubuntu-core-16-arm-32:tests/main/install-closed-channel (25/191)...
2018-05-24 11:02:42 Restoring external:ubuntu-core-16-arm-32:tests/main/install-closed-channel...
2018-05-24 11:02:42 Preparing external:ubuntu-core-16-arm-32:tests/main/revert-devmode:remote...
2018-05-24 11:03:27 Executing external:ubuntu-core-16-arm-32:tests/main/revert-devmode:remote (26/191)...
2018-05-24 11:04:13 Restoring external:ubuntu-core-16-arm-32:tests/main/revert-devmode:remote...
2018-05-24 11:04:13 Preparing external:ubuntu-core-16-arm-32:tests/main/interfaces-kvm...
2018-05-24 11:04:54 Executing external:ubuntu-core-16-arm-32:tests/main/interfaces-kvm (27/191)...
2018-05-24 11:05:00 Restoring external:ubuntu-core-16-arm-32:tests/main/interfaces-kvm...
2018-05-24 11:05:00 Preparing external:ubuntu-core-16-arm-32:tests/main/known...
2018-05-24 11:05:29 Executing external:ubuntu-core-16-arm-32:tests/main/known (28/191)...
2018-05-24 11:05:30 Restoring external:ubuntu-core-16-arm-32:tests/main/known...
2018-05-24 11:05:30 Preparing external:ubuntu-core-16-arm-32:tests/main/snap-disconnect...
2018-05-24 11:06:10 Executing external:ubuntu-core-16-arm-32:tests/main/snap-disconnect (29/191)...
2018-05-24 11:06:31 Restoring external:ubuntu-core-16-arm-32:tests/main/snap-disconnect...
2018-05-24 11:06:32 Preparing external:ubuntu-core-16-arm-32:tests/main/ubuntu-core-create-user...
2018-05-24 11:06:58 Executing external:ubuntu-core-16-arm-32:tests/main/ubuntu-core-create-user (30/191)...
2018-05-24 11:06:58 Restoring external:ubuntu-core-16-arm-32:tests/main/ubuntu-core-create-user...
2018-05-24 11:06:58 Preparing external:ubuntu-core-16-arm-32:tests/main/base-snaps...
2018-05-24 11:07:26 Executing external:ubuntu-core-16-arm-32:tests/main/base-snaps (31/191)...
2018-05-24 11:07:40 Restoring external:ubuntu-core-16-arm-32:tests/main/base-snaps...
2018-05-24 11:07:40 Preparing external:ubuntu-core-16-arm-32:tests/main/revert-sideload...
2018-05-24 11:08:13 Executing external:ubuntu-core-16-arm-32:tests/main/revert-sideload (32/191)...
2018-05-24 11:08:29 Restoring external:ubuntu-core-16-arm-32:tests/main/revert-sideload...
2018-05-24 11:08:29 Preparing external:ubuntu-core-16-arm-32:tests/main/interfaces-gpg-public-keys...
2018-05-24 11:09:09 Executing external:ubuntu-core-16-arm-32:tests/main/interfaces-gpg-public-keys (33/191)...
2018-05-24 11:09:15 Restoring external:ubuntu-core-16-arm-32:tests/main/interfaces-gpg-public-keys...
2018-05-24 11:09:15 Preparing external:ubuntu-core-16-arm-32:tests/main/refresh:strict_remote...
2018-05-24 11:10:01 Executing external:ubuntu-core-16-arm-32:tests/main/refresh:strict_remote (34/191)...
2018-05-24 11:10:42 Restoring external:ubuntu-core-16-arm-32:tests/main/refresh:strict_remote...
2018-05-24 11:10:42 Preparing external:ubuntu-core-16-arm-32:tests/main/snap-service-stop-mode...
2018-05-24 11:11:17 Executing external:ubuntu-core-16-arm-32:tests/main/snap-service-stop-mode (35/191)...
2018-05-24 11:13:38 Restoring external:ubuntu-core-16-arm-32:tests/main/snap-service-stop-mode...
2018-05-24 11:13:38 Preparing external:ubuntu-core-16-arm-32:tests/main/regression-home-snap-root-owned...
2018-05-24 11:14:19 Executing external:ubuntu-core-16-arm-32:tests/main/regression-home-snap-root-owned (36/191)...
2018-05-24 11:14:20 Restoring external:ubuntu-core-16-arm-32:tests/main/regression-home-snap-root-owned...
2018-05-24 11:14:20 Preparing external:ubuntu-core-16-arm-32:tests/main/snap-run-symlink-error...
2018-05-24 11:14:47 Executing external:ubuntu-core-16-arm-32:tests/main/snap-run-symlink-error (37/191)...
2018-05-24 11:14:48 Restoring external:ubuntu-core-16-arm-32:tests/main/snap-run-symlink-error...
2018-05-24 11:14:48 Preparing external:ubuntu-core-16-arm-32:tests/main/snap-remove-not-mounted...
2018-05-24 11:15:14 Executing external:ubuntu-core-16-arm-32:tests/main/snap-remove-not-mounted (38/191)...
2018-05-24 11:15:32 Restoring external:ubuntu-core-16-arm-32:tests/main/snap-remove-not-mounted...
2018-05-24 11:15:33 Preparing external:ubuntu-core-16-arm-32:tests/main/security-setuid-root...
2018-05-24 11:16:12 Executing external:ubuntu-core-16-arm-32:tests/main/security-setuid-root (39/191)...
2018-05-24 11:16:13 Restoring external:ubuntu-core-16-arm-32:tests/main/security-setuid-root...
2018-05-24 11:16:13 Preparing external:ubuntu-core-16-arm-32:tests/main/install-sideload:reexec1...
2018-05-24 11:16:43 Executing external:ubuntu-core-16-arm-32:tests/main/install-sideload:reexec1 (40/191)...
2018-05-24 11:17:39 Restoring external:ubuntu-core-16-arm-32:tests/main/install-sideload:reexec1...
2018-05-24 11:17:40 Preparing external:ubuntu-core-16-arm-32:tests/main/layout...
2018-05-24 11:18:34 Executing external:ubuntu-core-16-arm-32:tests/main/layout (41/191)...
2018-05-24 11:18:40 Error executing external:ubuntu-core-16-arm-32:tests/main/layout : 
-----
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/snaps.sh
++ seq 2
+ for i in '$(seq 2)'
+ '[' 1 -eq 2 ']'
+ echo 'snap declaring layouts doesn'\''t explode on startup'
snap declaring layouts doesn't explode on startup
+ test-snapd-layout.sh -c true
+ echo 'layout declarations are honored'
layout declarations are honored
+ test-snapd-layout.sh -c 'test -d /etc/demo'
+ test-snapd-layout.sh -c 'test -f /etc/demo.conf'
+ test-snapd-layout.sh -c 'test -h /etc/demo.cfg'
++ test-snapd-layout.sh -c 'readlink /etc/demo.cfg'
++ test-snapd-layout.sh -c 'echo $SNAP_COMMON/etc/demo.conf'
+ test /var/snap/test-snapd-layout/common/etc/demo.conf = /var/snap/test-snapd-layout/common/etc/demo.conf
+ test-snapd-layout.sh -c 'test -d /usr/share/demo'
+ test-snapd-layout.sh -c 'test -d /var/lib/demo'
+ test-snapd-layout.sh -c 'test -d /var/cache/demo'
+ test-snapd-layout.sh -c 'test -d /opt/demo'
+ test-snapd-layout.sh -c 'test -d /bin/very-weird-place'
+ echo 'layout constructed a mimic using tmpfs as aid (/opt)'
layout constructed a mimic using tmpfs as aid (/opt)
++ test-snapd-layout.sh -c 'stat -f /opt -c '\''%T'\'''
+ '[' tmpfs = tmpfs ']'
+ echo 'and the tmpfs was mounted with 0755 and root/root user/group to mimic /opt in core'
and the tmpfs was mounted with 0755 and root/root user/group to mimic /opt in core
++ test-snapd-layout.sh -c 'stat /opt -c '\''%a'\'''
+ '[' 755 = 755 ']'
++ test-snapd-layout.sh -c 'stat /opt -c '\''%u'\'''
+ '[' 0 = 0 ']'
++ test-snapd-layout.sh -c 'stat /opt -c '\''%g'\'''
+ '[' 0 = 0 ']'
+ echo 'layout constructed a mimic using tmpfs as aid (/var/spool/rsyslog)'
layout constructed a mimic using tmpfs as aid (/var/spool/rsyslog)
++ test-snapd-layout.sh -c 'stat -f /var/spool/rsyslog -c '\''%T'\'''
+ '[' tmpfs = tmpfs ']'
+ echo 'and the tmpfs was mounted with 0700 and syslog/adm user/group to mimic /var/spool/rsyslog in core'
and the tmpfs was mounted with 0700 and syslog/adm user/group to mimic /var/spool/rsyslog in core
++ test-snapd-layout.sh -c 'stat /var/spool/rsyslog -c '\''%a'\'''
+ '[' 700 = 700 ']'
++ test-snapd-layout.sh -c 'stat /var/spool/rsyslog -c '\''%u'\'''
+ '[' 108 = 108 ']'
++ test-snapd-layout.sh -c 'stat /var/spool/rsyslog -c '\''%g'\'''
+ '[' 4 = 4 ']'
+ echo 'layout locations pointing to SNAP_DATA and SNAP_COMMON are writable'
layout locations pointing to SNAP_DATA and SNAP_COMMON are writable
+ echo 'and the writes go to the right place in the backing store'
and the writes go to the right place in the backing store
+ test-snapd-layout.sh -c 'echo foo-1 > /etc/demo/writable'
++ test-snapd-layout.sh -c 'cat $SNAP_COMMON/etc/demo/writable'
+ test foo-1 = foo-1
+ test-snapd-layout.sh -c 'echo foo-2 > /etc/demo.conf'
++ test-snapd-layout.sh -c 'cat $SNAP_COMMON/etc/demo.conf'
+ test foo-2 = foo-2
+ test-snapd-layout.sh -c 'echo foo-3 > /etc/demo.cfg'
++ test-snapd-layout.sh -c 'cat $SNAP_COMMON/etc/demo.conf'
+ test foo-3 = foo-3
+ test-snapd-layout.sh -c 'echo foo-4 > /var/lib/demo/writable'
++ test-snapd-layout.sh -c 'cat $SNAP_DATA/var/lib/demo/writable'
+ test foo-4 = foo-4
+ test-snapd-layout.sh -c 'echo foo-5 > /var/cache/demo/writable'
++ test-snapd-layout.sh -c 'cat $SNAP_DATA/var/cache/demo/writable'
+ test foo-5 = foo-5
+ echo 'layout locations pointing to SNAP are readable'
layout locations pointing to SNAP are readable
+ test-snapd-layout.sh -c 'test -r /usr/share/demo/file'
-----
.
2018-05-24 11:18:40 Debug output for external:ubuntu-core-16-arm-32:tests/main/layout : 
-----
+ ls -ld /etc
drwxr-xr-x 78 root root 2363 May 24 10:04 /etc
+ ls -ld /etc/demo
ls: cannot access '/etc/demo': No such file or directory
+ :
+ ls -ld /etc/demo.conf
ls: cannot access '/etc/demo.conf': No such file or directory
+ :
+ ls -ld /etc/demo.cfg
ls: cannot access '/etc/demo.cfg': No such file or directory
+ :
+ '[' 1 = 1 ']'
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/journalctl.sh
++ JOURNALCTL_CURSOR_FILE=/home/gopath/src/github.com/snapcore/snapd/journalctl_cursor
+ echo '# journal messages for snapd'
# journal messages for snapd
+ get_journalctl_log -u snapd
++ cat /home/gopath/src/github.com/snapcore/snapd/journalctl_cursor
+ cursor='s=331bffc4d04d44aab50347ed0d1b2ef0;i=1aa8;b=519dc86b29df480584c08fa9ec009843;m=721e776a;t=56cf1cfc09207;x=19b7e7e0c3640a4c'
+ get_journalctl_log_from_cursor 's=331bffc4d04d44aab50347ed0d1b2ef0;i=1aa8;b=519dc86b29df480584c08fa9ec009843;m=721e776a;t=56cf1cfc09207;x=19b7e7e0c3640a4c' -u snapd
+ cursor='s=331bffc4d04d44aab50347ed0d1b2ef0;i=1aa8;b=519dc86b29df480584c08fa9ec009843;m=721e776a;t=56cf1cfc09207;x=19b7e7e0c3640a4c'
+ shift
+ journalctl -u snapd --cursor 's=331bffc4d04d44aab50347ed0d1b2ef0;i=1aa8;b=519dc86b29df480584c08fa9ec009843;m=721e776a;t=56cf1cfc09207;x=19b7e7e0c3640a4c'
-- Logs begin at Thu 2018-05-24 10:28:12 UTC, end at Thu 2018-05-24 11:19:31 UTC. --
May 24 11:18:32 localhost.localdomain snapd[23015]: 2018/05/24 11:18:32.390253 daemon.go:272: DEBUG: pid=24630;uid=0;socket=/run/snapd.socket;@ GET /v2/snaps 23.197612ms 200
May 24 11:18:32 localhost.localdomain snapd[23015]: 2018/05/24 11:18:32.517698 daemon.go:272: DEBUG: pid=24639;uid=0;socket=/run/snapd.socket;@ GET /v2/snaps 23.04553ms 200
May 24 11:18:32 localhost.localdomain snapd[23015]: 2018/05/24 11:18:32.688766 daemon.go:272: DEBUG: pid=24650;uid=0;socket=/run/snapd.socket;@ POST /v2/snaps/basic 65.449634ms 202
May 24 11:18:32 localhost.localdomain snapd[23015]: 2018/05/24 11:18:32.695143 taskrunner.go:403: DEBUG: Running task 244 on Do: Stop snap "basic" services
May 24 11:18:32 localhost.localdomain snapd[23015]: 2018/05/24 11:18:32.808530 taskrunner.go:403: DEBUG: Running task 243 on Do: Run remove hook of "basic" snap if present
May 24 11:18:32 localhost.localdomain snapd[23015]: 2018/05/24 11:18:32.950014 taskrunner.go:403: DEBUG: Running task 245 on Do: Remove aliases for snap "basic"
May 24 11:18:33 localhost.localdomain snapd[23015]: 2018/05/24 11:18:33.280738 taskrunner.go:403: DEBUG: Running task 246 on Do: Make snap "basic" unavailable to the system
May 24 11:18:33 localhost.localdomain snapd[23015]: 2018/05/24 11:18:33.693057 taskrunner.go:403: DEBUG: Running task 247 on Do: Remove security profile for snap "basic" (x1)
May 24 11:18:34 localhost.localdomain snapd[23015]: 2018/05/24 11:18:34.113351 taskrunner.go:403: DEBUG: Running task 248 on Do: Remove data for snap "basic" (x1)
May 24 11:18:34 localhost.localdomain snapd[23015]: 2018/05/24 11:18:34.325925 taskrunner.go:403: DEBUG: Running task 249 on Do: Remove snap "basic" (x1) from the system
May 24 11:18:36 localhost.localdomain snapd[23015]: 2018/05/24 11:18:36.245466 taskrunner.go:403: DEBUG: Running task 250 on Do: Discard interface connections for snap "basic" (x1)
May 24 11:18:36 localhost.localdomain snapd[23015]: 2018/05/24 11:18:36.631330 daemon.go:272: DEBUG: pid=24705;uid=0;socket=/run/snapd.socket;@ POST /v2/snaps/basic-desktop 102.370021ms 202
May 24 11:18:36 localhost.localdomain snapd[23015]: 2018/05/24 11:18:36.744817 taskrunner.go:403: DEBUG: Running task 252 on Do: Stop snap "basic-desktop" services
May 24 11:18:36 localhost.localdomain snapd[23015]: 2018/05/24 11:18:36.954141 taskrunner.go:403: DEBUG: Running task 251 on Do: Run remove hook of "basic-desktop" snap if present
May 24 11:18:37 localhost.localdomain snapd[23015]: 2018/05/24 11:18:37.083541 taskrunner.go:403: DEBUG: Running task 253 on Do: Remove aliases for snap "basic-desktop"
May 24 11:18:37 localhost.localdomain snapd[23015]: 2018/05/24 11:18:37.359166 taskrunner.go:403: DEBUG: Running task 254 on Do: Make snap "basic-desktop" unavailable to the system
May 24 11:18:37 localhost.localdomain snapd[23015]: 2018/05/24 11:18:37.608616 taskrunner.go:403: DEBUG: Running task 255 on Do: Remove security profile for snap "basic-desktop" (x1)
May 24 11:18:37 localhost.localdomain snapd[23015]: 2018/05/24 11:18:37.755845 taskrunner.go:403: DEBUG: Running task 256 on Do: Remove data for snap "basic-desktop" (x1)
May 24 11:18:37 localhost.localdomain snapd[23015]: 2018/05/24 11:18:37.882085 taskrunner.go:403: DEBUG: Running task 257 on Do: Remove snap "basic-desktop" (x1) from the system
May 24 11:18:39 localhost.localdomain snapd[23015]: 2018/05/24 11:18:39.802406 taskrunner.go:403: DEBUG: Running task 258 on Do: Discard interface connections for snap "basic-desktop" (x1)
May 24 11:18:40 localhost.localdomain snapd[23015]: 2018/05/24 11:18:40.107940 daemon.go:272: DEBUG: pid=24762;uid=0;socket=/run/snapd.socket;@ POST /v2/snaps/manifest.yaml 1.133795ms 400
May 24 11:18:40 localhost.localdomain snapd[23015]: 2018/05/24 11:18:40.268114 daemon.go:272: DEBUG: pid=24771;uid=0;socket=/run/snapd.socket;@ POST /v2/snaps/snapcraft.yaml 1.077129ms 400
May 24 11:18:40 localhost.localdomain snapd[23015]: 2018/05/24 11:18:40.544603 daemon.go:272: DEBUG: pid=24780;uid=0;socket=/run/snapd.socket;@ POST /v2/snaps/test-snapd-devmode 117.832836ms 202
May 24 11:18:40 localhost.localdomain snapd[23015]: 2018/05/24 11:18:40.650385 taskrunner.go:403: DEBUG: Running task 260 on Do: Stop snap "test-snapd-devmode" services
May 24 11:18:40 localhost.localdomain snapd[23015]: 2018/05/24 11:18:40.969704 taskrunner.go:403: DEBUG: Running task 259 on Do: Run remove hook of "test-snapd-devmode" snap if present
May 24 11:18:41 localhost.localdomain snapd[23015]: 2018/05/24 11:18:41.197925 taskrunner.go:403: DEBUG: Running task 261 on Do: Remove aliases for snap "test-snapd-devmode"
May 24 11:18:41 localhost.localdomain snapd[23015]: 2018/05/24 11:18:41.502541 taskrunner.go:403: DEBUG: Running task 262 on Do: Make snap "test-snapd-devmode" unavailable to the system
May 24 11:18:41 localhost.localdomain snapd[23015]: 2018/05/24 11:18:41.691492 taskrunner.go:403: DEBUG: Running task 263 on Do: Remove security profile for snap "test-snapd-devmode" (x2)
May 24 11:18:41 localhost.localdomain snapd[23015]: 2018/05/24 11:18:41.841995 taskrunner.go:403: DEBUG: Running task 264 on Do: Remove data for snap "test-snapd-devmode" (x2)
May 24 11:18:42 localhost.localdomain snapd[23015]: 2018/05/24 11:18:42.370999 taskrunner.go:403: DEBUG: Running task 265 on Do: Remove snap "test-snapd-devmode" (x2) from the system
May 24 11:18:44 localhost.localdomain snapd[23015]: 2018/05/24 11:18:44.410123 taskrunner.go:403: DEBUG: Running task 266 on Do: Remove data for snap "test-snapd-devmode" (x1)
May 24 11:18:44 localhost.localdomain snapd[23015]: 2018/05/24 11:18:44.536804 taskrunner.go:403: DEBUG: Running task 267 on Do: Remove snap "test-snapd-devmode" (x1) from the system
May 24 11:18:46 localhost.localdomain snapd[23015]: 2018/05/24 11:18:46.485132 taskrunner.go:403: DEBUG: Running task 268 on Do: Discard interface connections for snap "test-snapd-devmode" (x2)
May 24 11:18:46 localhost.localdomain snapd[23015]: 2018/05/24 11:18:46.846581 daemon.go:272: DEBUG: pid=24882;uid=0;socket=/run/snapd.socket;@ POST /v2/snaps/test-snapd-tools 93.890175ms 202
May 24 11:18:46 localhost.localdomain snapd[23015]: 2018/05/24 11:18:46.971159 taskrunner.go:403: DEBUG: Running task 270 on Do: Stop snap "test-snapd-tools" services
May 24 11:18:47 localhost.localdomain snapd[23015]: 2018/05/24 11:18:47.226890 taskrunner.go:403: DEBUG: Running task 269 on Do: Run remove hook of "test-snapd-tools" snap if present
May 24 11:18:47 localhost.localdomain snapd[23015]: 2018/05/24 11:18:47.360643 taskrunner.go:403: DEBUG: Running task 271 on Do: Remove aliases for snap "test-snapd-tools"
May 24 11:18:47 localhost.localdomain snapd[23015]: 2018/05/24 11:18:47.562287 taskrunner.go:403: DEBUG: Running task 272 on Do: Make snap "test-snapd-tools" unavailable to the system
May 24 11:18:47 localhost.localdomain snapd[23015]: 2018/05/24 11:18:47.754531 taskrunner.go:403: DEBUG: Running task 273 on Do: Remove security profile for snap "test-snapd-tools" (x2)
May 24 11:18:48 localhost.localdomain snapd[23015]: 2018/05/24 11:18:48.068107 taskrunner.go:403: DEBUG: Running task 274 on Do: Remove data for snap "test-snapd-tools" (x2)
May 24 11:18:48 localhost.localdomain snapd[23015]: 2018/05/24 11:18:48.302289 taskrunner.go:403: DEBUG: Running task 275 on Do: Remove snap "test-snapd-tools" (x2) from the system
May 24 11:18:50 localhost.localdomain snapd[23015]: 2018/05/24 11:18:50.198768 cmd.go:133: DEBUG: exe doesn't have snap mount dir prefix: "/usr/lib/snapd/snapd" vs "/snap"
May 24 11:18:50 localhost.localdomain snapd[23015]: 2018/05/24 11:18:50.387273 taskrunner.go:403: DEBUG: Running task 276 on Do: Discard interface connections for snap "test-snapd-tools" (x2)
May 24 11:18:50 localhost.localdomain systemd[1]: Stopping Snappy daemon...
May 24 11:18:50 localhost.localdomain snapd[23015]: 2018/05/24 11:18:50.596525 main.go:76: Exiting on terminated signal.
May 24 11:18:50 localhost.localdomain systemd[1]: Stopped Snappy daemon.
May 24 11:19:13 localhost.localdomain systemd[1]: Starting Snappy daemon...
May 24 11:19:14 localhost.localdomain snapd[24958]: AppArmor status: apparmor is enabled and all features are available
May 24 11:19:14 localhost.localdomain snapd[24958]: 2018/05/24 11:19:14.117065 daemon.go:343: started snapd/2.33~rc1 (series 16; testing) ubuntu-core/16 (armhf) linux/4.4.0-1030-raspi2.
May 24 11:19:14 localhost.localdomain snapd[24958]: 2018/05/24 11:19:14.117763 main.go:72: DEBUG: activation done in 82ms
May 24 11:19:14 localhost.localdomain systemd[1]: Started Snappy daemon.
May 24 11:19:14 localhost.localdomain snapd[24958]: 2018/05/24 11:19:14.167259 autorefresh.go:216: DEBUG: Next refresh scheduled for 2018-05-25 12:46:30.046689201 +0000 UTC.
May 24 11:19:14 localhost.localdomain snapd[24958]: 2018/05/24 11:19:14.169870 catalogrefresh.go:71: DEBUG: Catalog refresh starting now; next scheduled for 2018-05-25 11:19:14.169793228 +0000 UTC.
May 24 11:19:14 localhost.localdomain snapd[24958]: 2018/05/24 11:19:14.170318 retry.go:40: DEBUG: Retrying https://api.snapcraft.io/api/v1/snaps/sections, attempt 1, elapsed time=48.281µs
May 24 11:19:14 localhost.localdomain snapd[24958]: 2018/05/24 11:19:14.172979 logger.go:69: DEBUG: > "GET /api/v1/snaps/sections HTTP/1.1\r\nHost: api.snapcraft.io\r\nUser-Agent: snapd/2.33~rc1 (series 16; testing) ubuntu-core/16 (armhf) linux/4.4.0-1030-raspi2\r\nAccept: application/hal+json\r\nX-Ubuntu-Architecture: armhf\r\nX-Ubuntu-Classic: false\r\nX-Ubuntu-Series: 16\r\nX-Ubuntu-Wire-Protocol: 1\r\nAccept-Encoding: gzip\r\n\r\n"
May 24 11:19:14 localhost.localdomain snapd[24958]: 2018/05/24 11:19:14.237295 daemon.go:272: DEBUG: pid=24968;uid=0;socket=/run/snapd.socket;@ PUT /v2/snaps/core/conf 32.753847ms 202
May 24 11:19:15 localhost.localdomain snapd[24958]: 2018/05/24 11:19:15.522758 logger.go:76: DEBUG: < "HTTP/1.1 200 OK\r\nContent-Length: 266\r\nAge: 2432\r\nCache-Control: public, max-age=3600\r\nContent-Type: application/hal+json\r\nDate: Thu, 24 May 2018 10:38:43 GMT\r\nServer: gunicorn/19.7.1\r\nSnap-Store-Version: 1\r\nVary: X-Ubuntu-Series\r\nVia: 1.1 juju-7794b8-prod-ols-snap-store-indep-397 (squid/3.5.23)\r\nX-Cache: HIT from juju-7794b8-prod-ols-snap-store-indep-397\r\nX-Cache-Lookup: HIT from juju-7794b8-prod-ols-snap-store-indep-397:3128\r\nX-Request-Id: 1c965255-f243-4e5a-8b42-977c86f852b1\r\nX-Vcs-Revision: 623d38a\r\n\r\n{\"_embedded\": {\"clickindex:sections\": [{\"name\": \"featured\"}, {\"name\": \"games\"}, {\"name\": \"finance\"}, {\"name\": \"developers\"}, {\"name\": \"social-networking\"}, {\"name\": \"video\"}, {\"name\": \"music\"}, {\"name\": \"productivity\"}, {\"name\": \"utilities\"}, {\"name\": \"graphics\"}]}}"
May 24 11:19:15 localhost.localdomain snapd[24958]: 2018/05/24 11:19:15.523554 retry.go:52: DEBUG: The retry loop for https://api.snapcraft.io/api/v1/snaps/sections finished after 1 retries, elapsed time=1.353279033s, status: 200
May 24 11:19:15 localhost.localdomain snapd[24958]: 2018/05/24 11:19:15.535304 retry.go:40: DEBUG: Retrying https://api.snapcraft.io/api/v1/snaps/names?confinement=strict, attempt 1, elapsed time=47.188µs
May 24 11:19:15 localhost.localdomain snapd[24958]: 2018/05/24 11:19:15.538411 logger.go:69: DEBUG: > "GET /api/v1/snaps/names?confinement=strict HTTP/1.1\r\nHost: api.snapcraft.io\r\nUser-Agent: snapd/2.33~rc1 (series 16; testing) ubuntu-core/16 (armhf) linux/4.4.0-1030-raspi2\r\nAccept: application/hal+json\r\nX-Ubuntu-Architecture: armhf\r\nX-Ubuntu-Classic: false\r\nX-Ubuntu-Series: 16\r\nX-Ubuntu-Wire-Protocol: 1\r\nAccept-Encoding: gzip\r\n\r\n"
May 24 11:19:16 localhost.localdomain snapd[24958]: 2018/05/24 11:19:16.745085 logger.go:76: DEBUG: < "HTTP/1.1 200 OK\r\nContent-Length: 88053\r\nAge: 1092\r\nCache-Control: public, max-age=3600\r\nContent-Type: application/hal+json\r\nDate: Thu, 24 May 2018 11:01:08 GMT\r\nServer: gunicorn/19.7.1\r\nSnap-Store-Version: 1\r\nVary: X-Ubuntu-Store, X-Ubuntu-Series, X-Ubuntu-Architecture\r\nVia: 1.1 juju-7794b8-prod-ols-snap-store-indep-397 (squid/3.5.23)\r\nX-Cache: HIT from juju-7794b8-prod-ols-snap-store-indep-397\r\nX-Cache-Lookup: HIT from juju-7794b8-prod-ols-snap-store-indep-397:3128\r\nX-Request-Id: c808aa3e-f707-4688-a1fc-1f9a4334e36d\r\nX-Vcs-Revision: 623d38a\r\n\r\n"
May 24 11:19:17 localhost.localdomain snapd[24958]: 2018/05/24 11:19:17.573197 retry.go:52: DEBUG: The retry loop for https://api.snapcraft.io/api/v1/snaps/names?confinement=strict finished after 1 retries, elapsed time=2.037939006s, status: 200
May 24 11:19:19 localhost.localdomain snapd[24958]: 2018/05/24 11:19:19.569825 taskrunner.go:403: DEBUG: Running task 119 on Do: Run configure hook of "core" snap
May 24 11:19:20 localhost.localdomain snapd[24958]: 2018/05/24 11:19:20.266824 daemon.go:272: DEBUG: pid=25004;uid=0;socket=/run/snapd.socket;@ POST /v2/snaps 158.805725ms 202
May 24 11:19:20 localhost.localdomain snapd[24958]: 2018/05/24 11:19:20.276952 taskrunner.go:403: DEBUG: Running task 120 on Do: Ensure prerequisites for "test-snapd-layout" are available
May 24 11:19:20 localhost.localdomain snapd[24958]: 2018/05/24 11:19:20.396257 taskrunner.go:403: DEBUG: Running task 121 on Do: Prepare snap "/tmp/snapd-sideload-pkg-299546165" (unset)
May 24 11:19:20 localhost.localdomain snapd[24958]: 2018/05/24 11:19:20.578043 taskrunner.go:403: DEBUG: Running task 122 on Do: Mount snap "test-snapd-layout" (unset)
May 24 11:19:23 localhost.localdomain snapd[24958]: 2018/05/24 11:19:23.974896 taskrunner.go:403: DEBUG: Running task 123 on Do: Copy snap "test-snapd-layout" data
May 24 11:19:24 localhost.localdomain snapd[24958]: 2018/05/24 11:19:24.055672 taskrunner.go:403: DEBUG: Running task 124 on Do: Setup snap "test-snapd-layout" (unset) security profiles
May 24 11:19:24 localhost.localdomain snapd[24958]: 2018/05/24 11:19:24.981470 taskrunner.go:403: DEBUG: Running task 125 on Do: Make snap "test-snapd-layout" (unset) available to the system
May 24 11:19:25 localhost.localdomain snapd[24958]: 2018/05/24 11:19:25.062716 taskrunner.go:403: DEBUG: Running task 126 on Do: Setup snap "test-snapd-layout" (unset) security profiles (phase 2)
May 24 11:19:25 localhost.localdomain snapd[24958]: 2018/05/24 11:19:25.139891 taskrunner.go:403: DEBUG: Running task 127 on Do: Automatically connect eligible plugs and slots of snap "test-snapd-layout"
May 24 11:19:25 localhost.localdomain snapd[24958]: 2018/05/24 11:19:25.220621 taskrunner.go:403: DEBUG: Running task 128 on Do: Set automatic aliases for snap "test-snapd-layout"
May 24 11:19:25 localhost.localdomain snapd[24958]: 2018/05/24 11:19:25.402424 taskrunner.go:403: DEBUG: Running task 129 on Do: Setup snap "test-snapd-layout" aliases
May 24 11:19:25 localhost.localdomain snapd[24958]: 2018/05/24 11:19:25.579182 taskrunner.go:403: DEBUG: Running task 130 on Do: Run install hook of "test-snapd-layout" snap if present
May 24 11:19:25 localhost.localdomain snapd[24958]: 2018/05/24 11:19:25.665374 taskrunner.go:403: DEBUG: Running task 131 on Do: Start snap "test-snapd-layout" (unset) services
May 24 11:19:25 localhost.localdomain snapd[24958]: 2018/05/24 11:19:25.733015 taskrunner.go:403: DEBUG: Running task 132 on Do: Run configure hook of "test-snapd-layout" snap if present
May 24 11:19:26 localhost.localdomain snapd[24958]: 2018/05/24 11:19:26.263824 daemon.go:272: DEBUG: pid=25004;uid=0;socket=/run/snapd.socket;@ GET /v2/snaps?snaps=test-snapd-layout 5.989909ms 200
+ echo '# apparmor denials '
# apparmor denials 
+ dmesg --ctime
+ grep DENIED
+ true
+ echo '# seccomp denials (kills) '
# seccomp denials (kills) 
+ dmesg --ctime
+ grep type=1326
+ true
+ echo '# snap interfaces'
# snap interfaces
+ snap interfaces
Slot                      Plug
cm3:bcm-gpio-0            -
cm3:bcm-gpio-1            -
cm3:bcm-gpio-10           -
cm3:bcm-gpio-11           -
cm3:bcm-gpio-12           -
cm3:bcm-gpio-13           -
cm3:bcm-gpio-14           -
cm3:bcm-gpio-15           -
cm3:bcm-gpio-16           -
cm3:bcm-gpio-17           -
cm3:bcm-gpio-18           -
cm3:bcm-gpio-19           -
cm3:bcm-gpio-2            -
cm3:bcm-gpio-20           -
cm3:bcm-gpio-21           -
cm3:bcm-gpio-22           -
cm3:bcm-gpio-23           -
cm3:bcm-gpio-24           -
cm3:bcm-gpio-25           -
cm3:bcm-gpio-26           -
cm3:bcm-gpio-27           -
cm3:bcm-gpio-3            -
cm3:bcm-gpio-4            -
cm3:bcm-gpio-5            -
cm3:bcm-gpio-6            -
cm3:bcm-gpio-7            -
cm3:bcm-gpio-8            -
cm3:bcm-gpio-9            -
cm3:bt-serial             -
cm3:i2c-0                 -
cm3:i2c-1                 -
cm3:i2c-2                 -
:account-control          -
:alsa                     -
:autopilot-introspection  -
:bluetooth-control        -
:broadcom-asic-control    -
:browser-support          -
:camera                   -
:classic-support          -
:core-support             core:core-support-plug
:daemon-notify            -
:dcdbas-control           -
:docker-support           -
:firewall-control         -
:framebuffer              -
:fuse-support             -
:gpg-keys                 -
:gpg-public-keys          -
:gpio-memory-control      -
:greengrass-support       -
:hardware-observe         -
:hardware-random-control  -
:hardware-random-observe  -
:home                     -
:hostname-control         -
:io-ports-control         -
:joystick                 -
:kernel-module-control    -
:kubernetes-support       -
:kvm                      -
:log-observe              -
:lxd-support              -
:mount-observe            -
:netlink-audit            -
:netlink-connector        -
:network                  -
:network-bind             -
:network-control          -
:network-observe          -
:network-setup-control    -
:network-setup-observe    -
:opengl                   -
:openvswitch-support      -
:physical-memory-control  -
:physical-memory-observe  -
:ppp                      -
:process-control          -
:raw-usb                  -
:removable-media          -
:shutdown                 -
:snapd-control            -
:ssh-keys                 -
:ssh-public-keys          -
:system-observe           -
:system-trace             -
:time-control             -
:timeserver-control       -
:timezone-control         -
:tpm                      -
:uhid                     -
-----
.
2018-05-24 11:18:40 Restoring external:ubuntu-core-16-arm-32:tests/main/layout...
2018-05-24 11:18:40 Preparing external:ubuntu-core-16-arm-32:tests/main/snap-multi-service-failing...
2018-05-24 11:19:08 Executing external:ubuntu-core-16-arm-32:tests/main/snap-multi-service-failing (42/191)...
2018-05-24 11:19:08 Restoring external:ubuntu-core-16-arm-32:tests/main/snap-multi-service-failing...
2018-05-24 11:19:08 Preparing external:ubuntu-core-16-arm-32:tests/main/refresh-devmode:fake...
2018-05-24 11:19:39 Executing external:ubuntu-core-16-arm-32:tests/main/refresh-devmode:fake (43/191)...
2018-05-24 11:19:39 Restoring external:ubuntu-core-16-arm-32:tests/main/refresh-devmode:fake...
2018-05-24 11:19:39 Preparing external:ubuntu-core-16-arm-32:tests/main/security-devpts...
2018-05-24 11:20:08 Executing external:ubuntu-core-16-arm-32:tests/main/security-devpts (44/191)...
2018-05-24 11:20:25 Restoring external:ubuntu-core-16-arm-32:tests/main/security-devpts...
2018-05-24 11:20:25 Preparing external:ubuntu-core-16-arm-32:tests/main/interfaces-ssh-keys...
2018-05-24 11:21:03 Executing external:ubuntu-core-16-arm-32:tests/main/interfaces-ssh-keys (45/191)...
2018-05-24 11:21:07 Restoring external:ubuntu-core-16-arm-32:tests/main/interfaces-ssh-keys...
2018-05-24 11:21:07 Preparing external:ubuntu-core-16-arm-32:tests/main/revert:remote...
2018-05-24 11:21:52 Executing external:ubuntu-core-16-arm-32:tests/main/revert:remote (46/191)...
2018-05-24 11:26:52 WARNING: external:ubuntu-core-16-arm-32 (external:ubuntu-core-16-arm-32:tests/main/revert:remote) running late. Current output:
-----
(... 48 lines above ...)
+ echo 'And a new revert fails'
And a new revert fails
+ snap revert test-snapd-tools
error: cannot revert "test-snapd-tools": no revision to revert to
+ echo 'And a refresh doesn'\''t update the snap'
And a refresh doesn't update the snap
+ snap refresh
snapd is about to reboot the system
+ snap list
+ MATCH 'test-snapd-tools +[0-9]+\.[0-9]+ '
-----
.
2018-05-24 11:31:52 WARNING: external:ubuntu-core-16-arm-32 (external:ubuntu-core-16-arm-32:tests/main/revert:remote) running late. Output unchanged.
2018-05-24 11:34:08 Error executing external:ubuntu-core-16-arm-32:tests/main/revert:remote : 
-----

+ '[' production = fake ']'
+ echo 'Revert without snap name shows error'
Revert without snap name shows error
+ snap revert
error: the required argument `<snap>` was not provided
+ . /home/gopath/src/github.com/snapcore/snapd/tests/lib/dirs.sh
++ export SNAP_MOUNT_DIR=/snap
++ SNAP_MOUNT_DIR=/snap
++ export LIBEXECDIR=/usr/lib
++ LIBEXECDIR=/usr/lib
++ export MEDIA_DIR=/media
++ MEDIA_DIR=/media
++ case "$SPREAD_SYSTEM" in
+ echo 'When a refresh is made'
When a refresh is made
+ snap refresh --edge test-snapd-tools
test-snapd-tools (edge) 1.0+fake1 from 'canonical' refreshed
+ echo 'Then the new version is installed'
Then the new version is installed
+ snap list
+ MATCH 'test-snapd-tools +[0-9]+\.[0-9]+\+fake1'
+ echo 'And the snap runs'
And the snap runs
+ test-snapd-tools.echo hello
+ MATCH hello
+ echo 'When a revert is made'
When a revert is made
+ snap revert test-snapd-tools
test-snapd-tools reverted to 1.0
Channel edge for test-snapd-tools is closed; temporarily forwarding to stable.
+ echo 'Then the old version is active'
Then the old version is active
+ snap list
+ MATCH 'test-snapd-tools +[0-9]+\.[0-9]+ '
+ echo 'And the data directories are present'
And the data directories are present
+ ls /snap/test-snapd-tools
+ MATCH current
+ ls /var/snap/test-snapd-tools
+ MATCH current
+ echo 'And the snap runs confined'
And the snap runs confined
+ snap list
+ MATCH 'test-snapd-tools.* -$'
+ echo 'And the still snap runs'
And the still snap runs
+ test-snapd-tools.echo hello
+ MATCH hello
+ echo 'And a new revert fails'
And a new revert fails
+ snap revert test-snapd-tools
error: cannot revert "test-snapd-tools": no revision to revert to
+ echo 'And a refresh doesn'\''t update the snap'
And a refresh doesn't update the snap
+ snap refresh
snapd is about to reboot the system
+ snap list
+ MATCH 'test-snapd-tools +[0-9]+\.[0-9]+ '
error: cannot list snaps: cannot communicate with server: Get http://localhost/v2/snaps: read unix @->/run/snapd.socket: read: connection reset by peer
error: pattern not found, got:
-----
.
2018-05-24 11:34:09 Error debugging external:ubuntu-core-16-arm-32:tests/main/revert:remote : ssh: unexpected packet in response to channel open: <nil>
2018-05-24 11:34:09 Restoring external:ubuntu-core-16-arm-32:tests/main/revert:remote...
2018-05-24 11:34:09 Error restoring external:ubuntu-core-16-arm-32:tests/main/revert:remote : read tcp 172.17.0.2:55180->10.101.50.183:22: read: connection reset by peer
2018-05-24 11:34:09 Restoring external:ubuntu-core-16-arm-32:tests/main/...
2018-05-24 11:34:09 Error restoring external:ubuntu-core-16-arm-32:tests/main/ : read tcp 172.17.0.2:55180->10.101.50.183:22: read: connection reset by peer
2018-05-24 11:34:09 Restoring external:ubuntu-core-16-arm-32...
2018-05-24 11:34:09 Error restoring external:ubuntu-core-16-arm-32 : read tcp 172.17.0.2:55180->10.101.50.183:22: read: connection reset by peer
2018-05-24 11:34:09 Discarding external:ubuntu-core-16-arm-32...
2018-05-24 11:34:09 Successful tasks: 44
2018-05-24 11:34:09 Aborted tasks: 145
2018-05-24 11:34:09 Failed tasks: 2
    - external:ubuntu-core-16-arm-32:tests/main/layout
    - external:ubuntu-core-16-arm-32:tests/main/revert:remote
2018-05-24 11:34:09 Failed task restore: 1
    - external:ubuntu-core-16-arm-32:tests/main/revert:remote
2018-05-24 11:34:09 Failed suite restore: 1
    - external:ubuntu-core-16-arm-32:tests/main/
2018-05-24 11:34:09 Failed project restore: 1
    - external:ubuntu-core-16-arm-32:project
error: unsuccessful run
2018-05-24 11:34:09,249 cm3-001 WARNING: Tests failed, rc=1
2018-05-24 11:34:09,307 cm3-001 INFO: END testrun
complete
